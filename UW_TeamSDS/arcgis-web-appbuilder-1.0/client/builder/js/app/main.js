//>>built
require({cache:{"builder/ConfigApp":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/cookie dojo/topic dojo/io-query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ConfigApp.html ./config/LeftPane ./utils ./serviceUtils jimu/utils jimu/WidgetManager jimu/dijit/ViewStack esri/urlUtils esri/geometry/Extent esri/tasks/GeometryService esri/config esri/urlUtils dojo/request dijit/registry builder/tokenUtils".split(" "),function(t,d,b,g,
k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A,z){return t([m,n],{templateString:f,baseClass:"config-app",_PreviewMoreIframeSrc:"",_isPortrait:!0,_deviceInfo:null,appId:null,label:"config",postCreate:function(){this.inherited(arguments);this.own(k(this.viewerNode,"load",d.hitch(this,function(){window.configWindow=this.viewerNode.contentWindow;this.own(k(this.viewerNode.contentWindow.document.body,"click",d.hitch(this,function(a){q.publish("iframeClick",a)})))})));this.own(k(this.viewer2Node,"load",d.hitch(this,
function(){window.previewWindow=this.viewer2Node.contentWindow;this.own(k(this.viewer2Node.contentWindow.document.body,"click",d.hitch(this,function(a){q.publish("iframeClick",a)})))})));this.viewStack=new v({viewType:"dom",views:[this.previewConfig,this.previewMore]});g.addClass(this.viewStack.domNode,"preview-viewstack");g.place(this.viewStack.domNode,this.rightPreviewSection);this._showPreviewConfig();this._republishBuilderEvents();this.own(q.subscribe("showPreviewConfig",d.hitch(this,function(){this._showPreviewConfig()})));
this.own(q.subscribe("showPreviewMore",d.hitch(this,function(){this._showPreviewMore()})));this.own(q.subscribe("onDeviceSelected",d.hitch(this,this.onDeviceSelected)));this.own(k(this.btnPortrait,"click",d.hitch(this,function(){this._resizePreviewMore(!0)})));this.own(k(this.btnLandscape,"click",d.hitch(this,function(){this._resizePreviewMore(!1)})));this._createLeftPane();this.widgetManager=w.getInstance();window.setConfigViewerTopic=d.hitch(this,function(a){this.configViewerTopic=a;this.own(this.configViewerTopic.subscribe("appConfigLoaded",
d.hitch(this,this.onAppConfigLoaded)));this.own(this.configViewerTopic.subscribe("appConfigChanged",d.hitch(this,this.onAppConfigChanged)));this.own(this.configViewerTopic.subscribe("mapLoaded",d.hitch(this,this.onMapLoaded)));this.own(this.configViewerTopic.subscribe("mapChanged",d.hitch(this,this.onMapChanged)));this.own(this.configViewerTopic.subscribe("preloadWidgetsLoaded",d.hitch(this,this.onPreloadWidgetsLoaded)));this.own(this.configViewerTopic.subscribe("mapCreatedFailed",d.hitch(this,this.onMapCreatedFailed)));
this.own(this.configViewerTopic.subscribe("configUserSignIn",d.hitch(this,function(a){q.publish("externalUserSignIn",a);this.previewViewerTopic&&this.previewViewerTopic.publish("externalUserSignIn",a)})))});window.setPreviewViewerTopic=d.hitch(this,function(a){this.previewViewerTopic=a;var c=d.clone(this.appConfig);c.mode="preview";this.previewViewerTopic.publish("resetConfig",c);this.own(this.previewViewerTopic.subscribe("previewUserSignIn",d.hitch(this,function(a){q.publish("externalUserSignIn",
a);this.configViewerTopic.publish("externalUserSignIn",a)})));this.own(this.previewViewerTopic.subscribe("mapLoaded",d.hitch(this,function(){this._copyConfigMapExtent2PreviewExtent()})));window.previewWindow.require("jimu/tokenUtils",function(a){var D=c.portalUrl;a.setPortalUrl(D);(a=z.getPortalCredential(D))&&this.previewViewerTopic&&this.previewViewerTopic.publish("externalUserSignIn",a)})});this._updateUrl();this._updateAppId();this.showAppName()},_updateUrl:function(){var a=window.location.href,
c=a.indexOf("?"),e=l.queryToObject(a.substr(c+1,a.length));e.id!==this.id&&(e.id||(e=e.apiurl?{apiurl:e.apiurl}:{}),e.id=this.id,a=a.substr(0,c)+"?"+decodeURIComponent(l.objectToQuery(e)),history.pushState&&window.history.pushState({path:a},"",a))},_createLeftPane:function(){this.leftPane=new r({});this.leftPane.placeAt(this.leftPaneNode)},_updateAppId:function(){window.appId=this.id;window.appPath=u.getAppPathById(this.id);jimuConfig.widgetsPackage={name:"widgets",location:window.appPath+"widgets"};
jimuConfig.themesPackage={name:"themes",location:window.appPath+"themes"};jimuConfig.configsPackage={name:"configs",location:window.appPath+"configs"};var a=x.urlToObject(window.location.href).query||{};delete a.id;var c=window.appPath;window.isXT||(c=c+"index.html?id\x3d"+window.appId);a.mode="preview";this._PreviewMoreIframeSrc=u.appendParamsToAppPath(c,a);a.mode="config";g.attr(this.viewerNode,"src",u.appendParamsToAppPath(c,a))},setAppId:function(a){if(this.id===a){var c=d.clone(this.leftPane.lastAppConfig);
this.leftPane.destroy();this._createLeftPane({appId:a});this._setAppConfig(c,!0);this.configViewerTopic.publish("resetConfig",c)}else this.id=a,g.setStyle(this.leftPane.coverNode,"display",""),this._updateAppId()},showAppName:function(){var a=A.byId("header");"stemapp"===this.id?a.setAppName("stemapp"):this.name?a.setAppName(this.name):s.getAppInfo(this.id).then(d.hitch(this,function(c){a.setAppName(c.name)}))},_republishBuilderEvents:function(){this.own(q.subscribe("configChanged",d.hitch(this,function(a,
c,e){this.configViewerTopic.publish("configChanged",a,c,e)})));this.own(q.subscribe("resetConfig",d.hitch(this,function(a){this.configViewerTopic.publish("resetConfig",a)})));this.own(q.subscribe("themeChanged",d.hitch(this,function(a){this.configViewerTopic.publish("themeChanged",a)})));this.own(q.subscribe("layoutChanged",d.hitch(this,function(a){this.configViewerTopic.publish("layoutChanged",a)})));this.own(q.subscribe("styleChanged",d.hitch(this,function(a){this.configViewerTopic.publish("styleChanged",
a)})));this.own(q.subscribe("actionTriggered",d.hitch(this,function(a,c,e){this.configViewerTopic.publish("actionTriggered",a,c,e)})));this.own(q.subscribe("builderUserSignIn",d.hitch(this,function(a){this.configViewerTopic&&this.configViewerTopic.publish("externalUserSignIn",a);this.previewViewerTopic&&this.previewViewerTopic.publish("externalUserSignIn",a)})))},startup:function(){this.inherited(arguments);this.leftPane.startup();this.viewStack.startup()},destroy:function(){p.defaults.geometryService=
null;this.leftPane.destroy();this.leftPane=null;this.inherited(arguments)},_getGeomtryServiceByAppConfig:function(a){return new c(a.geometryService)},onAppConfigLoaded:function(a){a=x.reCreateObject(a);p.defaults.geometryService=this._getGeomtryServiceByAppConfig(a);q.publish("appConfigLoaded",a);this._setAppConfig(a,!0);(a=z.getPortalCredential(a.portalUrl))&&this.configViewerTopic.publish("externalUserSignIn",a)},onMapLoaded:function(a){q.publish("mapLoaded",a)},onMapChanged:function(a){q.publish("mapChanged",
a)},onAppConfigChanged:function(a,c,e){a=x.reCreateObject(a);p.defaults.geometryService=this._getGeomtryServiceByAppConfig(a);q.publish("appConfigChanged",a,c,e);this._setAppConfig(a,!1)},onPreloadWidgetsLoaded:function(){q.publish("preloadWidgetsLoaded")},onMapCreatedFailed:function(){q.publish("mapCreatedFailed")},_setAppConfig:function(a,c){this.leftPane.setAppConfig(a,c);this.appConfig=a;window.appConfig=a},_showPreviewConfig:function(){this.viewStack.switchView(this.previewConfig)},_showPreviewMore:function(){this.viewStack.switchView(this.previewMore);
if(!this.viewer2Node.src&&this._PreviewMoreIframeSrc)this._initPreviewMoreViewerPosition(),g.attr(this.viewer2Node,"src",this._PreviewMoreIframeSrc);else{var a=d.clone(this.appConfig);a.mode="preview";this._copyConfigMapExtent2PreviewExtent();this.previewViewerTopic.publish("resetConfig",a)}},_copyConfigMapExtent2PreviewExtent:function(){var a=window.configWindow&&window.configWindow._viewerMap,c=window.previewWindow&&window.previewWindow._viewerMap;a&&c&&c.setExtent(a.extent)},_initPreviewMoreViewerPosition:function(){var a=
g.getMarginBox(this.previewMore);g.setStyle(this.viewer2Container,{width:a.w-220+"px",height:a.h-130+"px"});g.setStyle(this.previewMoreIframeSection,"marginTop","50px")},_setPreviewMoreViewerPosition:function(){var a=g.getMarginBox(this.previewMore).h,c=g.getMarginBox(this.viewer2Container),e=g.getStyle(this.viewer2Container,"paddingTop"),b=g.getStyle(this.viewer2Container,"paddingBottom"),a=(a-(c.h+e+b))/2;0>a&&(a=0);g.setStyle(this.previewMoreIframeSection,"marginTop",a+"px")},onDeviceSelected:function(a,
c){this._deviceInfo=a;g.setStyle(this.previewMoreDes,"display","block");this.previewMoreDes.innerHTML=c?a.width+" x "+a.height:a.title+" "+a.width+" x "+a.height;this._resizePreviewMore(this._isPortrait)},_resizePreviewMore:function(c){var e=window.configWindow&&window.configWindow._viewerMap,b=window.previewWindow&&window.previewWindow._viewerMap,p=e&&e.extent.toJson();c?this._showPortrait():this._showLandscape();b&&p&&setTimeout(function(){var c=new a(p);b.setExtent(c)},500)},_showPortrait:function(){this._deviceInfo&&
(this._isPortrait=!0,g.setStyle(this.viewer2Container,{width:this._deviceInfo.width+44+"px",height:this._deviceInfo.height+44+"px"}),g.addClass(this.btnPortrait,"selected"),g.removeClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_showLandscape:function(){this._deviceInfo&&(this._isPortrait=!1,g.setStyle(this.viewer2Container,{width:this._deviceInfo.height+44+"px",height:this._deviceInfo.width+44+"px"}),g.removeClass(this.btnPortrait,"selected"),g.addClass(this.btnLandscape,
"selected"),this._setPreviewMoreViewerPosition())}})})},"builder/config/LeftPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/on dojo/dom dojo/keys dojo/cookie dojo/request/xhr dojo/aspect dojo/query dojo/json dojo/Deferred dojo/promise/all dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/LeftPane.html ./MapConfig ./ThemeConfig ./WidgetConfig ./AttributeConfig ./TabContainer2 ../serviceUtils ../CreateAppNew ../AGOLTemplate/AGOLTemplate ../AGOLTemplate/utils jimu/portalUrlUtils jimu/portalUtils jimu/utils jimu/dijit/ViewStack jimu/dijit/Message jimu/dijit/Popup jimu/dijit/LoadingShelter dijit/registry jimu/dijit/QRCode".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A,z,D,C,F,G,H,E,I,J,M,K,L){return t([x,w,v],{templateString:e,postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.nls=d.mixin(this.nls,builderNls.leftPane);this.nls=d.mixin(this.nls,builderNls.agolTemplate)},postCreate:function(){this.inherited(arguments);this._initPreviewItems();this.themePane=new c({},this.appPaneNode);this.mapPane=new a({},this.mapPaneNode);this.mapPane.startup();this.widgetPane=new p({},this.widgetPaneNode);
this.attributePane=new y({},this.attributePaneNode);this.tab=new B({tabs:[{title:this.nls.themes,content:this.themePane},{title:this.nls.map,content:this.mapPane},{title:this.nls.widgets,content:this.widgetPane},{title:this.nls.attributes,content:this.attributePane}],selected:this.nls.themes},this.tabsNode);this._bindEvents();this.viewStack=new E({viewType:"dom",views:[this.configSection,this.previewSection]});b.place(this.viewStack.domNode,this.content);b.setStyle(this.viewStack.domNode,"width",
"100%");b.setStyle(this.viewStack.domNode,"height","100%");this._showConfigSection();this._showLoadingCover();this._initFootMenu()},_bindEvents:function(){this.own(g.subscribe("leavePage",d.hitch(this,this._onLeavePage)));this.own(k(this.secondFooterBox,"click",d.hitch(this,this._switchProviewOrConfigSection)));this.own(k(this.btnSaveBox,"click",d.hitch(this,this._onSave)));this.own(k(this.customWidth,"blur",d.hitch(this,this._onCustomSizeChanged)));this.own(k(this.customHeight,"blur",d.hitch(this,
this._onCustomSizeChanged)));this.own(g.subscribe("preloadWidgetsLoaded",d.hitch(this,this._onPreloadWidgetsLoaded)));this.own(g.subscribe("mapCreatedFailed",d.hitch(this,this._onMapCreatedFailed)));this.own(g.subscribe("startChangeTheme",d.hitch(this,this._onStartChangeTheme)));this.own(k(this.btnArrow,"click",d.hitch(this,this._onArrowClick)));this.own(k(document.body,"click",d.hitch(this,function(){b.setStyle(this.footMenu,"display","none")})));this.own(g.subscribe("iframeClick",d.hitch(this,function(){b.setStyle(this.footMenu,
"display","none")})))},_onMapChanged:function(a){this.map=a},_onPreloadWidgetsLoaded:function(){this._hideLoadingCover()},_onMapCreatedFailed:function(){this._hideLoadingCover()},_onStartChangeTheme:function(){this._showLoadingCover()},_showLoadingCover:function(){b.setStyle(this.coverNode,"display","block")},_hideLoadingCover:function(){b.setStyle(this.coverNode,"display","none")},_switchProviewOrConfigSection:function(){"none"===b.getStyle(this.btnConfig,"display")?this._showPreviewSection():this._showConfigSection()},
_showConfigSection:function(){b.setStyle(this.btnPreview,"display","inline-block");b.setStyle(this.btnConfig,"display","none");this.viewStack.switchView(this.configSection);g.publish("showPreviewConfig")},_showPreviewSection:function(){b.setStyle(this.btnPreview,"display","none");b.setStyle(this.btnConfig,"display","inline-block");this.viewStack.switchView(this.previewSection);g.publish("showPreviewMore")},startup:function(){this.inherited(arguments);this.tab.startup();var a="";window.isXT?a=window.location.protocol+
"//"+window.location.host+path+"apps/"+appId:(a=F.getStandardPortalUrl(window.portalUrl),a=F.setProtocol(a,window.location.protocol),a=a+"/apps/webappviewer/index.html?id\x3d"+appId);var c=b.create("a",{href:a,target:"_blank"},this.launchFooterBox);b.create("div",{"class":"footer-button first-footer-button",innerHTML:this.nls.launch,title:this.nls.launch},c);new L({text:a,width:75,height:75},this.qrcodeImage);b.setAttr(this.qrcodeDescription,"innerHTML",this.nls.qrcodeDesc);f(".qrcode-image table").style("margin",
"0px")},destroy:function(){this.themePane.destroy();this.mapPane.destroy();this.widgetPane.destroy();this.attributePane.destroy();this.themePane=this.widgetPane=this.mapPane=this.themePane=null;this.inherited(arguments)},_initFootMenu:function(){h.setSelectable(this.footMenu,!1)},_onSave:function(){this._appHasChanged()&&("stemapp"===appId?new I({message:this.nls.canNotSaveMeg}):(b.setAttr(this.btnSave,"innerHTML",this.nls.saving),b.setAttr(this.btnSave,"title",this.nls.saving),this._saveApp().then(d.hitch(this,
function(a){a.success&&(this._disableSaveButton(),this._disableUnloadDlg())}),d.hitch(this,function(){this._enableSaveButton()}))))},_onSaveAs:function(){"stemapp"===appId?new I({message:this.nls.canNotSaveMeg}):z.popupDlg({createFromId:appId,appConfig:this.appConfig},this.nls.saveAs)},_onExportAsTemplate:function(){var a=new u,c=new u,e=(new M({})).placeAt("main-view-stack");window.isXT?A.getAppInfo(appId).then(d.hitch(this,function(c){a.resolve(c)}),function(){a.reject()}):G.getPortal(F.getPortalUrlFromLocation()).getItemData(appId).then(d.hitch(this,
function(c){c=c.agolTemplateInfo;!c&&this.appConfig.agolTemplateJson&&(c={itemId:null,json:this.appConfig.agolTemplateJson});c={id:appId,name:K.byId("header").getAppName(),agolTemplateInfo:c};a.resolve(c)}),function(){a.reject()});c=C.loadAllWidgetConfigs(d.clone(this.appConfig));s({app:a,appConfig:c}).then(d.hitch(this,function(a){var c=a.appConfig.getCleanConfig(),c=d.clone(c);delete c.agolTemplateJson;c.visitElement=a.appConfig.visitElement;c.visitElement(function(a){!a.widgets&&(a.uri&&void 0===
a.visible)&&(a.visible=!0)});delete c.visitElement;delete c._buildInfo;a=new D({appConfig:c,fullAppConfig:a.appConfig,app:a.app});new J({content:a,container:"main-page",titleLabel:this.nls.title,width:1040,height:625,buttons:[{label:this.nls.download,key:q.ENTER,onClick:d.hitch(a,a._onExportClick)},{label:this.nls.saved,key:q.ENTER,onClick:d.hitch(a,a._onSaveClick)},{label:this.nls.cancel,key:q.ESCAPE,onClick:d.hitch(a,a._onCancelClick)}]});a.startup();e.hide()}),function(){e.hide()})},_enableSaveButton:function(){b.addClass(this.btnSave,
"save-enable");b.setStyle(this.btnSaveBox,"cursor","pointer");b.setAttr(this.btnSave,"innerHTML",this.nls.save);b.setAttr(this.btnSave,"title",this.nls.save)},_disableSaveButton:function(){b.removeClass(this.btnSave,"save-enable");b.setStyle(this.btnSaveBox,"cursor","default");b.setAttr(this.btnSave,"innerHTML",this.nls.saved);b.setAttr(this.btnSave,"title",this.nls.saved)},_saveApp:function(){var a=new u;A.saveApp(appId,this.appConfig.getCleanConfig()).then(d.hitch(this,function(c){c.success?(this.lastAppConfig=
d.clone(this.appConfig),a.resolve(c),(c=main.getViewByLabel("apps"))&&window.isXT&&c.refresh()):(new I({message:this.nls.saveFailedMeg+": "+c.message}),a.reject())}),d.hitch(this,function(c){new I({message:this.nls.saveFailedMeg});console.error(c);a.reject()}));return a},_onArrowClick:function(a){"none"===b.getStyle(this.footMenu,"display")?b.setStyle(this.footMenu,"display","block"):b.setStyle(this.footMenu,"display","none");a.stopPropagation()},setAppConfig:function(a,c){this.appConfig=a;this.themePane.setAppConfig(a,
c);this.mapPane.setAppConfig(a,c);this.widgetPane.setAppConfig(a,c);this.attributePane.setAppConfig(a,c);c&&(this.lastAppConfig=d.clone(a));this._appHasChanged()?(this._enableSaveButton(),this._enableUnloadDlg()):(this._disableSaveButton(),this._disableUnloadDlg())},_hideAllContent:function(){b.setStyle(this.mapPane.domNode,"display","none");b.setStyle(this.widgetPane.domNode,"display","none");b.setStyle(this.themePane.domNode,"display","none")},_initPreviewItems:function(){b.empty(this.previewTbody);
var a=[];a.push({"class":"iPhone6",title:"iPhone6",width:375,height:667});a.push({"class":"iPhone6-plus",title:"iPhone6 plus",width:414,height:736});a.push({"class":"iPhone5",title:"iPhone5/5C/5S",width:320,height:568});a.push({"class":"iPhone4",title:"iPhone4/4S",width:320,height:480});a.push({"class":"iPad-Air",title:"iPad Air",width:768,height:1024});a.push({"class":"iPad4",title:"iPad with Retina Display",width:768,height:1024});a.push({"class":"new-iPad",title:"The New iPad",width:768,height:1024});
a.push({"class":"iPad-mini",title:"iPad Mini",width:768,height:1024});a.push({"class":"Samsung-Galaxy-S4",title:"Samsung Galaxy S4",width:360,height:640});a.push({"class":"Samsung-Note-3",title:"Samsung Note 3",width:360,height:640});a.push({"class":"Nexus-5",title:"Nexus 5",width:360,height:598});a.push({"class":"Nexus-4",title:"Nexus 4",width:384,height:598});a.push({"class":"Nexus-7",title:"Nexus 7",width:600,height:960});a.push({"class":"htc-one",title:"HTC One",width:360,height:640});a.push({"class":"xiaomi-3",
title:"Xiaomi 3",width:360,height:640});a.push({"class":"LG-G2",title:"LG G2",width:360,height:598});var c=Math.ceil(a.length/4),e;for(e=0;e<c;e++){var p=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");b.place(p,this.previewTbody)}c=f("td",this.previewTbody);for(e=0;e<a.length;e++){var p=c[e],z=this._createPreviewItem(a[e]);b.place(z,p)}},_createPreviewItem:function(a){var c=b.toDom('\x3cdiv class\x3d"preview-item"\x3e\x3cdiv class\x3d"preview-item-bg"\x3e\x3cdiv class\x3d"preview-item-thumbnail"\x3e\x3c/div\x3e\x3cdiv class\x3d"preview-selected-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan class\x3d"preview-item-title"\x3e\x3c/span\x3e\x3c/div\x3e');
c.args=a;var e=f(".preview-item-bg",c)[0],p=f(".preview-item-thumbnail",c)[0],z=f(".preview-item-title",c)[0];this.own(k(e,"click",d.hitch(this,this._onPreviewItemBgClick)));a["class"]&&b.addClass(p,a["class"]);z.innerHTML=a.title||"";return c},_onPreviewItemBgClick:function(a){a=a.target||a.srcElement;b.hasClass(a,"preview-item-thumbnail")&&(a=a.parentNode,f(".preview-item-bg",this.previewTbody).removeClass("selected"),b.addClass(a,"selected"),a=a.parentNode.args,this.customWidth.value=a.width,this.customHeight.value=
a.height,g.publish("onDeviceSelected",a,!1))},_onCustomSizeChanged:function(){var a=function(a){var c=!1;!isNaN(a)&&!isNaN(parseFloat(a))&&0<parseInt(a,10)&&(c=!0);return c},c=this.customWidth.value,e=this.customHeight.value;a(c)&&a(e)&&(f(".preview-item-bg",this.previewTbody).removeClass("selected"),c=parseInt(c,10),e=parseInt(e,10),g.publish("onDeviceSelected",{width:c,height:e},!0))},_appHasChanged:function(){var a=d.clone(this.appConfig.getCleanConfig()),c=d.clone(this.lastAppConfig.getCleanConfig());
a.theme&&(a.theme.styles&&c.theme&&c.theme.styles)&&(a.theme.styles.splice(1,a.theme.styles.length),c.theme.styles.splice(1,c.theme.styles.length));return!H.isEqual(a,c)},_enableUnloadDlg:function(){window.onbeforeunload=d.hitch(this,function(){return this.nls.theApp+' "'+K.byId("header").getAppName()+'" '+this.nls.unloadMessage})},_disableUnloadDlg:function(){window.onbeforeunload=null},_onLeavePage:function(a){var c=K.byId("header");if(this._appHasChanged())var e=new J({content:"\x3cdiv style\x3d'font-size: 14px'\x3e\x3cimg class\x3d'alert-image jimu-float-leading'  src\x3d'builder/css/images/alert.png'  style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+
this.nls.unSaveMegBegin+c.getAppName()+this.nls.unSaveMegEnd+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.toHomeTitle,width:425,height:180,buttons:[{label:this.nls.save,onClick:d.hitch(this,function(){"stemapp"===appId?(new I({message:this.nls.canNotSaveMeg}),e.close()):this._saveApp().then(d.hitch(this,function(p){e.close();p.success&&(window.onbeforeunload=null,c.setAppName(""),a())}),d.hitch(this,function(a){console.error(this.nls.saveFailedMeg,a)}))})},{label:this.nls.doNotSave,onClick:d.hitch(this,
function(){e.close();window.onbeforeunload=null;c.setAppName("");a()})},{label:this.nls.cancel,onClick:d.hitch(this,function(){e.close()})}]});else window.onbeforeunload=null,c.setAppName(""),a()}})})},"builder/config/MapConfig":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/MapConfig.html dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/on dojo/keys builder/portalUtils jimu/portalUrlUtils jimu/dijit/Message jimu/utils esri/geometry/Extent jimu/dijit/Popup ./MapSelector".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e){return t([b,g],{templateString:k,baseClass:"map-config",currentItemId:null,appConfig:null,map:null,widgetsConfigCache:null,postMixInProperties:function(){this.nls=h.mixin({},builderNls.common);this.nls=h.mixin(this.nls,builderNls.mapConfig);this.nls.clickChooseWebMap=this.nls.clickChooseWebMap||""},postCreate:function(){this.inherited(arguments);this._init()},_init:function(){this.widgetsConfigCache={};this.own(d.subscribe("mapLoaded",h.hitch(this,function(a){this._setMap(a)})));
this.own(d.subscribe("mapChanged",h.hitch(this,function(a){this._setMap(a);this._restoreToDefaultWebMapExtent()})));this.own(n(this.btnInitialExtent,"click",h.hitch(this,this._onBtnInitialExtentClicked)))},_setInitialExtent:function(){try{d.publish("configChanged","map",{mapOptions:{extent:this.map.extent.toJson()}},{reCreateMap:!1})}catch(a){console.error(a)}},_blinkMapContainer:function(){var a=0,c=setInterval(h.hitch(this,function(){l.toggleClass(this.map.container,"toggle-map-border");a++;6===
a&&clearInterval(c)}),200)},_onBtnInitialExtentClicked:function(){this.map&&(this._setInitialExtent(),this._blinkMapContainer())},_restoreToDefaultWebMapExtent:function(a){x.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.appConfig&&this.appConfig.geometryService).then(h.hitch(this,function(){this._setInitialExtent();a&&this._blinkMapContainer()}),h.hitch(this,function(a){"string"===typeof a&&new s({message:a});console.error(a)}))},_showMapSelector:function(){var a=new e,c=new v({width:1024,
titleLabel:this.nls.selectWebMap,content:a,container:"main-page",onClose:h.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(c){console.error(c)}a=null;return!0}),buttons:[{label:this.nls.ok,key:f.ENTER,onClick:h.hitch(this,function(){var e=a.getSelectedMapItem();this._selectItem(e,c)})},{label:this.nls.cancel,key:f.ESCAPE,onClick:h.hitch(this,function(){c.close()})}]})},_selectItem:function(a,c){if(a)if(this._hasSameWebMap(this.appConfig,{map:{portalUrl:a.portalUrl,itemId:a.id}}))c.close();
else{var e=this.appConfig,e=this._getHttpWebMapItemUrl(e.map.portalUrl||e.portalUrl,e.map.itemId);this.widgetsConfigCache[e]||(this.widgetsConfigCache[e]={});var b=this.widgetsConfigCache[e],B=h.clone(this.appConfig);B.map.portalUrl=a.portalUrl;B.map.itemId=a.id;var A=this._tryResetWidgetsConfigWhenMapSwitched(B);if(0<A.length){var e=q.map(A,h.hitch(this,function(a){return a.label})),z=l.toDom("\x3cdiv style\x3d'font-size:14px;line-height:22px;'\x3e\x3cdiv\x3e"+this.nls.mapSwitchConfimationTip+"\x3c/div\x3e\x3cdiv style\x3d'margin-top:25px;margin-bottom:20px;color:#596679;'\x3e"+
this.nls.theseWidgetsAre+":\x3c/div\x3e\x3cul class\x3d'reset-widget-list' style\x3d'color:#596679;'\x3e\x3c/ul\x3e\x3cdiv style\x3d'margin-top:25px;'\x3e"+this.nls.sureToSwitch+"\x3c/div\x3e\x3c/div\x3e"),D=m(".reset-widget-list",z)[0];q.forEach(e,h.hitch(this,function(a,c){var e=l.create("li",{innerHTML:a},D);0!==c&&(e.style.marginTop="8px")}));var C=new v({content:z,titleLabel:this.nls.mapSwitchConfimation,autoHeight:!0,width:640,buttons:[{label:this.nls.ok,onClick:h.hitch(this,function(){c.close();
C.close();d.publish("resetConfig",B);q.forEach(A,h.hitch(this,function(a){b[a.id]=a.config}))})},{label:this.nls.cancel,onClick:h.hitch(this,function(){C.close()})}]})}else c.close(),d.publish("configChanged","map",{portalUrl:a.portalUrl,itemId:a.id})}},_hasSameWebMap:function(a,c){var e=a&&a.map,b=e&&e.itemId,B=c&&c.map,d=B&&B.itemId;return(e=u.isSamePortalUrl(e&&e.portalUrl,B&&B.portalUrl))&&b===d},_setMap:function(a){this.map=a},setAppConfig:function(a){if(this.appConfig){var c=this._hasSameWebMap(this.appConfig,
a);this.appConfig=a;c||this._requestCurrentItem()}else this.appConfig=a,this._requestCurrentItem()},_getHttpWebMapItemUrl:function(a,c){var e=u.getItemUrl(a,c);return e=u.setHttpProtocol(e)},_tryResetWidgetsConfigWhenMapSwitched:function(a){var c=[],e=this._getHttpWebMapItemUrl(a.map.portalUrl||a.portalUrl,a.map.itemId);this.widgetsConfigCache[e]||(this.widgetsConfigCache[e]={});var b=this.widgetsConfigCache[e];a.visitElement(h.hitch(this,function(a){if(!a.widgets&&a.uri&&!1===a.keepConfigAfterMapSwithched){var e=
a.config,z=b&&b[a.id];z?a.config=z:delete a.config;if(e||z)a=h.clone(a),a.config=e,c.push(a)}}));return c},_requestCurrentItem:function(){var a=this.appConfig&&this.appConfig.map&&this.appConfig.map.itemId;if(a){var a={q:"id:"+a,num:1,f:"json"},c=r.getPortal(this.appConfig.map&&this.appConfig.map.portalUrl);c&&c.queryItems(a).then(h.hitch(this,function(a){this.domNode&&(a=a.results,0<a.length&&this._showSelectedWebMap(a[0]))}),h.hitch(this,function(a){console.debug("query item from portal failed",
a)}))}},_tryLocaleDate:function(a){var c=x.localizeDate(a,{selector:"date"});c||(c=a.toLocaleDateString());return c},_showSelectedWebMap:function(a){a.thumbnailUrl&&l.setStyle(this.divMapSelectedImg,"backgroundImage","url("+a.thumbnailUrl+")");this.snippet.innerHTML=a.snippet||"";this.lastModified.innerHTML=this._tryLocaleDate(new Date(a.modified));this.lastModified.title=this.lastModified.innerHTML;this.webMapDetails.href=a.detailsPageUrl;this.owner.innerHTML=a.owner||"";this.owner.title=this.owner.innerHTML;
this.owner.href=a.ownerPageUrl||"";this.mapTitle.innerHTML=a.title;l.setStyle(this.mapSelectedSection,"display","block")}})})},"builder/portalUtils":function(){define(["jimu/BasePortalUtils","builder/tokenUtils"],function(t,d){var b=new t;b.declaredClass="builder.PortalUtils";b.setTokenUtils(d);return b})},"builder/tokenUtils":function(){define(["jimu/BaseTokenUtils","dojo/topic"],function(t,d){var b=new t;b.declaredClass="builder.TokenUtils";b.isRightWindowScope=function(){return this.isInBuilderWindow()};
b.tryPublishUserSignInToExternal=function(b){this.isRightWindowScope()&&d.publish("builderUserSignIn",b)};b.tryPublishUserSignOutToExternal=function(b){this.isRightWindowScope()&&d.publish("builderUserSignOut",b)};b.startup();return b})},"builder/config/MapSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/MapSelector.html dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on jimu/utils jimu/dijit/TabContainer3 jimu/portalUrlUtils jimu/dijit/Search builder/portalUtils builder/config/MapTable".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e){return t([b,g,k],{templateString:h,baseClass:"map-selector",tab:null,isPublicTabShow:!1,_user:null,_group:null,_webMapQueryString:"",_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_signIn:!1,portal:null,postMixInProperties:function(){this.nls=
l.mixin({},builderNls.common);this.nls=l.mixin(this.nls,builderNls.mapConfig)},postCreate:function(){this.inherited(arguments);this._webMapQueryString=" "+u.getItemQueryStringByTypes(["Web Map"])+" ";this.portal=v.getPortal(this._getPortalUrl());this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initMapTables();this._initPrivate();this._initPublic();this._bindMapTableEvents();this._updateUIbySignIn()},startup:function(){this.tab._started||(this.tab.startup(),this.tab._started=
!0)},_initTabs:function(){var a={title:this.nls.myContent,content:this.mycontentTabNode},c={title:this.nls.myOrganization,content:this.organizationTabNode},e={title:this.nls.myGroup,content:this.groupTabNode},b={title:this.nls.publicMap,content:this.publicTabNode};this.isPublicTabShow=!1;this.tab=new s({tabs:[a,c,e,b]},this.tabNode);this.own(r(this.tab,"tabChanged",l.hitch(this,function(a){n.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this.isPublicTabShow=!1,this._updateUIbySignIn(),
this.portal.getUser().then(l.hitch(this,function(c){a===this.nls.myContent?this._searchMyContent(c):a===this.nls.myOrganization?this._searchOrganization(c):a===this.nls.myGroup&&this._searchGroups(c)}))):(this.isPublicTabShow=!0,this._searchPublic())})))},_bindMapTableEvents:function(){this.own(r(this.mycontentMapTable,"select",l.hitch(this,this._onMapSelected)));this.own(r(this.organizationMapTable,"select",l.hitch(this,this._onMapSelected)));this.own(r(this.groupMapTable,"select",l.hitch(this,this._onMapSelected)));
this.own(r(this.publicPortalMapTable,"select",l.hitch(this,this._onMapSelected)));this.own(r(this.publicOnlineMapTable,"select",l.hitch(this,this._onMapSelected)))},_onMapSelected:function(a){if(a=a&&a.selectedNode)this.mycontentMapTable.unselect(),this.organizationMapTable.unselect(),this.groupMapTable.unselect(),this.publicPortalMapTable.unselect(),this.publicOnlineMapTable.unselect(),n.addClass(a,"selected")},_updateUIbySignIn:function(){n.setStyle(this.signinSection,"display","none");var a=f(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",
this.domNode);this.portal.haveSignIn()?a.style("display","block"):(a.style("display","none"),this.isPublicTabShow||n.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){u.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalNameLabel);u.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlineNameLabel);var a=this._getPortalUrl(),a=x.getServerByUrl(a);x.isArcGIScom(a)?(this.portalPublicRaido.disabled=!0,this.onlinePublicRaido.checked=!0,n.setStyle(this.portalPublicRaido,
"display","none"),n.setStyle(this.portalNameLabel,"display","none")):(this.portalPublicRaido.disabled=!1,this.portalPublicRaido.checked=!0,this.portalNameLabel.innerHTML=a)},_initSearchQuery:function(){var a="esri_"+(q.locale&&q.locale.slice(0,2)||"en").toLowerCase(),c=m.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
l.hitch(this,function(c){return c!==a})),e="";m.forEach(c,l.hitch(this,function(a){e+=" -owner:"+a+" "}));c=" ";this.portal.user&&this.portal.user.orgId&&(c=" orgid:"+this.portal.user.orgId+" ");c=c+this._webMapQueryString+" AND access:public "+e;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:c});this._filterPublicPortalQuery=this._getQuery({q:c,basicQ:c});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:'(group:"c755678be14e4a0984af36a15f5b643e" OR group:"b8787a74b4d74f7fb9b8fac918735153") '+
this._webMapQueryString+" AND access:public"});this._filterPublicOnlineQuery=this._getQuery({q:this._webMapQueryString+" AND access:public"});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return l.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return x.getStandardPortalUrl(window.portalUrl)},
_initMapTables:function(){var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalMapTable.set("portalUrl",a),this.publicPortalMapTable.set("filteredQuery",this._filterPublicPortalQuery));this.publicOnlineMapTable.set("portalUrl",window.location.protocol+"//www.arcgis.com");this.publicOnlineMapTable.set("filteredQuery",this._filterPublicOnlineQuery)},_initPublic:function(){this.own(r(this.portalPublicRaido,"click",l.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));
this.own(r(this.onlinePublicRaido,"click",l.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalMapTable.show(),this.publicOnlineMapTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalMapTable.hide(),this.publicOnlineMapTable.show())},_onPublicSearch:function(a){(a=a&&l.trim(a))?(this.publicPortalMapTable.showFilterMapsSection(),this.publicOnlineMapTable.showFilterMapsSection(),
this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalMapTable.searchFilteredMaps(this._filterPublicPortalQuery)):this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+this._webMapQueryString+" AND access:public",this._filterPublicOnlineQuery.start=1,this.publicOnlineMapTable.searchFilteredMaps(this._filterPublicOnlineQuery))):(this.publicPortalMapTable.showAllMapsSection(),this.publicOnlineMapTable.showAllMapsSection())},
_searchPublic:function(){this.tab.getSelectedTitle()===this.nls.publicMap&&(this.publicTabNode.isSearched||this._searchPublicByRadio())},_searchPublicByRadio:function(){this.portalPublicRaido.checked?this.publicPortalMapTable.isSearched||(this.publicPortalMapTable.searchAllMaps(this._allPublicPortalQuery),this.publicPortalMapTable.isSearched=!0):this.publicOnlineMapTable.isSearched||(this.publicOnlineMapTable.searchAllMaps(this._allPublicOnlineQuery),this.publicOnlineMapTable.isSearched=!0)},_initPrivate:function(){this._resetPortalMaps();
this.own(d.subscribe("userSignIn",l.hitch(this,this._onSignIn)));this.own(d.subscribe("userSignOut",l.hitch(this,this._onSignOut)));this.own(r(this.groupsSelect,"change",l.hitch(this,this._onGroupsSelectChange)));var a=x.getServerByUrl(this._getPortalUrl());x.isArcGIScom(a);this.portal.haveSignIn()&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&l.trim(a)){if(this._allOrganizationQuery){var c=this._allOrganizationQuery.q;c&&(this._filterOrganizationQuery.q=a+" "+c,this._filterOrganizationQuery.start=
1,this.organizationMapTable.searchFilteredMaps(this._filterOrganizationQuery))}}else this.organizationMapTable.showAllMapsSection()},_onMyContentSearch:function(a){if(a=a&&l.trim(a)){if(this._allMyContentQuery){var c=this._allMyContentQuery.q;c&&(this._filterMyContentQuery.q=a+" "+c,this._filterMyContentQuery.start=1,this.mycontentMapTable.searchFilteredMaps(this._filterMyContentQuery))}}else this.mycontentMapTable.showAllMapsSection()},_onGroupSearch:function(a){if(a=a&&l.trim(a)){if(this._allGroupQuery){var c=
this._allGroupQuery.q;c&&(this._filterGroupQuery.q=a+" "+c,this._filterGroupQuery.start=1,this.groupMapTable.searchFilteredMaps(this._filterGroupQuery))}}else this.groupMapTable.showAllMapsSection()},_onSignIn:function(){this._updateUIbySignIn();this._signIn||(this._signIn=!0,this.portal.getUser().then(l.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))})))},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();
this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationMapTable.clear();this.mycontentMapTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){if(this.tab.getSelectedTitle()===this.nls.myOrganization&&!this.organizationTabNode.isSearched){this.organizationMapTable.clear();a=" orgid:"+a.orgId+" AND "+this._webMapQueryString+" AND (access:org OR access:public) ";var c=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=
this._getQuery({q:a});this.organizationMapTable.set("portalUrl",c);this.organizationMapTable.searchAllMaps(this._allOrganizationQuery);this.organizationTabNode.isSearched=!0}},_searchMyContent:function(a){if(this.tab.getSelectedTitle()===this.nls.myContent&&!this.mycontentTabNode.isSearched){this.mycontentMapTable.clear();var c=this._getPortalUrl();a="owner:"+a.username+" AND "+this._webMapQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentMapTable.set("portalUrl",
c);this.mycontentMapTable.searchAllMaps(this._allMyContentQuery);this.mycontentTabNode.isSearched=!0}},_searchGroups:function(a){if(this.tab.getSelectedTitle()===this.nls.myGroup&&!this.groupTabNode.isSearched){this._resetGroupsSection();n.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){n.setStyle(this.groupSearch.domNode,"display","block");this.groupMapTable.show();n.empty(this.groupsSelect);for(var c=0;c<a.length;c++){var e=a[c];n.create("option",{value:e.id,innerHTML:e.title},
this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length);this.groupTabNode.isSearched=!0}},_resetGroupsSection:function(){n.setStyle(this.groupsSection,"display","none");n.empty(this.groupsSelect);n.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupMapTable.clear();n.setStyle(this.groupSearch.domNode,"display","none");this.groupMapTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?n.setStyle(this.groupsSection,
"top","15px"):n.setStyle(this.groupsSection,"top","70px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupMapTable.clear();if("nodata"===a)n.setStyle(this.groupSearch,"display","none"),this.groupMapTable.hide();else{n.setStyle(this.groupSearch,"display","block");this.groupMapTable.show();var c=this._getPortalUrl(),a="group:"+a+" AND "+this._webMapQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupMapTable.set("portalUrl",
c);this.groupMapTable.searchAllMaps(this._allGroupQuery)}},getSelectedMapItem:function(){var a=null,c=f(".map-item-bg.selected",this.domNode);0<c.length&&(a=c[0].parentNode.item);return a}})})},"builder/config/MapTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w){return t([d,b,g,h],{templateString:k,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,originalSelectedId:null,postMixInProperties:function(){this.nls=q.mixin({},builderNls.common);this.nls=q.mixin(this.nls,builderNls.mapConfig);this.nls.viewItemDetails=this.nls.viewItemDetails||""},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=x.getStandardPortalUrl(this.portalUrl));
this.own(r(this.allMapsTableDiv,"scroll",q.hitch(this,this._onAllMapsSectionScroll)));this.own(r(this.filteredMapsTableDiv,"scroll",q.hitch(this,this._onFilteredMapsSectionScroll)));this.showAllMapsSection();this.searchAllMaps()},show:function(){m.setStyle(this.domNode,"display","block")},hide:function(){m.setStyle(this.domNode,"display","none")},searchAllMaps:function(b){this.showAllMapsSection();b&&(this.query=q.mixin({},b),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&
0<this.query.start&&(this.allMapsShelter.show(),s.getPortal(this.portalUrl).queryItems(this.query).then(q.hitch(this,function(e){this.domNode&&(this.allMapsShelter.hide(),this.query.start=e.nextStart,this._createMapItems(e,this.allMapsTbody))}),q.hitch(this,function(e){console.error(e);this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(b){this.showFilterMapsSection();b&&(this.filteredQuery=q.mixin({},b),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&
this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),s.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(q.hitch(this,function(e){this.domNode&&(this.filteredMapsShelter.hide(),this.filteredQuery.start=e.nextStart,this._createMapItems(e,this.filteredMapsTbody),0===this._getWebMapCount(this.filteredMapsTbody)&&(m.setStyle(this.filteredMapsTableDiv,"display","none"),m.setStyle(this.searchNoneTipSection,"display","block")))}),q.hitch(this,function(e){console.error(e);
this.domNode&&(this.filteredMapsShelter.hide(),0===this._getWebMapCount(this.filteredMapsTbody)&&(m.setStyle(this.filteredMapsTableDiv,"display","none"),m.setStyle(this.searchNoneTipSection,"display","block")))})))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},clearAllMapsSection:function(){m.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){m.empty(this.filteredMapsTbody)},showAllMapsSection:function(){m.setStyle(this.allMapsSection,"display","block");
m.setStyle(this.filteredMapsSection,"display","none")},showFilterMapsSection:function(){m.setStyle(this.allMapsSection,"display","none");m.setStyle(this.filteredMapsSection,"display","block");m.setStyle(this.filteredMapsTableDiv,"display","block");m.setStyle(this.searchNoneTipSection,"display","none")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},
_isScrollToBottom:function(b){return u.isScrollToBottom(b)},_createMapItems:function(b,e){var a=l.filter(b.results,q.hitch(this,function(a){return"web map"===a.type.toLowerCase()}));if(0!==a.length){var c={},p,y=f("td.empty",e),d;if(0<y.length){var A=a.splice(0,y.length);for(d=0;d<y.length;d++){var z=y[d];p=this._createMapItem(A[d]);c[p.item.id]=p;m.place(p,z);m.removeClass(z,"empty")}}if(0!==a.length){y=Math.ceil(a.length/5);for(d=0;d<y;d++){p=m.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");
m.place(p,e);A=f("td",p);for(z=0;z<A.length;z++){var D=A[z];(p=a[5*d+z])?(p=this._createMapItem(p),c[p.item.id]=p,m.place(p,D)):m.addClass(D,"empty")}}if(!this.getSelectedMapItem()&&(this.appConfig&&this.appConfig.map.itemId)&&(p=c[this.appConfig.itemId]))a=f(".map-item-bg",p),m.addClass(a,"selected")}}},_getWebMapCount:function(b){return f(".map-item-div",b).length},_createMapItem:function(b){var e=m.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
a=f(".map-item-bg",e)[0],c=f(".map-item-thumbnail",e)[0],d=f(".map-item-title",e)[0],y=f(".map-item-detail-icon",e)[0],B=f(".none-thumbnail-tip",e)[0];y.href=b.detailsPageUrl;y.title=this.nls.viewItemDetails||"";e.item=b;b.thumbnailUrl?m.setStyle(c,"backgroundImage","url("+b.thumbnailUrl+")"):B.innerHTML=this.nls.noneThumbnail;this.own(r(a,"click",q.hitch(this,this._onMapItemBgClick)));d.innerHTML=b.title;d.title=b.title;return e},unselect:function(){f(".map-item-bg",this.domNode).removeClass("selected")},
_onMapItemBgClick:function(b){b=b.target||b.srcElement;var e=null;m.hasClass(b,"map-item-thumbnail")?e=b.parentNode:m.hasClass(b,"none-thumbnail-tip")&&(e=b.parentNode.parentNode);e&&m.hasClass(e,"map-item-bg")&&(this.unselect(),m.addClass(e,"selected"),this.emit("select",{mapTable:this,selectedNode:e}))},getSelectedMapItem:function(){var b=null,e=f(".map-item-bg.selected",this.domNode);0<e.length&&(b=e[0].parentNode.item);return b}})})},"builder/config/ThemeConfig":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/on dojo/aspect dojo/mouse dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ThemeConfig.html dojo/dom-construct dojo/dom-class dojo/dom-style dojo/dom-attr dojo/_base/array dojo/Deferred dojo/request dojo/dom jimu/utils jimu/dijit/Message ./ThemeManager ../serviceUtils".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A){return t([n,f],{templateString:r,themeLoadDef:void 0,constructor:function(){},postMixInProperties:function(){this.nls=d.mixin({},builderNls.common,builderNls.themes)},startup:function(){this.inherited(arguments);this.themeManager=new B;this.themeLoadDef=this.themeManager.loadThemes();this.themeLoadDef.then(d.hitch(this,function(a){this.initThemePage(a)}))},initThemePage:function(a){var c,e,y,p,B,A;v.forEach(a,function(a){B=b.create("div",{"class":"catalog-theme-content-div jimu-float-leading"},
this.themeList);c=b.create("div",{"class":"catalog-theme-div"},B);b.create("div",{"class":"catalog-theme-name-div",innerHTML:a.getLabel(),title:a.getLabel()},B);A=b.create("div",{"class":"catalog-theme-img-div"},c);u.create("img",{src:a.getIcon(),"class":"catalog-theme-img"},A);e=u.create("div",{"class":"theme-cl-selected-div"},c);u.create("img",{"class":"theme-cl-selected-img",src:"builder/css/images/check.png"},e);k(c,"click",d.hitch(this,this._onStartChangeTheme,a.getName()));y=u.create("div",
{"class":""},this.styleList);this.initStyle(a,y);p=u.create("div",{"class":""},this.layoutList);this.initLayout(a,p);a.domNodes.theme=c;a.domNodes.themeSL=e;a.domNodes.styleList=y;a.domNodes.layoutList=p},this)},initStyle:function(a,c){var e,y,p,B;e=u.create("div",{"class":"style-section"},c);u.create("div",{innerHTML:this.nls.styleTitle,"class":"style-text"},e);B=u.create("div",{"class":"style-color-content"},e);v.forEach(a.getStyles(),function(a){y=u.create("div",{"class":"style-div jimu-float-leading"},
B);x.set(y,"backgroundColor",a.styleColor);a.domNode=y;k(y,"click",d.hitch(this,this._onStyleChanged,a.name));p=u.create("div",{"class":"style-selected-div"},y);u.create("img",{"class":"style-selected-img",src:"builder/css/images/check.png"},p);a.selectedNode=p},this);b.setStyle(c,"display","none")},initLayout:function(a,c){var e;e=u.create("div",{"class":"layout-section",id:a.getName()+"-layout-section"},c);u.create("div",{innerHTML:this.nls.layoutTitle,"class":"layout-text"},e);v.forEach(a.getLayouts(),
function(c){this._drawLayout(a,c,e)},this);b.setStyle(c,"display","none")},_drawLayout:function(a,c,e){var b;c.domClass||(c.domClass=" ");e=u.create("div",{"class":"layout-out-div jimu-float-leading"+c.domClass},e);b=u.create("div",{"class":"layout-box-div "+c.domClass},e);e=u.create("div",{"class":"layout-div "+c.domClass,title:c.label},b);a=isRTL?c.RTLIcon?a.getUrl()+c.RTLIcon:"builder/css/images/current_layout.png":c.icon?a.getUrl()+c.icon:"builder/css/images/current_layout.png";u.create("img",
{"class":"layout-image",src:a},e);c.domNode=e;c.boxDomNode=b;k(e,"click",d.hitch(this,this._onLayoutChanged,c.name));a=u.create("div",{"class":"layout-selected-div"},e);u.create("img",{"class":"layout-selected-img",src:"builder/css/images/check.png"},a);c.selectedNode=a},_onStyleChanged:function(a){this.changeStyle(a,null,!0)},_onLayoutChanged:function(a){this.changeLayout(a,null,!0)},_onStartChangeTheme:function(a){if(this.themeManager.currentThemeName!==a)var c=new y({message:this.nls.themeChangeMessage,
buttons:[{label:this.nls.ok,onClick:d.hitch(this,function(){c.close();this.changeTheme(a,!0)})},{label:this.nls.cancel}]})},changeStyle:function(a,c,e){c||(c=this.themeManager.getCurrentTheme());c.currentStyleName!==a&&(c.currentStyleName&&b.removeClass(c.getCurrentStyle().domNode,"style-selected"),c.changeCurrentStyle(a),b.addClass(c.getCurrentStyle().domNode,"style-selected"),e&&g.publish("styleChanged",d.clone(c.getCurrentStyle())))},changeLayout:function(a,c,e){c||(c=this.themeManager.getCurrentTheme());
c.currentLayoutName!==a&&(c.currentLayoutName&&(b.removeClass(c.getCurrentLayout().domNode,"layout-selected"),b.removeClass(c.getCurrentLayout().boxDomNode,"layout-box-selected")),c.changeCurrentLayout(a),b.addClass(c.getCurrentLayout().domNode,"layout-selected"),b.addClass(c.getCurrentLayout().boxDomNode,"layout-box-selected"),e&&g.publish("layoutChanged",d.clone(c.getCurrentLayout())))},_copyThemeFromRepo:function(a){var c=new e,b=this.themeManager.getThemeByName(a);b.loadLayouts().then(d.hitch(this,
function(){var e=b.getLayoutByName("default");A.copyThemeToApp(appId,a,b.appConfig?b.appConfig.getCleanConfig():e.layoutConfig).then(d.hitch(this,function(a){a.success?c.resolve():(c.reject(),console.error("change theme error, response of 'copytheme' unsuccess"))}),function(a){c.reject(a);console.error("change theme error"+a)})}));return c},changeTheme:function(a,c){var y=new e;this.themeManager.currentThemeName!==a?(g.publish("startChangeTheme"),this._copyThemeFromRepo(a).then(d.hitch(this,function(){this.themeManager.currentThemeName&&
(b.removeClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected"),b.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","none"),b.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","none"));this.themeManager.changeCurrentTheme(a);c&&g.publish("themeChanged",d.clone(this.themeManager.getCurrentTheme()));b.addClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected");b.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,
"display","block");b.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","block");y.resolve()}))):y.resolve();return y},setAppConfig:function(a,e){var y,p;this.themeLoadDef.then(d.hitch(this,function(){e?(v.forEach(this.themeManager.themes,function(a){this.changeStyle("default",a,!1);this.changeLayout("default",a,!1);a.clear()},this),this.changeTheme(a.theme.name,!1).then(d.hitch(this,function(){a.theme.styles&&a.theme.styles[0]&&this.changeStyle(a.theme.styles[0],this.themeManager.getCurrentTheme(),
!1);y=c.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");p=this.themeManager.getCurrentTheme().getLayoutByAppConfig(a.getCleanConfig());p||(p=this.themeManager.getCurrentTheme().addLayout("appLayout",a.getCleanConfig(),"app-layout"),this._drawLayout(this.themeManager.getCurrentTheme(),p,y));this.changeLayout(p.name,this.themeManager.getCurrentTheme(),!1);this.themeManager.getCurrentTheme().setAppConfig(a);b.setStyle(this.themeList,"display","block")}))):this.themeManager.getCurrentTheme()&&
this.themeManager.getCurrentTheme().setAppConfig(a)}))}})})},"builder/config/ThemeManager":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/request dojo/on dojo/Deferred dojo/promise/all ./Theme ../serviceUtils jimu/utils".split(" "),function(t,d,b,g,k,h,q,l,m,n){return t(null,{themes:void 0,constructor:function(){this.currentThemeName=null;this.themes=[]},loadThemes:function(){var f=new h;m.getAllThemes().then(b.hitch(this,function(b){b.success?(b.themes=b.themes.sort(function(b,
d){return b.name>d.name}),d.forEach(b.themes,function(b){n.processManifestLabel(b,dojoConfig.locale);this.themes.push(new l(b))},this),f.resolve(this.themes)):(console.error("Gets themes failed! The response of getThemes is 'unsuccess'!"),f.reject(this.themes))}),function(b){console.error("Gets themes failed!"+b);f.reject(this.themes)});return f},changeCurrentTheme:function(b){this.currentThemeName=b},getCurrentTheme:function(){return this.getThemeByName(this.currentThemeName)},getThemeByName:function(b){for(var d=
0;d<this.themes.length;d++)if(b===this.themes[d].getName())return this.themes[d]}})})},"builder/config/Theme":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/request jimu/utils".split(" "),function(t,d,b,g,k,h,q,l){return t(null,{appConfig:void 0,currentStyleName:void 0,currentLayoutName:void 0,_manifest:void 0,constructor:function(b){this._manifest=b;this.domNodes={}},clear:function(){var d;this.appConfig=null;for(d=0;d<this._manifest.layouts.length;d++)if("appLayout"===
this._manifest.layouts[d].name){this._manifest.layouts[d].domNode&&b.destroy(this._manifest.layouts[d].domNode);this._manifest.layouts.splice(d,1);break}},loadLayouts:function(){var b=new k,n=[],f=g.filter(this._manifest.layouts,function(b){return"appLayout"!==b.name});g.forEach(f,function(b){n.push(q(this._manifest.url+b.uri,{handleAs:"json"}))},this);h(n).then(d.hitch(this,function(d){g.forEach(f,function(b,f){b.layoutConfig=d[f]},this);b.resolve()}),function(){b.reject()});return b},setAppConfig:function(b){this.appConfig=
b},getName:function(){return this._manifest.name},getVersion:function(){return this._manifest.version},getLabel:function(){return this._manifest.label},getIcon:function(){return this._manifest.icon},getLayouts:function(){return this._manifest.layouts},getStyles:function(){return this._manifest.styles},getUrl:function(){return this._manifest.url},getCurrentStyle:function(){return this.getStyleByName(this.currentStyleName)},getCurrentLayout:function(){return this.getLayoutByName(this.currentLayoutName)},
changeCurrentStyle:function(b){this.currentStyleName=b},changeCurrentLayout:function(b){this.currentLayoutName=b},addLayout:function(b,d,f){var g,h=this.getLayouts();for(g=0;g<h.length;g++)if(h[g].name===b)return null;b={description:"this is current app layout",name:b,label:window.builderNls.themes.appLayout,layoutConfig:d,domClass:f};this._manifest.layouts.push(b);return b},getStyleByName:function(b){var d,f=null;for(d=0;d<this._manifest.styles.length;d++)if(this._manifest.styles[d].name===b){f=
this._manifest.styles[d];break}return f},getLayoutByName:function(b){var d,f=null;for(d=0;d<this._manifest.layouts.length;d++)if(this._manifest.layouts[d].name===b){f=this._manifest.layouts[d];break}return f},getLayoutByAppConfig:function(b){var d,f=null;for(d=0;d<this._manifest.layouts.length;d++)if(this.isAppUseLayout(b,this._manifest.layouts[d].layoutConfig)){f=this._manifest.layouts[d];break}return f},isAppUseLayout:function(b,g){var f=d.clone(b),h=d.clone(g);f.map||(f.map={});h.map||(h.map=f.map);
f.map.position||(f.map.position={left:0,top:0});h.map.position||(h.map.position=f.map.position);if(!l.isEqual(f.map.position,h.map.position))return!1;f.widgetOnScreen||(f.widgetOnScreen={});h.widgetOnScreen||(h.widgetOnScreen={});f.widgetOnScreen.widgets||(f.widgetOnScreen.widgets=[]);h.widgetOnScreen.widgets||(h.widgetOnScreen.widgets=[]);f.widgetOnScreen.groups||(f.widgetOnScreen.groups=[]);h.widgetOnScreen.groups||(h.widgetOnScreen.groups=[]);var k,s;k=f.widgetOnScreen.widgets.length<h.widgetOnScreen.widgets.length?
f.widgetOnScreen.widgets.length:h.widgetOnScreen.widgets.length;for(s=0;s<k;s++){f.widgetOnScreen.widgets[s].positionRelativeTo||(f.widgetOnScreen.widgets[s].positionRelativeTo="map");h.widgetOnScreen.widgets[s].positionRelativeTo||(h.widgetOnScreen.widgets[s].positionRelativeTo=f.widgetOnScreen.widgets[s].positionRelativeTo);if(f.widgetOnScreen.widgets[s].positionRelativeTo!==h.widgetOnScreen.widgets[s].positionRelativeTo)return!1;f.widgetOnScreen.widgets[s].position||(f.widgetOnScreen.widgets[s].position=
{left:0,top:0});h.widgetOnScreen.widgets[s].position||(h.widgetOnScreen.widgets[s].position=f.widgetOnScreen.widgets[s].position);if(!l.isEqual(f.widgetOnScreen.widgets[s].position,h.widgetOnScreen.widgets[s].position))return!1}k=f.widgetOnScreen.groups.length<h.widgetOnScreen.groups.length?f.widgetOnScreen.groups.length:h.widgetOnScreen.groups.length;for(s=0;s<k;s++){f.widgetOnScreen.groups[s].panel||(f.widgetOnScreen.groups[s].panel={});h.widgetOnScreen.groups[s].panel||(h.widgetOnScreen.groups[s].panel=
f.widgetOnScreen.groups[s].panel);f.widgetOnScreen.groups[s].panel.positionRelativeTo||(f.widgetOnScreen.groups[s].panel.positionRelativeTo="map");h.widgetOnScreen.groups[s].panel.positionRelativeTo||(h.widgetOnScreen.groups[s].panel.positionRelativeTo=h.widgetOnScreen.groups[s].panel.positionRelativeTo);if(f.widgetOnScreen.groups[s].panel.positionRelativeTo!==h.widgetOnScreen.groups[s].panel.positionRelativeTo)return!1;f.widgetOnScreen.groups[s].panel.position||(f.widgetOnScreen.groups[s].panel.position=
{left:0,top:0});h.widgetOnScreen.groups[s].panel.position||(h.widgetOnScreen.groups[s].panel.position=f.widgetOnScreen.groups[s].panel.position);if(!l.isEqual(f.widgetOnScreen.groups[s].panel.position,h.widgetOnScreen.groups[s].panel.position))return!1}return!0},getLayoutFromConfig:function(b){var h={};b=d.clone(b);b.widgetOnScreen&&(h.widgetOnScreen={},b.widgetOnScreen.widgets&&(h.widgetOnScreen.widgets=[],g.forEach(b.widgetOnScreen.widgets,function(b,d){h.widgetOnScreen.widgets[d]={position:b.position?
b.position:{left:0,top:0}}})),b.widgetOnScreen.groups&&(h.widgetOnScreen.groups=[],g.forEach(b.widgetOnScreen.groups,function(b,d){h.widgetOnScreen.groups[d]={position:b.position?b.position:{left:0,top:0}}})));b.map&&(h.map={position:b.map.position});return h}})})},"builder/serviceUtils":function(){define("dojo/_base/lang dojo/cookie dojo/i18n dojo/request/xhr dojo/Deferred dojo/json dojo/_base/array esri/request jimu/utils jimu/portalUrlUtils builder/portalUtils dojo/promise/all builder/tokenUtils".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u){function s(a){return g("/builder/rest/signininfo/getsignininfo",{query:{portalUrl:a},handleAs:"json"})}function x(a,c,b,e,d,p){c.title=a.name;c.isWebTier=p;c.portalUrl=b;c.map.itemId=e;c.geometryService=d.helperServices.geometry.url;a.webmap||(c.map.mapOptions||(c.map.mapOptions={}),c.map.mapOptions.extent=d.defaultExtent);a="/proxy.js";window.isXT||(a=n.getPortalProxyUrl(c.portalUrl),a=n.removeProtocol(a));c.httpProxy={useProxy:!0,url:a}}function w(a,c){var b=
new k,e={title:a.name,type:"Web Mapping Application",typeKeywords:"Web AppBuilder",text:h.stringify(c),snippet:a.description,tags:a.tags},d=n.getStandardPortalUrl(window.portalUrl);f.getPortal(d).getUser().then(function(c){a.folderId===c.username&&(a.folderId="");c.addItem(e,a.folderId).then(function(e){e.success?(e.user=c,b.resolve(e),c.addItem({title:a.name,type:"Code Attachment",typeKeywords:"Code, Web Mapping Application, Javascript",relationshipType:"WMA2Code",originItemId:e.id,url:n.getItemUrl(n.getPortalUrlFromLocation(),
e.id)+"/package"},a.folderId).then(function(a){a.success||console.error(builderNls.serviceUtils.createCodeAttachmentError)},function(a){console.error(builderNls.serviceUtils.createCodeAttachmentError,a.message)})):b.resolve(e)},function(a){b.reject(a)})},function(a){b.reject(a)});return b}function v(a){var c=new k;g("stemapp/"+a+"/list.json",{handleAs:"json"}).then(function(b){return e(b,a).then(function(a){c.resolve({success:!0,manifests:a})})},function(a){c.reject({success:!1,message:a.message})});
return c}function e(c,b){var e=[],d=new k;c._buildInfo&&c._buildInfo.widgetManifestsMerged?g("stemapp/"+b+"/"+b+"-manifest-builder.json",{handleAs:"json"}).then(function(c){var e=[],p;for(p in c)e.push(c[p]);return a(e,b).then(function(){d.resolve(e)})}):(q.forEach(c[b],function(a){e.push(g("stemapp/"+b+"/"+a+"/manifest.json",{handleAs:"json"}))}),r(e).then(function(c){return a(c,b).then(function(){d.resolve(c)})}));return d}function a(a,b){var e=[],d=new k;q.forEach(a,function(a){a.category="widgets"===
b?"widget":"theme";a.url="stemapp/"+a.category+"s/"+a.name+"/";a.amdFolder=a.category+"s/"+a.name+"/";e.push(c(a))});r(e).then(function(){d.resolve()},function(a){d.reject(a)});return d}function c(a){m.addManifestProperies(a);return m.addI18NLabel(a)}var p={checkAppVersion:function(a){var c=new k;g("/builder/rest/apps/checkVersion",{method:"POST",data:{appConfig:h.stringify(a)},handleAs:"json"}).then(t.hitch(this,function(a){a.success?c.resolve(a):c.reject(a)}),t.hitch(this,function(a){c.reject(a)}));
return c.promise},importApp:function(a,c){var b=new k;delete a.agolTemplateInfo;g("/builder/rest/apps/import",{method:"POST",handleAs:"json",data:{appConfig:h.stringify(a),appInfo:h.stringify(c)}}).then(t.hitch(this,function(a){a.success?b.resolve(a):b.reject(a)}),t.hitch(this,function(a){b.reject(a)}));return b.promise},getAppList:function(){var a=new k,c=n.getStandardPortalUrl(window.portalUrl),b;isXT?(b=f.getPortal(c),b.getUser().then(function(b){g("/builder/rest/apps/list?username\x3d"+b.username+
"\x26portalUrl\x3d"+c,{handleAs:"json"}).then(function(c){a.resolve(c)},function(c){a.reject(c)})},function(c){a.reject(c)})):(b=f.getPortal(c))?b.getUser().then(function(c){c.getItemsByKeywords("Web AppBuilder").then(function(c){var b=[];(c=c&&c.results)&&0<c.length&&(b=q.map(c,function(a){return{name:a.title,description:a.description,id:a.id}}));a.resolve(b)},function(c){console.error(c);a.reject({success:!1,message:""})})},function(c){console.error(c);a.reject({success:!1,message:""})}):a.reject({success:!1,
message:""});return a},getAppInfo:function(a){if(isXT)return g("/builder/rest/apps/"+a,{handleAs:"json"});var c=new k,b=n.getStandardPortalUrl(window.portalUrl);f.getPortal(b).getItemById(a).then(function(a){c.resolve({name:a.title,description:a.description,id:a.id})});return c},updateApp:function(a){var c=new k,b=n.getStandardPortalUrl(window.portalUrl);isXT?f.getPortal(b).getUser().then(function(e){g("/builder/rest/apps/updateapp",{handleAs:"json",method:"POST",data:{id:a.id,name:a.name,description:a.description,
modified:e.username||"",creator:a.creator,portalUrl:b}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)}):c.resolve({success:!0});return c},createApp:function(a){var c=new k,b,e=n.getStandardPortalUrl(window.portalUrl),d=f.getPortal(e);b=d.loadSelfInfo();var C=d.getUser(),d=null;a.webmap?(d=new k,d.resolve(a.webmap)):d=f.getDefaultWebMap(e);if(isXT){var h=s(e);b=[b,C,d,h];r(b).then(function(b){var d=b[0],p=b[1],f=b[2];b=b[3];var A={map:{}};x(a,A,n.getStandardPortalUrl(b.info.portalUrl),
f,d,b.info.isWebTier?!0:!1);g("/builder/rest/apps/createapp",{handleAs:"json",method:"POST",data:{name:a.name,description:a.description,is3D:a.is3D,creator:p.username||"",modified:p.username||"",extraPropertyOfAppConfig:JSON.stringify(A),portalUrl:e}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){console.error(a);c.reject({success:!1,message:builderNls.serviceUtils.createError})})}else C=p.getPredefinedAppConfig("true"===a.is3D?"default3DApp":"default2DApp"),h=u.isWebTierPortal(e),
b=[b,C,d,h],r(b).then(function(b){var d=b[1];x(a,d,e,b[2],b[0],b[3]);w(a,d).then(function(a){a.success?(c.resolve({success:!0,newAppId:a.id}),setTimeout(t.hitch(this,function(){a.user.updateItem(a.id,{url:n.getDeployContextFromLocation()+"apps/webappviewer/index.html?id\x3d"+a.id}).then(function(a){a.success||console.error(builderNls.serviceUtils.createUrlError)},function(a){console.error(builderNls.serviceUtils.createUrlError,a.message||"")})}),2E3)):(c.reject({success:!1,message:builderNls.serviceUtils.createError}),
console.error(builderNls.serviceUtils.createError,builderNls.serviceUtils.addItemUnsuccess))},function(a){c.reject({success:!1,message:builderNls.serviceUtils.createError});console.error(builderNls.serviceUtils.createError,a.message||"")})},function(a){console.error(a);c.reject({success:!1,message:builderNls.serviceUtils.createError})});return c},duplicateApp:function(a,c){var b=new k,e=n.getStandardPortalUrl(window.portalUrl);if(isXT)f.getPortal(e).getUser().then(function(c){g("/builder/rest/apps/duplicateapp",
{handleAs:"json",method:"POST",data:{name:a.name,description:a.description,id:a.createFromId,is3D:a.is3D,creator:c.username||"",modified:c.username||"",portalUrl:e}}).then(function(a){b.resolve(a)},function(a){b.reject(a)})},function(a){console.error(builderNls.serviceUtils.createError,a);b.reject({message:builderNls.serviceUtils.createError})});else{var d=t.clone(c).getCleanConfig();delete d.agolTemplateInfo;w(a,d).then(function(a){a.success?(b.resolve({success:!0,newAppId:a.id}),a.user.updateItem(a.id,
{url:n.getDeployContextFromLocation()+"apps/webappviewer/index.html?id\x3d"+a.id}).then(function(a){},function(a){console.error(builderNls.serviceUtils.duplicateUrlError,a.message||"")})):(b.reject({success:!1,message:builderNls.serviceUtils.duplicateError}),console.error(builderNls.serviceUtils.duplicateError,builderNls.serviceUtils.addItemUnsuccess))},function(a){b.reject({success:!1,message:builderNls.serviceUtils.duplicateError});console.error(builderNls.serviceUtils.duplicateError,a.message||
"")})}return b},saveApp:function(a,c){var b=new k,e=n.getStandardPortalUrl(window.portalUrl),d=f.getPortal(e),p=d.getUser(),l;isXT?(l=s(e),r({user:p,signininfo:l}).then(function(e){c.portalUrl=n.getStandardPortalUrl(e.signininfo.info.portalUrl);g("/builder/rest/apps/"+a+"/saveconfig",{data:{appConfig:h.stringify(c),modified:e.user.username},method:"POST",handleAs:"json"}).then(function(a){b.resolve(a)},function(a){b.reject(a)})},function(a){b.reject(a)})):p.then(function(p){d.getItemData(a).then(function(d){c.agolTemplateInfo=
d.agolTemplateInfo;c.portalUrl=e;p.updateItem(a,{text:h.stringify(c)}).then(function(a){b.resolve({success:!0,newAppId:a.id})},function(a){b.reject({success:!1,message:a.message})})},function(a){console.error(a.message||a);b.reject({success:!1,message:a.message})})},function(a){b.reject({success:!1,message:a.message})});return b},getPredefinedAppConfig:function(a){return g("builder/predefined-apps/"+a+"/config.json",{handleAs:"json"})},copyThemeToApp:function(a,c,b){if(isXT)return g("/builder/rest/apps/"+
a+"/copytheme",{handleAs:"json",method:"POST",data:{themeName:c,layoutConfig:JSON.stringify(b)}});a=new k;a.resolve({success:!0});return a},copyWidgetToApp:function(a,c,b){if(isXT)return g.post("/builder/rest/apps/"+a+"/copywidget",{data:{widgetName:c,widgetLabel:b},handleAs:"json"});a=new k;a.resolve({success:!0});return a},getAllThemes:function(){if(isXT)return g("/builder/rest/themes/getall",{handleAs:"json"});var a=new k;v("themes").then(function(c){a.resolve({success:!0,themes:c.manifests})},
function(c){a.reject(c)});return a},searchWidgets:function(a){if(isXT)return g("/builder/rest/widgets/search?q\x3d"+JSON.stringify(a),{handleAs:"json"});var c=new k;v("widgets").then(function(b){var e=[];q.forEach(b.manifests,function(c){a["properties.inPanel"]===c.properties.inPanel&&(a.support2D===c.support2D||a.support3D===c.support3D)&&e.push(c)});c.resolve({success:!0,widgets:e})},function(a){c.reject(a)});return c},saveAgolTemplate:function(a,c){var b=new k,e=n.getStandardPortalUrl(window.portalUrl);
if(isXT)g("/builder/rest/apps/updateagoltemplateinapp",{handleAs:"json",method:"POST",data:{id:a.id,agolTemplateInfo:h.stringify(c)}}).then(t.hitch(this,function(a){!0===a.success?b.resolve():(console.error("The response of save agol template is 'unsuccess'!"),b.reject("The response of save agol template is 'unsuccess'!"))}),function(a){console.error(a.message||a);b.reject("Save AGOLTemplate failed!")});else{var d=f.getPortal(e);d.getUser().then(function(e){d.getItemData(a.id).then(function(d){delete d.agolTemplateJson;
d.agolTemplateInfo=c;e.updateItem(a.id,{text:h.stringify(d)}).then(function(){b.resolve()},function(a){console.error(a.message||a);b.reject("Save AGOLTemplate failed when updateItem!")})},function(a){console.error(a.message||a);b.reject("Save AGOLTemplate failed when get app's itemData!")})},function(a){console.error(a.message||a);b.reject("Save AGOLTemplate failed when get current user!")})}return b}};return p})},"builder/config/WidgetConfig":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/WidgetConfig.html ./AppWidgetsPage".split(" "),
function(t,d,b,g,k,h){return t([b,g],{templateString:k,postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.nls=d.mixin(this.nls,builderNls.widgets)},postCreate:function(){this.inherited(arguments);this.appWidgetsPage=new h({},this.appWidgetsPageNode)},startup:function(){this.inherited(arguments);this.appWidgetsPage.startup()},destroy:function(){this.appWidgetsPage.destroy();this.appWidgetsPage=null;this.inherited(arguments)},setAppConfig:function(b){this.appConfig=b;this.appWidgetsPage&&
this.appWidgetsPage.setAppConfig(b)}})})},"builder/config/AppWidgetsPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/on dojo/mouse dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/AppWidgetsPage.html ./WidgetsList ./MoveableNode ./WidgetSettingPage ./GroupSettingPage ./WidgetChoosePage ../utils jimu/utils jimu/PoolControllerMixin jimu/WidgetManager jimu/dijit/ViewStack jimu/dijit/Popup".split(" "),function(t,d,b,g,k,h,q,l,m,
n,f,r,u,s,x,w,v,e,a,c,p){return t([l,m],{templateString:n,postCreate:function(){this.inherited(arguments);this.widgetOnScreen=new f({name:"widgetOnScreen"},this.noncontrollerPreloadWidgetsNode);this.poolWidgets=new f({name:"poolWidgets"},this.poolWidgetsListNode);this.viewStack=new c({viewType:"dom",views:[this.preloadWidgetsNode,this.poolWidgetsNode]});this.viewStack.placeAt(this.domNode);this.poolControllerClass=t([l,e]);this.own(k.subscribe("editWidget",d.hitch(this,this._onEditWidget)));this.own(k.subscribe("chooseWidget",
d.hitch(this,this._onChooseWidget)));this.own(k.subscribe("editGroup",d.hitch(this,this._onEditGroup)))},postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.nls=d.mixin(this.nls,builderNls.widgets);this.nls.widgets||(this.nls.widgets="Widgets")},startup:function(){this.inherited(arguments);this.viewStack.startup();this.widgetOnScreen.startup();this.poolWidgets.opened=!1;this.widgetOnScreen.opened=!0},destroy:function(){this.widgetOnScreen.destroy();this.poolWidgets.destroy();
this.poolWidgets=this.widgetOnScreen=null;g.forEach(this.controllers,function(a){a.destroy()});this.controllers=[];this.inherited(arguments)},setAppConfig:function(a){this.appConfig&&v.isEqual(this.appConfig.widgetOnScreen,a.widgetOnScreen)&&v.isEqual(this.appConfig.widgetPool,a.widgetPool)?this.appConfig=a:(this.appConfig=a,this._createControllerWidgetNodes(),b.setStyle(this.noncontrollerPreloadWidgetsNode,{top:this.controllerWidgetsHeight+20+"px"}),this.widgetOnScreen.setSettings(this._getNonControllerPreloadWidgets()),
this.widgetOnScreen.setAppConfig(this.appConfig),this.poolWidgets._started&&(0<this.controllers.length?this._initWidgetPool(this.controllers[0]):(this._initWidgetPool(null),this.viewStack.switchView(this.preloadWidgetsNode))),this.widgetChoosePage&&this.widgetChoosePage.setAppConfig(a),this.widgetSettingPage&&this.widgetSettingPage.setAppConfig(a))},_getNonControllerPreloadWidgets:function(){var a=[];this.appConfig.visitElement(function(c,b,e,d){!c.isController&&d&&a.push(c)});return a},_createControllerWidgetNodes:function(){g.forEach(this.controllers,
function(a){b.destroy(a.node);a.destroy()},this);this.controllers=[];g.forEach(this.appConfig.widgetOnScreen.widgets,function(a){a.isController&&this._createControllerWidgetNode(a)},this);this.controllerWidgetsHeight=118*this.controllers.length;b.setStyle(this.controllerWidgetsNode,{height:this.controllerWidgetsHeight+"px"})},_createControllerWidgetNode:function(a){var c=b.create("div",{"class":"controller-widget"},this.controllerWidgetsNode),e={};window.isRTL?e.right="30px":e.left="30px";e=new r({type:"widget",
w:74,h:118,setting:a,listName:"controllerWidgets",style:e});b.place(e.domNode,c);e.startup();e=b.create("div",{"class":"action-node"},c);b.create("div",{"class":"action-text jimu-float-leading jimu-leading-margin1",title:this.nls.setControlledWidgets,innerHTML:this.nls.setControlledWidgets},e);b.create("div",{"class":"action-arrow jimu-float-trailing jimu-trailing-margin2"},e);a=new this.poolControllerClass(a);a.appConfig=this.appConfig;a.node=c;this.controllers.push(a);this.own(h(e,"click",d.hitch(this,
this._openWidgetPool,a)))},_openWidgetPool:function(a){!1!==a.visible&&(this.currentController=a,this.viewStack.switchView(this.poolWidgetsNode),this.poolWidgets.controller=a,this.poolWidgets.opened=!0,this.widgetOnScreen.opened=!1,this.controllerLabelNode.innerHTML=a.label,this._initWidgetPool(a),this.poolWidgets._started||this.poolWidgets.startup())},_initWidgetPool:function(a){this.poolWidgets.setSettings(a?a.getAllConfigs():[]);this.poolWidgets.setAppConfig(this.appConfig)},_onBackWidgetsClick:function(){this._createControllerWidgetNodes();
this.viewStack.switchView(this.preloadWidgetsNode);this.poolWidgets.opened=!1;this.widgetOnScreen.opened=!0},_onEditWidget:function(a){this.widgetSettingPage=new u({appConfig:this.appConfig},this.widgetSettingPageNode);this.widgetSettingPage.setting=d.clone(a);a=new p({titleLabel:this.nls.configLabel+" "+a.label,content:this.widgetSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:d.hitch(this.widgetSettingPage,this.widgetSettingPage.onOk)},{label:this.nls.cancel,onClick:d.hitch(this.widgetSettingPage,
this.widgetSettingPage.onCancel)}],onClose:d.hitch(this.widgetSettingPage,this.widgetSettingPage.onClose)});b.addClass(a.domNode,"widget-setting-popup");this.widgetSettingPage.startup()},_onChooseWidget:function(a,c){this.widgetChoosePage=new x({appConfig:this.appConfig},this.widgetChoosePageNode);this.widgetChoosePage.fromNode=a;this.widgetChoosePage.fromList=c;new p({titleLabel:this.nls.chooseWidget,content:this.widgetChoosePage,container:"main-page",buttons:[{label:this.nls.ok,onClick:d.hitch(this.widgetChoosePage,
this.widgetChoosePage.onOk)},{label:this.nls.cancel}]});this.widgetChoosePage.startup()},_onEditGroup:function(a,c){this.groupSettingPage=new s({setting:d.clone(c)});new p({titleLabel:c.label,content:this.groupSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:d.hitch(this.groupSettingPage,this.groupSettingPage.onOk)},{label:this.nls.cancel}]});this.groupSettingPage.startup()},_getPopupSize:function(){var a=b.getContentBox("main-page"),c={};1024>=a.w?(c.width=a.w-20,c.height=a.h-
20):(c.width=1024,c.height=768);return c}})})},"builder/config/WidgetsList":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/aspect dojo/request/xhr dojo/on dojo/Deferred dojo/mouse dojo/query dojo/NodeList-dom dijit/_WidgetBase ./MoveableNode ./LinkList".split(" "),function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x){function w(a){var c={};isFinite(a.l)&&(c.left=a.l+"px");isFinite(a.t)&&(c.top=a.t+"px");isFinite(a.w)&&(c.width=a.w+"px");isFinite(a.h)&&(c.height=
a.h+"px");return c}var v,e=t([u],{postCreate:function(){this.inherited(arguments);this.domNode=b.create("div",{"class":"node-margin"});this.type="addBtn"===this.node.type?"addMargin":"margin"}});return t([u],{postMixInProperties:function(){this.nls={groups:builderNls.groups};this.nls.groups.newGroup=this.nls.groups.newGroup||"New Group"},postCreate:function(){this.nodeList=new x({name:this.name});this.own(k.subscribe("widgetChoosePageOk",d.hitch(this,this._onWidgetChoosePageOk)));this.own(k.subscribe("widgetSettingPageOk",
d.hitch(this,this._onWidgetSettingPageOk)))},startup:function(){this.inherited(arguments);var a=b.getContentBox(this.domNode);this.position=b.position(this.domNode);v=Math.floor(a.w/89);this.settings&&this.initNodes()},setSettings:function(a){this.settings=a;this.initNodes()},setAppConfig:function(a){this.appConfig=a},addWidget:function(a){a=this.createMoveableNode("widget",a);this.nodeList.insertNode(a);this.placeNodes()},createMoveableNode:function(a,c){var e=b.getContentBox(this.domNode);e.h=Infinity;
var f=new s({type:a,w:74,h:118,setting:c,listName:this.name,parentBox:e});b.place(f.domNode,this.domNode);f.startup();this.bindMoveEvent(f);"group"===a&&(h.after(f,"openGroup",d.hitch(this,this.openGroup,f)),h.after(f,"closeGroup",d.hitch(this,this.closeGroup,f)));f.on("removeNode",d.hitch(this,function(){"poolWidgets"===this.name?(f.gnode?(this.nodeList.removeNode(f),this._reopenGroup()):this.nodeList.removeNode(f),this.placeNodes(),this.publishPoolChangeEvent()):k.publish("configChanged",f.setting.id,
f.setting)}));this.createMarginNode(f);this.own(l(f.domNode,"click",d.hitch(this,function(){("addBtn"===a||"widget"===a&&!c.uri)&&k.publish("chooseWidget",f,this.name)})));return f},openGroup:function(a){var c,b,e,f,h,z,g;this.openedGNode&&this.openedGNode!==a&&this.openedGNode.closeGroup(this.openedGNode);c=a.setting.widgets;h=this.getNodePosition(this.nodeList.getNodeIndex(a)).r;z=Math.ceil(c.length/v);b=h*v+1;e=this.nodeList.getNodeByIndex(b);for(f=this.nodeList.getCount()+1;f<b;f++)g=this.createMoveableNode("empty"),
g.gnode=a,this.nodeList.insertNode(g,e);this.openedGNode=a;this.openedGNode.panelRow=h+1;this.createGroupPanel(h+1,z);c.forEach(d.hitch(this,function(c){c=this.createMoveableNode("widget",c);c.gnode=a;this.nodeList.insertNode(c,e)}));c=v*z-c.length;for(f=0;f<c;f++)g=this.createMoveableNode("empty"),g.gnode=a,this.nodeList.insertNode(g,e);this.placeNodes()},createGroupPanel:function(a,c){this.groupPanel=b.create("div",{"class":"widget-group-panel",style:w({l:5,t:118*(a-1)-10,h:118*c+0*(c-1),w:89*v-
15+20})},this.domNode);b.create("div",{"class":"group-triangle",style:{left:89*((this.openedGNode.pos.c-1)%v)+37+"px"}},this.groupPanel);this.groupPanel.type="panel"},closeGroup:function(a){var c=[];a.setting.widgets=[];this.nodeList.visitNodes(d.hitch(this,function(b){b.gnode===a&&("empty"!==b.type&&a.setting.widgets.push(b.setting),c.push(b))}));c.forEach(d.hitch(this,function(a){this.nodeList.removeNode(a)}));0===a.setting.widgets.length?this.nodeList.removeNode(a):a.updateSmallWidgets();this.placeNodes();
b.destroy(this.groupPanel);this.openedGNode=null},initNodes:function(){this.destroyShadowNode();var a=this.settings,a="widgetOnScreen"===this.name?a.sort(firstBy(function(a,c){return a.inPanel!==c.inPanel?a.inPanel-c.inPanel:0}).thenBy(function(a,c){return a.uri&&!c.uri?-1:!a.uri&&c.uri?1:0}).thenBy(function(a,c){return a.uri&&c.uri?a.label.localeCompare(c.label):!a.uri&&!c.uri?a.placeholderIndex-c.placeholderIndex:0})):a.sort(function(a,c){return a.index-c.index}),c;this.openedGNode&&(c=this.openedGNode.label,
this.closeGroup(this.openedGNode));this.nodeList.destroyAllNodes();"poolWidgets"===this.name&&(this.addBtn=this.createMoveableNode("addBtn"),this.nodeList.insertNode(this.addBtn));a.forEach(d.hitch(this,function(a){var c;a.widgets?0<a.widgets.length?c=this.createMoveableNode("group",a):console.log("empty group"):c=this.createMoveableNode("widget",a);c&&this.nodeList.insertNode(c)}));this.nodeList.insertNode(this.createMoveableNode("empty"));this.placeNodes();if(c&&(a=this.nodeList.getNodeByLabel(c)))this.openGroup(a),
a.status="open"},_removeActive:function(){f(".node-margin-active",this.domNode).removeClass("node-margin-active");f(".empty-node-active",this.domNode).removeClass("empty-node-active");f(".node-active",this.domNode).removeClass("node-active")},bindMoveEvent:function(a){"addBtn"!==a.type&&a.dnd&&(h.after(a.dnd,"onMove",d.hitch(this,function(c,e,d){c=this.getMousePosition(d);this.mouseNode=this.getNodeByMousePosition(a,c);this._removeActive();this.mouseNode&&"margin"===this.mouseNode.type?b.addClass(this.mouseNode.domNode,
"node-margin-active"):this.mouseNode&&"empty"===this.mouseNode.type?b.addClass(this.mouseNode.domNode,"empty-node-active"):this.mouseNode&&("group"===this.mouseNode.type||"widget"===this.mouseNode.type)&&b.addClass(this.mouseNode.domNode,"node-active")}),!0),h.after(a.dnd,"onMoveStart",d.hitch(this,function(){this.destroyShadowNode();this.createShadowNode(a);b.setStyle(a.boxNode,"cursor","move")}),!0),h.after(a.dnd,"onMoveStop",d.hitch(this,this._onMoveStop,a),!0))},_onMoveStop:function(a){var c=
!1;b.setStyle(a.boxNode,"cursor","pointer");this.mouseNode&&(a===this.mouseNode?console.log("move to the same node"):"margin"===this.mouseNode.type?(this.moveNodeToMargin(a,this.mouseNode),c=!0):"empty"===this.mouseNode.type?this.mouseNode.gnode&&"group"===a.type?console.log("not allow move group to opened group, revert"):(this.moveNodeToEmpty(a,this.mouseNode),c=!0):"group"===this.mouseNode.type?"group"===a.type?console.log("not allow move group to closed group, revert"):"open"===this.mouseNode.status?
console.log("please put widget into the opened group panel"):a.gnode&&a.gnode===this.mouseNode?console.log("the moving widget is already in the group"):(this.moveWidgetToGroup(a,this.mouseNode),c=!0):"widget"===this.mouseNode.type&&("group"===a.type?console.log("not allow move group to widget, revert"):a.gnode||this.mouseNode.gnode?console.log("can not nest group"):(this.moveWidgetToWidget(a,this.mouseNode),c=!0)),this._reopenGroup());this.destroyShadowNode();c&&this.publishPoolChangeEvent();this.placeNodes()},
_reopenGroup:function(){if(this.openedGNode){var a=this.openedGNode;this.closeGroup(a);this.nodeList.isExist(a)&&this.openGroup(a)}},getNodePosition:function(a){var c={},b;b=Math.ceil(a/v);a%=v;0===a&&(a=v);c.t=118*(b-1);c.l=89*(a-1)+15;c.w=74;c.h=118;c.r=b;c.c=a;return c},getMarginNodePosition:function(a){var c={};a=a.pos;c.l=a.l-7.5-2.5;c.t=a.t;c.w=5;c.h=118;return c},createMarginNode:function(a){var c=new e({label:a.label,node:a});b.place(c.domNode,this.domNode);return a.margin=c},getMousePosition:function(a){return{x:a.pageX-
this.position.x,y:a.pageY-this.position.y+this.domNode.scrollTop}},moveNodeToMargin:function(a,c){var b=this.getNodeByMarginNode(c);console.log("moveNodeToMargin");f(".node-margin-active",this.domNode).removeClass("node-margin-active");b.gnode&&!a.gnode?a.gnode=b.gnode:!b.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,b)},moveNodeToEmpty:function(a,c){f(".empty-node-active",this.domNode).removeClass("empty-node-active");c.gnode&&!a.gnode?a.gnode=c.gnode:!c.gnode&&a.gnode&&(a.gnode=null);
this.nodeList.moveNode(a,c)},getNodeByMarginNode:function(a){var c;this.nodeList.visitNodes(function(b){b.margin===a&&(c=b)});return c},placeNodes:function(){var a,c;this.nodeList.visitNodes(d.hitch(this,function(e,d){a=this.getNodePosition(d);e.pos=a;b.setStyle(e.domNode,w(a));c=this.getMarginNodePosition(e);e.margin.pos=c;b.setStyle(e.margin.domNode,w(c))}));this.nodeList.printNodeList()},moveWidgetToGroup:function(a,c){c.addWidget(a);this.nodeList.removeNode(a)},moveWidgetToWidget:function(a,c){var b;
b=this.createMoveableNode("group",{label:this._getGroupLabel(),widgets:[a.setting,c.setting]});this.nodeList.insertNode(b,c);this.nodeList.removeNode(a);this.nodeList.removeNode(c)},createShadowNode:function(a){this.shadowNode=b.create("div",{"class":"node-shadow",style:w(b.getMarginBox(a.domNode))},this.domNode)},destroyShadowNode:function(){this.shadowNode&&b.destroy(this.shadowNode)},getNodeByMousePosition:function(a,c){var b;this.nodeList.visitNodes(function(e){if("addBtn"!==e.type){if(c.x>e.pos.l+
10&&(c.x<e.pos.l+e.pos.w-10&&c.y>e.pos.t+10&&c.y<e.pos.t+e.pos.h-10)&&e!==a)return b=e,!0;if(c.x>e.margin.pos.l&&(c.x<e.margin.pos.l+e.margin.pos.w&&c.y>e.margin.pos.t&&c.y<e.margin.pos.t+e.margin.pos.h)&&e.margin!==a)return b=e.margin,!0}});return b},_getGroupLabel:function(){var a=-1;this.appConfig.visitElement(d.hitch(this,function(c){if(c.widgets)if(c.label===this.nls.groups.newGroup)a=0;else if(c.label.startWith(this.nls.groups.newGroup)){var b=c.label.lastIndexOf("_");-1<b&&(c=parseInt(c.label.substr(b+
1,c.label.length),10),a=Math.max(a,c))}}));return-1===a?this.nls.groups.newGroup:this.nls.groups.newGroup+"_"+(a+1)},_onWidgetChoosePageOk:function(a,c){if(c.listName===this.name)if(1===a.length){var b;"addBtn"===c.type?b=a[0]:(b=d.clone(c.setting),d.mixin(b,a[0]));k.publish("editWidget",b)}else"addBtn"===c.type&&(g.forEach(a,function(a){this.addWidget(a)},this),this.publishPoolChangeEvent())},_onWidgetSettingPageOk:function(a){this.opened&&(a.id?k.publish("configChanged",a.id,a):"poolWidgets"===
this.name&&(this.addWidget(a),this.publishPoolChangeEvent()))},publishPoolChangeEvent:function(){var a=[],c=[];this.nodeList.visitNodes(function(b,e){"widget"===b.type&&!b.gnode?(b.setting.index=e,c.push(b.setting)):"group"===b.type&&(b.setting.index=e,a.push(b.setting))});k.publish("configChanged","widgetPool",{widgets:c,groups:a},{controllerId:this.controller.id})}})})},"builder/config/MoveableNode":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Evented dojo/aspect dojo/mouse dojo/topic dojo/query ./Mover dojo/dnd/move dojo/mouse dojo/NodeList-dom dojo/NodeList-manipulate dijit/_WidgetBase jimu/dijit/Message jimu/utils".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v){return t([x,k],{type:"",label:"",isMoving:!1,isMouseDown:!1,postMixInProperties:function(){this.nls=b.mixin({},builderNls.common);this.nls=b.mixin(this.nls,builderNls.widgets);this.nls.addWidget=this.nls.addWidget||"Click here to add widget";this.nls.hideWidget=this.nls.hideWidget||"Hide this widget";this.nls.showWidget=this.nls.showWidget||"Show this widget";this.nls.removeWidget=this.nls.removeWidget||"Remove this widget";this.nls.configureWidget=this.nls.configureWidget||
"Configure this widget"},postCreate:function(){this.inherited(arguments);"addBtn"===this.type?(this.label="addBtn",this.createAddBtn()):"empty"===this.type?(this.label="empty",this.createEmptyNode()):("widget"===this.type?this.createWidgetNode():this.createGroupNode(),"poolWidgets"===this.listName&&(this.dnd=new f.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:n}),this.bindMoveEvent()));d.addClass(this.domNode,"moveable");d.setStyle(this.domNode,
{width:this.w+"px",height:this.h+"px"})},bindMoveEvent:function(){h.after(this.dnd,"onMoveStart",b.hitch(this,function(){this.isMoving=!0}),!0);h.after(this.dnd,"onMoveStop",b.hitch(this,function(){this.isMoving=!1}),!0)},_createWidgetIconNode:function(){var b=v.processUrlInAppConfig(this.setting.icon);this.iconNode=d.create("img",{"class":"icon",src:b,style:{width:"40px",height:"40px",margin:(this.w-40)/2+"px"}},this.boxNode)},_createPlaceholderNode:function(){this.placeholderNode=d.create("div",
{"class":"placehoder",style:{width:"40px",height:"40px",margin:(this.w-40)/2+"px"}},this.boxNode);d.create("div",{"class":"placehoder-inner",innerHTML:this.setting.placeholderIndex,style:{width:"24px",height:"24px",lineHeight:"24px",borderRadius:"12px",margin:"7px"}},this.placeholderNode)},createWidgetNode:function(){d.addClass(this.domNode,"widget-node");this.boxNode=d.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.setting.uri?this._createWidgetIconNode():
this._createPlaceholderNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=d.create("div",{"class":"label",innerHTML:this.label,title:this.label},this.domNode);!1===this.setting.visible&&d.addClass(this.domNode,"hide");this.own(g(this.boxNode,q.enter,b.hitch(this,function(){l.publish("actionTriggered",this.setting.id,"highLight");this.setting.uri&&(this.editNode&&(d.destroy(this.editNode),
this.editNode=null),this.dropNode&&(d.destroy(this.dropNode),this.dropNode=null),this.switchNode&&(d.destroy(this.switchNode),this.switchNode=null),this.editNode=this._createEditNode(),this.own(g(this.editNode,"click",b.hitch(this,function(b){b.stopPropagation();l.publish("editWidget",this.setting)}))),!1===this.setting.inPanel?(this.switchNode=this._createSwitchNode(),this.own(g(this.switchNode,"click",b.hitch(this,function(e){e.stopPropagation();e=b.clone(this.setting);!1===e.visible?(e.visible=
!0,d.removeClass(this.domNode,"hide")):(e.visible=!1,d.addClass(this.domNode,"hide"));l.publish("configChanged",e.id,e)})))):(this.dropNode=this._createDropNode(),this.own(g(this.dropNode,"click",b.hitch(this,function(e){e.stopPropagation();var a=new w({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:b.hitch(this,function(){"poolWidgets"===this.listName?console.log("list name poolWidgets"):(this.setting.uri="",this.setting.label=this.nls.defaultWidgetLabel,this.setting.name=
void 0,this.setting.placeholderIndex="?",this.setting.config=void 0,this.label=this.nls.defaultWidgetLabel,this.labelNode.innerHTML=this.label,d.destroy(this.iconNode),this._createPlaceholderNode());this.emit("removeNode");a.close()})},{label:this.nls.cancel}]})})))))})));this.own(g(this.boxNode,q.leave,b.hitch(this,function(){l.publish("actionTriggered",this.setting.id,"removeHighLight");this.editNode&&d.destroy(this.editNode);this.dropNode&&d.destroy(this.dropNode);this.switchNode&&d.destroy(this.switchNode)})))},
createGroupNode:function(){d.addClass(this.domNode,"group-node");this.boxNode=d.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.label=this.setting.label?this.setting.label:"Group";this.name=this.setting.name?this.setting.name:"Group";this.labelNode=d.create("div",{"class":"label",innerHTML:this.setting.label,title:this.setting.label},this.domNode);this._createSmallWidgets();this.own(g(this.boxNode,q.enter,b.hitch(this,function(){l.publish("actionTriggered",
this.setting.id,"highLight");this.editNode=this._createEditNode();this.own(g(this.editNode,"click",b.hitch(this,function(b){b.stopPropagation();l.publish("editGroup",this,this.setting)})));this.own(g(this.editNode,"mousedown",function(b){b.stopPropagation()}));this.own(g(this.editNode,"mouseup",function(b){b.stopPropagation()}));"poolWidgets"===this.listName&&(this.dropNode=this._createDropNode(),this.own(g(this.dropNode,"click",b.hitch(this,function(e){var a=new w({message:this.nls.dropGroupMessage,
buttons:[{label:this.nls.ok,onClick:b.hitch(this,function(){this.emit("removeNode");a.close()})},{label:this.nls.cancel}]});e.stopPropagation()}))),this.own(g(this.dropNode,"mousedown",function(b){b.stopPropagation()})),this.own(g(this.dropNode,"mouseup",function(b){b.stopPropagation()})))})));this.own(g(this.boxNode,q.leave,b.hitch(this,function(){l.publish("actionTriggered",this.setting.id,"removeHighLight");this.editNode&&d.destroy(this.editNode);this.dropNode&&d.destroy(this.dropNode)})));this.own(g(this.boxNode,
"click",b.hitch(this,function(b){b.preventDefault();b.stopPropagation();"open"===this.status?this.closeGroup():this.openGroup()})))},closeGroup:function(){this.status="close"},openGroup:function(){this.status="open"},createAddBtn:function(){d.addClass(this.domNode,"add-widget-node");var b=d.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);d.create("img",{src:"builder/css/images/add_widget.png"},b);d.create("div",{"class":"label",title:this.nls.addWidget,innerHTML:this.nls.addWidget},
b)},createEmptyNode:function(){d.addClass(this.domNode,"empty-node");d.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode)},_createEditNode:function(){var b={bottom:"4px",width:"25px",height:"25px"};b[window.isRTL?"left":"right"]="4px";return d.create("div",{"class":"edit-btn",style:b,title:this.nls.configureWidget},this.boxNode)},_createDropNode:function(){var b={top:"3px",width:"10px",height:"10px"};b[window.isRTL?"left":"right"]="3px";return d.create("div",{"class":"drop-btn",
style:b,title:this.nls.removeWidget},this.boxNode)},_createSwitchNode:function(){var b=d.hasClass(this.domNode,"hide")?this.nls.showWidget:this.nls.hideWidget,a={top:"3px",width:"15px",height:"10px"};a[window.isRTL?"left":"right"]="3px";return d.create("div",{"class":"switch-btn",style:a,title:b},this.boxNode)},_createSmallWidgets:function(){m(".small",this.boxNode).remove();var e=[],a=!1;4<this.setting.widgets.length?(e=this.setting.widgets.slice(0,3),a=!0):(e=this.setting.widgets,a=!1);e.forEach(b.hitch(this,
function(a){this._createSmallWidget(a)}));a&&this._createSmallMore()},_createSmallWidget:function(b){var a;a=d.create("div",{"class":"small small-widget","data-wid":b.id,style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);var c=b.icon;if(b.icon.startWith("widgets")||b.icon.startWith("configs")||b.icon.startWith("themes"))c=require(v.getRequireConfig()).toUrl(b.icon);d.create("img",{src:c,style:{width:"20px",height:"20px"}},a);return a},_createSmallMore:function(){var b;
b=d.create("div",{"class":"small small-more",style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);d.create("img",{src:"builder/images/more_widget.png",style:{width:"20px"}},b);return b},addWidget:function(b){"group"!==this.type?console.log("can not add widget to widget"):(this.setting.widgets.push(b.setting),this._createSmallWidgets())},updateSmallWidgets:function(){this._createSmallWidgets()},destroy:function(){this.margin&&this.margin.destroy();
this.inherited(arguments)}})})},"builder/config/Mover":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/sniff dojo/_base/window dojo/dom dojo/dom-geometry dojo/dom-style dojo/Evented dojo/on dojo/touch dojo/dnd/common dojo/dnd/autoscroll".split(" "),function(t,d,b,g,k,h,q,l,m,n,f,r,u){g.add("ie11",function(){var b=-1,d="",f=null;"Microsoft Internet Explorer"===navigator.appName?(d=navigator.userAgent,f=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==f.exec(d)&&(b=parseFloat(RegExp.$1))):
"Netscape"===navigator.appName&&(d=navigator.userAgent,f=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,null!==f.exec(d)&&(b=parseFloat(RegExp.$1)));return b});return d("dojo.dnd.Mover",[m],{constructor:function(d,g,l){function k(b){b.preventDefault();b.stopPropagation()}this.node=h.byId(d);this.marginBox={l:g.pageX,t:g.pageY};this.mouseButton=g.button;g=this.host=l;d=d.ownerDocument;this.events=[n(d,f.move,b.hitch(this,"onFirstMove")),n(d,f.move,b.hitch(this,"onMouseMove")),n(d,f.release,b.hitch(this,"onMouseUp")),
n(d,"dragstart",k),n(d.body,"selectstart",k)];u.autoScrollStart(d);if(g&&g.onMoveStart)g.onMoveStart(this)},onMouseMove:function(b){u.autoScroll(b);var d=this.marginBox;this.host.onMove(this,{l:d.l+b.pageX,t:d.t+b.pageY},b);b.preventDefault();b.stopPropagation()},onMouseUp:function(b){var d=g("webkit")&&g("mac")&&2===this.mouseButton,f=(g("ie")||g("ie11"))&&-1===this.mouseButton;(d||f?0===b.button:this.mouseButton===b.button)&&this.destroy();b.preventDefault();b.stopPropagation()},onFirstMove:function(b){var d=
this.node.style,f,g=this.host;switch(d.position){case "relative":case "absolute":f=Math.round(parseFloat(d.left))||0;d=Math.round(parseFloat(d.top))||0;break;default:d.position="absolute";d=q.getMarginBox(this.node);f=k.doc.body;var e=l.getComputedStyle(f),a=q.getMarginBox(f,e),e=q.getContentBox(f,e);f=d.l-(e.l-a.l);d=d.t-(e.t-a.t)}this.marginBox.l=f-this.marginBox.l;this.marginBox.t=d-this.marginBox.t;if(g&&g.onFirstMove)g.onFirstMove(this,b);this.events.shift().remove()},destroy:function(){t.forEach(this.events,
function(b){b.remove()});var b=this.host;if(b&&b.onMoveStop)b.onMoveStop(this);this.events=this.node=this.host=null}})})},"builder/config/LinkList":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/_base/array"],function(t){return t(null,{headNode:null,currentNode:null,constructor:function(d){this.name=d.name},visitNodes:function(d){for(var b=this.headNode,g=1;b;)d(b,g),g++,b=b.next},destroyAllNodes:function(){for(var d=this.headNode,b;d;)b=d.next,d.destroy(),d=b;this.headNode=null},
getCount:function(){var d=0;this.visitNodes(function(b,g){d=g});return d},isExist:function(d){var b=!1;this.visitNodes(function(g){g===d&&(b=!0)});return b},printNodeList:function(){this.visitNodes(function(d){})},getPreNode:function(d){var b;this.visitNodes(function(g){g.next===d&&(b=g)});return b},getNodeByIndex:function(d){var b;this.visitNodes(function(g,k){k===d&&(b=g)});return b},getNodeByLabel:function(d){var b;this.visitNodes(function(g){g.label===d&&(b=g)});return b},getNodeIndex:function(d){var b;
this.visitNodes(function(g,k){g===d&&(b=k)});return b},removeNode:function(d){var b;(b=this.getPreNode(d))?b.next=d.next:this.headNode=d.next;d.destroy()},removeNodeByIndex:function(d){this.removeNode(this.getNodeByIndex(d))},insertNode:function(d,b){var g,k;g="number"===typeof b?this.getNodeByIndex(b):b;(k=this.getPreNode(g))?k.next=d:this.headNode=d;d.next=g},moveNode:function(d,b){var g=this.getPreNode(d),k=this.getPreNode(b);d!==b&&d!==k&&(g?g.next=d.next:this.headNode=d.next,d.next=b,k?k.next=
d:this.headNode=d)}})})},"builder/config/WidgetSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/config dojo/Deferred dojo/request dojo/topic dojo/aspect dojo/on dojo/mouse dojo/query dojo/string dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/WidgetSettingPage.html ./WidgetDefaultSettingPage jimu/utils jimu/WidgetManager jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/ImageChooser jimu/dijit/LoadingIndicator jimu/dijit/Message dijit/form/CheckBox".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A,z,D,C){var F={overview:"widget-overview.htm",attributetable:"widget-attribute-table.htm",basemapgallery:"widget-basemap.htm",bookmark:"widget-bookmark.htm",chart:"widget-chart.htm",headercontroller:"widget-header-controller-and-sidebar-controller.htm",sidebarcontroller:"widget-header-controller-and-sidebar-controller.htm",coordinate:"widget-coordinates.htm",directions:"widget-directions.htm",draw:"widget-draw.htm",edit:"widget-edit.htm",geocoder:"widget-geocoder.htm",
geoprocessing:"widget-geoprocessing.htm",homebutton:"widget-home-button.htm",layerlist:"widget-layer-list.htm",legend:"widget-legend.htm",measurement:"widget-measurement.htm",mylocation:"widget-my-location.htm",overviewmap:"widget-overview-map.htm",print:"widget-print.htm",query:"widget-query.htm",scalebar:"widget-scalebar.htm",splash:"widget-splash.htm",about:"widget-about.htm"},G={overview:"#",attributetable:"120000943",basemapgallery:"120000944",bookmark:"120000945",chart:"120000946",headercontroller:"120000963",
sidebarcontroller:"120000963",coordinate:"120000947",directions:"120000948",draw:"120000949",edit:"120000950",geocoder:"120000951",geoprocessing:"120000952",homebutton:"120000953",layerlist:"120000954",legend:"120000955",measurement:"120000956",mylocation:"120000957",overviewmap:"120000958",print:"120000959",query:"120000960",scalebar:"120000961",splash:"120000964",about:"120000999"},H={overview:"#",attributetable:"120000943",basemapgallery:"120000944",bookmark:"120000945",chart:"120000946",headercontroller:"120000963",
sidebarcontroller:"120000963",coordinate:"120000947",directions:"120000948",draw:"120000949",edit:"120000950",geocoder:"120000951",geoprocessing:"120000952",homebutton:"120000953",layerlist:"120000954",legend:"120000955",measurement:"120000956",mylocation:"120000957",overviewmap:"120000958",print:"120000959",query:"120000960",scalebar:"120000961",splash:"120000964",about:"120000999"};return t([x,w,v],{templateString:e,postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.nls=
d.mixin(this.nls,builderNls.widgets);this.nls.widgetLabel=this.nls.widgetLabel||"Widget Label"},startup:function(){this.inherited(arguments);this.own(n(window,"resize",d.hitch(this,this.resize)));this.init()},init:function(){this.loading=new z;this.loading.placeAt(this.widgetSettingNode);this.initCommonAttr();this.initWidgetAttr();this.resize()},resize:function(){var a=b.getContentBox(this.domNode);b.setStyle(this.widgetSettingNode,{height:a.h-90+"px"})},onCancel:function(){this.onClose();this.popup.close()},
onOk:function(){var a=this._checkLabelExist();if(a)return new D({message:a}),!1;this.imageChooser.imageData&&(this.setting.icon=this.imageChooser.imageData);this.setting.label=this.labelNode.get("value");if(this.settingDijit){a=this.settingDijit.getConfig(!0);if(!1===a)return!1;this.setting.config=a}l.publish("widgetSettingPageOk",this.setting);this.onClose();this.popup.close()},_checkLabelExist:function(){var a=0,c=this.labelNode.get("value");if(""===u.trim(c))return this.nls.labelRequired;this.appConfig.visitElement(d.hitch(this,
function(b){this.setting.id!==b.id&&b.label===c&&a++}));return 0<a?this.nls.labelExists:""},onClose:function(){this.settingViewStack?(this.settingDijitUI.destroy(),this.settingDijitJSON.destroy(),this.settingViewStack.destroy()):this.settingDijit&&this.settingDijit.destroy()},_getHelpLink:function(a){var c=new h;a=a.toLowerCase();if(window.isXT)q("/webappbuilder/help/cxhelp.js",{handleAs:"json"}).then(d.hitch(this,function(b){var e="#";b&&(b.m&&b.m[H[a]])&&(e="/webappbuilder/help/"+b.m[H[a]]);c.resolve(e)}),
d.hitch(this,function(a){console.warn(a);c.resolve("#")}));else{var b=y.getPortalUrlFromLocation();-1<b.indexOf("arcgis.com")?c.resolve("http://doc.arcgis.com/en/web-appbuilder/create-apps/"+(F[a]||"#")):q(b+"portalhelp/en/website/help/cxhelp.js",{handleAs:"json"}).then(d.hitch(this,function(e){var d="#";e&&(e.m&&e.m[G[a]])&&(d=b+"portalhelp/en/website/help/"+e.m[G[a]]);c.resolve(d)}),d.hitch(this,function(a){console.warn(a);c.resolve("#")}))}return c},initCommonAttr:function(){var a=c.processUrlInAppConfig(this.setting.icon);
b.setAttr(this.iconNode,"src",a);this.labelNode.set("value",this.setting.label);this._getHelpLink(this.setting.name).then(d.hitch(this,function(a){"#"!==a&&(b.setStyle(this.helpNode,"display","inline-block"),b.setAttr(this.helpNode,"href",a))}));this.setting.inPanel?(this.imageChooser=new A({goldenWidth:24,goldenHeight:24},this.imageChooser),(a=b.getMarginBox(this.changeNode))&&0<a.w&&b.setStyle(this.imageChooser.domNode,"width",a.w+"px"),this.own(n(this.imageChooser,"imageChange",d.hitch(this,function(a){this.iconNode.src=
a;this.setting.icon=a})))):b.addClass(this.changeNode,"disable-change-icon")},initWidgetAttr:function(){!1===this.setting.hasConfig?this.widgetSettingNode.innerHTML='\x3cdiv class\x3d"noconfig-info"\x3e'+this.nls.noConfig+"\x3c/div\x3e":p.getInstance().tryLoadWidgetConfig(this.setting).then(d.hitch(this,function(c){this.setting.config=c;this.setting.hasSettingPage?p.getInstance().loadWidgetSettingPage(this.setting).then(d.hitch(this,function(a){this.widgetSettingNode?(this.settingDijit=a,b.place(this.settingDijit.domNode,
this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy()):a.destroy()})):this.widgetSettingNode&&(this.settingDijit=new a({config:this.setting.config}),b.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy())}))},setAppConfig:function(a){this.appConfig=a}})})},"builder/config/WidgetDefaultSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dijit/_WidgetBase ./JSONEditor".split(" "),function(t,d,
b,g,k,h){return t([k],{baseClass:"widget-default-setting",postCreate:function(){this.inherited(arguments);this.jsonEditor=new h({json:this.config});this.jsonEditor.placeAt(this.domNode);this.own(b(this.domNode,"keydown",d.hitch(this,"_onEnterPress")))},_onEnterPress:function(b){(void 0!==b.keyCode?b.keyCode:b.which)===g.ENTER&&b.stopPropagation()},setConfig:function(b){return this.jsonEditor.setJSON(b)},getConfig:function(){return this.jsonEditor.getJSON()}})})},"builder/config/JSONEditor":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase"],function(t,d){return t([d],{baseClass:"json-editor",postCreate:function(){this.inherited(arguments);this.editor=ace.edit(this.domNode);this.editor.setTheme("ace/theme/textmate");this.editor.setHighlightActiveLine(!0);this.editor.setValue(JSON.stringify(this.json,null,2));this.editor.getSession().setMode("ace/mode/json")},setJSON:function(b){this.json=b;this.editor.setValue(JSON.stringify(this.json,null,2))},getJSON:function(){return JSON.parse(this.editor.getValue())}})})},"builder/config/GroupSettingPage":function(){define("dojo/_base/declare dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/GroupSettingPage.html".split(" "),
function(t,d,b,g,k,h){return t([g,k],{templateString:h,baseClass:"group-setting-page",postMixInProperties:function(){this.nls=builderNls.groups},startup:function(){this.labelNode.value=this.setting.label},onOk:function(){this.setting.label=d.get(this.labelNode,"value");b.publish("configChanged",this.setting.id,this.setting);this.popup.close()},onCancel:function(){}})})},"builder/config/WidgetChoosePage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/request/xhr dojo/topic dojo/aspect dojo/on dojo/Deferred dojo/promise/all dojo/mouse dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/WidgetChoosePage.html jimu/dijit/Search jimu/WidgetManager jimu/dijit/LoadingShelter jimu/dijit/Message jimu/utils ../serviceUtils".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y){return t([s,x],{templateString:w,postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.widgetManager=e.getInstance()},startup:function(){this.inherited(arguments);this.searchDijit=new v({placeholder:this.nls.widgetName,onSearch:d.hitch(this,this.searchWidget),searchWhenInput:!0},this.searchInputNode);this._getWidgets();this.own(l(window,"resize",d.hitch(this,this.resize)));setTimeout(d.hitch(this,function(){this.resize()}),
100);this.loading=new a({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()},searchWidget:function(a){var c;c=""===a?this.allWidgets:g.filter(this.allWidgets,function(c){if(-1<c.label.toUpperCase().indexOf(a.toUpperCase()))return!0});this._createWidgetNodes(c)},resize:function(){var a=b.getContentBox(this.domNode).h-50-10,c=a-60;b.setStyle(this.searchSectionNode,{height:a+"px"});b.setStyle(this.widgetListNode,{height:c+"px"})},setAppConfig:function(a){this.appConfig=a},_getWidgets:function(){var a=
{};this.appConfig.map["2D"]&&(a.support2D=!0);this.appConfig.map["3D"]&&(a.support3D=!0);this.appConfig.map["2D"]&&this.appConfig.map["3D"]&&(a.support2D=!0,a.support3D=!0);a["properties.inPanel"]=!0;y.searchWidgets(a).then(d.hitch(this,function(a){a.success?(this.allWidgets=a.widgets,this._createWidgetNodes(this.allWidgets)):console.log(a.message)}))},_createWidgetNodes:function(a){b.empty(this.widgetListNode);g.forEach(a,function(a){p.processManifestLabel(a,dojoConfig.locale);this._createWidgetNode(a)},
this)},_createWidgetNode:function(a){var c,e;c=b.create("div",{"class":"widget-node"},this.widgetListNode);e=b.create("div",{"class":"box"},c);b.create("div",{"class":"box-border"},c);b.create("img",{"class":"icon",src:a.icon},e);b.create("div",{"class":"label",innerHTML:a.label,title:a.label},c);c.setting={name:a.name,label:a.label,version:a.version};p.addManifestProperies(a);p.addManifest2WidgetJson(c.setting,a);c.setting.icon="widgets/"+a.name+"/images/icon.png";c.setting.uri="widgets/"+a.name+
"/Widget";p.processWidgetSetting(c.setting);c.box=e;this.own(l(c,"click",d.hitch(this,this._onWidgetClick,c)));return c},_onWidgetClick:function(a){"addBtn"===this.fromNode.type?b.hasClass(a,"jimu-state-selected")?b.removeClass(a,"jimu-state-selected"):b.addClass(a,"jimu-state-selected"):(r(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),b.addClass(a,"jimu-state-selected"))},onOk:function(){var a=r(".jimu-state-selected",this.domNode);if(0===a.length)new c({message:this.nls.emptyMessage});
else{this.loading.show();var b=g.map(a,function(a){return d.clone(a.setting)}),e=[];g.forEach(b,function(a){e.push(this._copyWidget(a))},this);n(e).then(d.hitch(this,function(a){var e;for(e=0;e<a.length;e++)if(!a[e].success){new c({message:a[e].message});this.loading.hide();return}this.loading.hide();h.publish("widgetChoosePageOk",b,this.fromNode);this.popup.close()}))}},_copyWidget:function(a){var c=0,b;this.appConfig.visitElement(d.hitch(this,function(b){b.name===a.name&&c++}));0===c?(a.label=a.label,
b=y.copyWidgetToApp(appId,a.name,a.label)):0<c&&(b=new m,a.label=a.label+"_"+(c+1),b.resolve({success:!0}));return b}})})},"builder/utils":function(){define(["dojo/request/xhr","dojo/cookie","jimu/portalUrlUtils","esri/urlUtils"],function(t,d,b,g){return{getAppPathById:function(b){return"stemapp"===b?path+"stemapp/":window.isXT?path+"apps/"+b+"/":path+"stemapp/"},appendParamsToAppPath:function(b,d){var g=b,l;for(l in d)d.hasOwnProperty(l)&&(g=0>g.indexOf("?")?g+"?"+l+"\x3d"+d[l]:g+"\x26"+l+"\x3d"+
d[l]);return g},removeActionFromUrl:function(b){b=g.urlToObject(b);b.query&&delete b.query.action;var d=b.path,q;for(q in b.query)d=d===b.path?d+"?"+q+"\x3d"+b.query[q]:d+"\x26"+q+"\x3d"+b.query[q];return d},checkProtocolAndUpdateSigninInfo:function(g,h){var q=h.portalUrl,l=q,m="https"===b.getProtocol(q),n=!!g.allSSL;m!==n&&n&&(l=b.setHttpsProtocol(q));h.portalUrl=l;return t("/builder/rest/signininfo/setsignininfo",{handleAs:"json",data:h,method:"POST"}).then(function(b){b.success&&(d("wab_portalurl",
l,{path:"/webappbuilder"}),d("wab_portalurl",l,{path:"/webapp"}),d("wab_portalurl_persistent",l,{path:"/",expires:365}));return b})}}})},"builder/config/AttributeConfig":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/on dojo/dom dojo/aspect dojo/mouse dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AttributeConfig.html dojo/dom-construct dojo/dom-class dojo/dom-style dojo/dom-attr dojo/_base/array builder/portalUtils ../utils jimu/dijit/CheckBox jimu/dijit/ImageChooser".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y){return t([f,r,u],{templateString:s,appConfig:null,selectLinkNode:null,selectProxyRuleNode:null,initedLinks:!1,initedProxy:!1,_currentPortalUrl:null,showProxySetting:!1,showAlwaysUseProxy:!1,postMixInProperties:function(){this.inherited(arguments);this.nls=d.mixin({},builderNls.settings);this.nls=d.mixin(this.nls,builderNls.attributes);this.nls=d.mixin(this.nls,builderNls.common)},postCreate:function(){this.inherited(arguments);this.useProxySetting=
new y({label:this.nls.useProxySetting,checked:!1},this.useProxySetting);this.alwaysUseProxy=new y({label:this.nls.alwaysUseProxyLabel,checked:!1},this.alwaysUseProxy);this._bindEvents()},startup:function(){this.inherited(arguments);this._keepOrder();b.addClass(this.imageChooser.domNode,"no-logo")},_bindEvents:function(){this.own(k(this.titleNode,"change",d.hitch(this,this.onTitleChange)));this.own(k(this.subtitleNode,"change",d.hitch(this,this.onSubtitleChange)));this.own(k(this.imageChooser,"imageChange",
d.hitch(this,"onLogoChange")));this.own(k(this.useProxySetting,"click",d.hitch(this,this._onUseProxySettingChange)));this.own(k(this.alwaysUseProxy,"click",d.hitch(this,this._onAlwaysUseProxyChange)));this.own(k(this.proxyUrlNode,"change",d.hitch(this,this._onProxyUrlChange)));this.own(k(this.proxyUrlNode,"blur",d.hitch(this,this._onProxyUrlBlur)));this.own(k(this.appIdNode,"change",d.hitch(this,this._onAppIdChange)));this.own(k(this.domNode,"click",d.hitch(this,function(){m(".header-button",this.domNode).removeClass("highlight-button");
this.selectLinkNode&&(b.removeClass(this.selectLinkNode,"selected-item"),this.selectLinkNode=null);this.selectProxyRuleNode&&(b.removeClass(this.selectProxyRuleNode,"selected-item"),this.selectProxyRuleNode=null)})))},init:function(a){this.appConfig=a||{};this.initHeader(a);this.initedLinks||(this.initLinks(a),this.initedLinks=!0);this.initedProxy||(this.initProxy(a),this.initedProxy=!0);this._currentPortalUrl!==a.portalUrl&&(this.initAppId(a),this._currentPortalUrl=a.portalUrl)},setAppConfig:function(a){this.init(a)},
initHeader:function(a){var c=a.logo;c&&(c&&(!c.startWith("/")&&!c.startWith("http")&&!c.startWith("data"))&&(c=window.isXT?p.getAppPathById(appId)+c:path+"stemapp/"+c),b.setAttr(this.logoNode,"src",c),v.set(this.noLogoNode,"display","none"),v.set(this.logoNode,"display","block"));a.title&&b.setAttr(this.titleNode,"value",a.title);a.subtitle&&b.setAttr(this.subtitleNode,"value",a.subtitle)},onLogoChange:function(a){b.setAttr(this.logoNode,"src",a);v.set(this.noLogoNode,"display","none");v.set(this.logoNode,
"display","block");g.publish("configChanged","app",{logo:a})},onTitleChange:function(a){g.publish("configChanged","app",{title:a.target.value})},onSubtitleChange:function(a){g.publish("configChanged","app",{subtitle:a.target.value})},initLinks:function(a){b.empty(this.linksListNode);a.links&&a.links.forEach(d.hitch(this,function(a){this.createLinkNode(a)}))},initProxy:function(c){if(c=c.httpProxy)this.useProxySetting.setValue(c.useProxy),this.showProxySetting=!!c.useProxy,this._onUseProxySettingChange(),
this.alwaysUseProxy.setValue(c.alwaysUseProxy),this.showAlwaysUseProxy=!!c.alwaysUseProxy,this._onAlwaysUseProxyChange(),c.url&&b.setAttr(this.proxyUrlNode,"value",c.url),c.rules&&(b.empty(this.proxyRulesListNode),a.forEach(c.rules,d.hitch(this,function(a){this.createProxyRuleNode(a)})))},initAppId:function(a){c.getPortal(a.portalUrl).loadSelfInfo().then(d.hitch(this,function(c){c.supportsOAuth?(b.setStyle(this.appIdSection,"display","none"),b.setAttr(this.appIdNode,"value",a.appId)):b.setStyle(this.appIdSection,
"display","none")}),d.hitch(this,function(a){this.shelter.hide();console.error(a)}))},getLinks:function(){var a=[];m(".links-list .list-item",this.domNode).forEach(d.hitch(this,function(c){var b=m(".first input",c).attr("value")[0];c=m(".second input",c).attr("value")[0];b&&a.push({label:b,url:c})}));return a},getProxy:function(){var a=[],c=b.getAttr(this.proxyUrlNode,"value");m(".proxy-rule-list .list-item",this.domNode).forEach(d.hitch(this,function(c){var b=m(".first input",c).attr("value")[0];
c=m(".second input",c).attr("value")[0];b&&a.push({urlPrefix:b,proxyUrl:c})}));return{useProxy:this.useProxySetting.getValue(),alwaysUseProxy:this.alwaysUseProxy.getValue(),url:c,rules:a}},_bindNodeEvents:function(a,c,e,f,p,h){this.own(k(a,"click",d.hitch(this,function(c){m(".header-button",this.domNode).addClass("highlight-button");"links"===h?(this.selectLinkNode&&b.removeClass(this.selectLinkNode,"selected-item"),b.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===h&&(this.selectProxyRuleNode&&
b.removeClass(this.selectProxyRuleNode,"selected-item"),b.addClass(a,"selected-item"),this.selectProxyRuleNode=a);c.stopPropagation()})));this.own(k(c,"dblclick",d.hitch(this,function(){b.setStyle(c,"display","none");b.setStyle(e,"display","block");e.focus();e.select()})));this.own(k(f,"dblclick",d.hitch(this,function(){b.setStyle(f,"display","none");b.setStyle(p,"display","block");p.focus();p.select()})));this.own(k(p,"focus",function(a){a.target.value||(a.target.value="http://")}));this.own(k(e,
"blur",d.hitch(this,function(a){b.setAttr(c,{innerHTML:a.target.value||c.innerHTML,style:{display:"block"}});b.setStyle(e,"display","none");"links"===h?g.publish("configChanged","app",{links:this.getLinks()}):"proxyRules"===h&&this._publishProxy()})));this.own(k(p,"blur",d.hitch(this,function(a){b.setAttr(f,{innerHTML:a.target.value||f.innerHTML,style:{display:"block"}});b.setStyle(p,"display","none");"links"===h?(a=this._formatLinkValue(a.target.value),b.setAttr(f,"innerHTML",a),b.setAttr(p,"value",
a),g.publish("configChanged","app",{links:this.getLinks()})):"proxyRules"===h&&this._publishProxy()})))},_formatLinkValue:function(a){var c="";return c=/^http(s?):\/\//.test(a)?a:/^\/\//.test(a)?"http:"+a:"http://"+a},_createListItem:function(a,c,e,d,f){var p=b.create("div",{"class":"list-item"}),g=b.create("div",{"class":"first jimu-float-leading"},p);e=b.create("div",{"class":"mask",innerHTML:c||e,title:e},g);var g=b.create("input",{style:{display:"none"}},g),h=b.create("div",{"class":"second jimu-float-leading"},
p);f=b.create("div",{"class":"mask",innerHTML:d||f,title:f},h);h=b.create("input",{style:{display:"none"}},h);b.setAttr(g,"value",c);b.setAttr(h,"value",d);this._bindNodeEvents(p,e,g,f,h,a);c||this.focusNewItem(p,e,g,a);return p},focusNewItem:function(a,c,e,d){"links"===d?(this.selectLinkNode&&b.removeClass(this.selectLinkNode,"selected-item"),b.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===d&&(this.selectProxyRuleNode&&b.removeClass(this.selectProxyRuleNode,"selected-item"),b.addClass(a,
"selected-item"),this.selectProxyRuleNode=a);b.setStyle(c,"display","none");b.setStyle(e,"display","block");e.value=c.innerHTML;setTimeout(function(){e.focus();e.select()},0)},createLinkNode:function(a){a=this._createListItem("links",a.label,this.nls.labelPlaceholder,a.url,this.nls.urlPlaceholder);b.place(a,this.linksListNode)},createProxyRuleNode:function(a){a=this._createListItem("proxyRules",a.urlPrefix,this.nls.prefixPlaceholder,a.proxyUrl,this.nls.proxyUrlPlaceholder);b.place(a,this.proxyRulesListNode)},
_keepOrder:function(){var a=b.getMarginBox(this.headerSection),c=b.getMarginBox(this.linksSection),e=b.getMarginBox(this.appIdSection),d=b.getMarginBox(this.useProxySection),a=a.h+c.h+e.h+d.h,c=b.getMarginBox(this.domNode).h;a>c&&b.setStyle(this.domNode,"paddingRight","10px")},onAddLinkClick:function(a){a.stopPropagation();4!==m(".links-list .list-item",this.domNode).length&&(this.createLinkNode({label:"",url:""}),this._keepOrder())},_onEditItemClick:function(a){var c=m(".first .mask",a)[0];a=m(".first input",
a)[0];b.setStyle(c,"display","none");b.setStyle(a,"display","block");a.focus();a.select()},onEditLinkClick:function(){this.selectLinkNode&&this._onEditItemClick(this.selectLinkNode)},onDeleteLinkClick:function(){this.selectLinkNode&&(b.destroy(this.selectLinkNode),g.publish("configChanged","app",{links:this.getLinks()}))},onAddProxyRuleClick:function(a){this.createProxyRuleNode({urlPrefix:"",proxyUrl:""});this._keepOrder();a.stopPropagation()},onEditProxyRuleClick:function(){this.selectProxyRuleNode&&
this._onEditItemClick(this.selectProxyRuleNode)},onDeleteProxyRuleClick:function(){this.selectProxyRuleNode&&(b.destroy(this.selectProxyRuleNode),g.publish("configChanged","app",{httpProxy:this.getProxy()}))},_onUseProxySettingChange:function(){this.useProxySetting.checked?b.setStyle(this.proxySection,"display","block"):b.setStyle(this.proxySection,"display","none");this.showProxySetting!==this.useProxySetting.checked&&(this._publishProxy(),this.showProxySetting=this.useProxySetting.checked)},_onAlwaysUseProxyChange:function(){this.showAlwaysUseProxy!==
this.alwaysUseProxy.checked&&(this._publishProxy(),this.showAlwaysUseProxy=this.alwaysUseProxy.checked)},_onProxyUrlChange:function(){this._publishProxy()},_onProxyUrlBlur:function(){this.proxyUrlNode.value?b.removeClass(this.proxyUrlNode,"error-status"):b.addClass(this.proxyUrlNode,"error-status")},_onAppIdChange:function(){g.publish("configChanged","app",{appId:this.appIdNode.value})},_publishProxy:function(){g.publish("configChanged","app",{httpProxy:this.getProxy()})}})})},"builder/config/TabContainer2":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dojo/NodeList-manipulate dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer2.html jimu/dijit/ViewStack".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r){return t([m,n,h],{templateString:f,_controlNodes:null,selected:"",tabs:null,"class":"jimu-tab2",postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.nls=d.mixin(this.nls,builderNls.leftPane)},postCreate:function(){this.inherited(arguments);this._controlNodes=[];this.viewStack=new r(null,this.containerNode);b.forEach(this.tabs,function(b){this._createTab(b)},this)},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&
this.selectTab(this.tabs[0].title)},_createTab:function(b){var f=g.toDom('\x3ctd\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3cdiv class\x3d"tab-item-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"tab-item-title"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e');g.place(f,this.tabTr);var h=q(".tab-item-div",f)[0],n=q(".tab-item-icon",f)[0],f=q(".tab-item-title",f)[0];f.innerHTML=b.title||"";g.setAttr(f,"title",b.title||"");var l=b.title;l===this.nls.themes?(g.addClass(n,"themes"),g.addClass(f,"themes")):l===this.nls.map?
(g.addClass(n,"map"),g.addClass(f,"map")):l===this.nls.widgets?(g.addClass(n,"widgets"),g.addClass(f,"widgets")):l===this.nls.attributes&&(g.addClass(n,"attributes"),g.addClass(f,"attributes"));this.viewStack.viewType=b.content.domNode?"dijit":"dom";h.label=b.title;b.content.label=b.title;this.viewStack.addView(b.content);this.own(k(h,"click",d.hitch(this,this.onSelect,b.title)));this._controlNodes.push(h)},onSelect:function(b){this.selectTab(b)},selectTab:function(f){b.forEach(this._controlNodes,
d.hitch(this,function(b){g.removeClass(b,"selected-tab-item-div");b.label===f&&g.addClass(b,"selected-tab-item-div")}));this.viewStack.switchView(f);this.emit("tabChanged",f)}})})},"builder/CreateAppNew":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/request dojo/Deferred dojo/keys dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/CreateAppNew.html dojo/on dojo/dom dojo/dom-style dojo/dom-class dojo/dom-attr dojo/_base/lang dojo/cookie dojo/promise/all jimu/dijit/Message jimu/dijit/Popup builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter dojo/ready ./serviceUtils ./Tags dijit/form/SimpleTextarea dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A,z,D,C,F,G){function H(a,b,d){var f=B.getPortal(A.getPortalUrlFromLocation()),g=new k,h=new k,z=new k,C=new k;f.getUser().then(e.hitch(this,function(a){g.resolve(a)}),e.hitch(this,function(a){new p({message:builderNls.apps.createAppUrlError});console.error(a.message);g.reject()}));f.getItemById(d).then(e.hitch(this,function(a){h.resolve(a)}),e.hitch(this,function(a){new p({message:builderNls.apps.createAppUrlError});console.error(a.message);
h.reject(a)}));c({user:g,userItem:z}).then(e.hitch(this,function(c){var d={};switch(c.userItem.sharing.access){case "public":d.everyone=!0;d.groups=c.userItem.sharing.groups.toString();break;case "account":case "org":d.org=!0;d.groups=c.userItem.sharing.groups.toString();break;case "shared":d.groups=c.userItem.sharing.groups.toString()}c.user.shareItem(d,a,b).then(e.hitch(this,function(a){C.resolve(a)}),e.hitch(this,function(a){new p({message:builderNls.apps.createAppUrlError});console.error(a.message);
C.reject()}))}));c({user:g,webmapItem:h}).then(e.hitch(this,function(c){if(c.webmapItem.owner===c.user.username)c.user.getItemById(d,c.webmapItem.ownerFolder).then(e.hitch(this,function(a){z.resolve(a)}),e.hitch(this,function(a){new p({message:builderNls.apps.createAppUrlError});console.error(a.message);z.reject(a)}));else{var f={};switch(c.webmapItem.access){case "public":f.everyone=!0;break;case "account":case "org":f.org=!0}c.user.shareItem(f,a,b).then(e.hitch(this,function(a){C.resolve(a)}),e.hitch(this,
function(a){new p({message:builderNls.apps.createAppUrlError});console.error(a.message);C.reject()}))}}))}var E=t([l,m,n],{templateString:r,baseClass:"create-app",appListWidget:null,createFromId:null,is3D:"false",_appBuilderSettings:null,_configureSettings:null,isXT:null,user:null,webmap:null,postMixInProperties:function(){this.nls=e.mixin({},builderNls.common);this.nls=e.mixin(this.nls,builderNls.apps)},postCreate:function(){this.inherited(arguments)},constructor:function(){},startup:function(){this.inherited(arguments);
this._initDlgPage()},_initDlgPage:function(){this.appTitle.focus();window.isXT?(x.set(this.tagsTr,"display","none"),x.set(this.folderTr,"display","none"),x.set(this.sharingTr,"display","none"),w.add(this.app2D,"app-image-div-down"),this.createFromId&&x.set(this.div2dAnd3d,"display","none"),this._getInitAppInfo().then(e.hitch(this,function(a){this._setDlgProperties(a)}))):(x.set(this.div2dAnd3d,"display","none"),this.createFromId&&x.set(this.sharingTr,"display","none"),B.getPortal(A.getPortalUrlFromLocation()).getUser().then(e.hitch(this,
function(a){this.user=a;this._initFolder(a);this._getInitAppInfo().then(e.hitch(this,function(c){f.byId("publish-webmap-tags").loadTags(a).then(e.hitch(this,function(){this._setDlgProperties(c)}))}))}),e.hitch(this,function(a){this._setDlgProperties(E.getDefaultAppInfo());console.error(a.message)})))},_saveAs:function(a){var c=new k;C.duplicateApp(a,this.appConfig).then(e.hitch(this,function(b){this._closePopup();this.destroy();var d=e.clone(a);d.id=b.newAppId;d.name=b.newName;q.publish("switchToApp",
d);(b=main.getViewByLabel("apps"))&&window.isXT&&b.refresh();c.resolve()}),e.hitch(this,function(a){console.error("APP Save As failed!"+a);new p({message:builderNls.apps.saveAsFaied});c.reject()}));return c},_onCancelClick:function(){this._closePopup();this.destroy();console.debug("cancel click")},_onNextClick:function(){if(f.byId("publish-webmap-title").get("value")){var a=this._getDlgProperties(),c=new z;c.placeAt(this.popup.domNode);c.startup();this.createFromId?this._saveAs(this._convertAppInfo(a)).then(function(){c.destroy()},
function(){c.destroy()}):E.create(this._convertAppInfo(a)).then(e.hitch(this,function(){this.appListWidget&&this.appListWidget.refresh();this._closePopup();this.destroy();c.destroy()}),function(){c.destroy()})}else new p({message:this.nls.noAppName})},_closePopup:function(){this.popup&&this.popup.close()},_on2dClick:function(){"true"===this.is3D&&(this.is3D="false",w.add(this.app2D,"app-image-div-down"),w.remove(this.app3D,"app-image-div-down"))},_on3dClick:function(){},_getInitAppInfo:function(){var a=
new k,c=E.getDefaultAppInfo();window.isXT?this.createFromId?C.getAppInfo(this.createFromId).then(e.hitch(this,function(b){c.name=b.name+this.nls._copy;c.description=b.description;this.is3D=c.is3D=b.is3D;a.resolve(c)}),e.hitch(this,function(c){console.error(this.nls.saveAsFaied,c);a.reject()})):a.resolve(c):this.createFromId?B.getPortal(A.getPortalUrlFromLocation()).getItemById(this.createFromId).then(e.hitch(this,function(b){c.name=b.title+this.nls._copy;c.tags=b.tags;c.description=b.snippet;a.resolve(c)}),
e.hitch(this,function(c){console.error(this.nls.saveAsFaied,c);a.reject()})):a.resolve(c);return a},_getDlgProperties:function(){return{name:f.byId("publish-webmap-title").get("value"),tags:f.byId("publish-webmap-tags").get("tags"),description:f.byId("publish-webmap-summary").get("value"),folderId:f.byId("publish-webmap-folder").get("value"),sharing:f.byId("publish-webmap-sharing").get("checked")}},_setDlgProperties:function(a){f.byId("publish-webmap-title").set("value",a.name);f.byId("publish-webmap-tags").set("tags",
a.tags||[]);f.byId("publish-webmap-summary").set("value",a.description);f.byId("publish-webmap-folder").set("value",a.folderId);f.byId("publish-webmap-sharing").set("checked",a.sharing);"true"===a.is3D?(w.add(this.app3D,"app-image-div-down"),w.remove(this.app2D,"app-image-div-down")):(w.add(this.app2D,"app-image-div-down"),w.remove(this.app3D,"app-image-div-down"))},_initFolder:function(a){var c=new k;a.getContent().then(e.hitch(this,function(b){var p=[{label:a.username,value:""}],p=p.concat(d.map(b.folders,
e.hitch(this,function(a){return{label:a.title,value:a.id}})));f.byId("publish-webmap-folder").set("options",p);f.byId("publish-webmap-folder").set("value","");c.resolve()}),function(a){console.error("get userContent error!");c.reject()});return c},_convertAppInfo:function(a){return{name:a.name,description:a.description,tags:a.tags,folderId:a.folderId,sharing:a.sharing,is3D:this.is3D,webmap:this.webmap,createFromId:this.createFromId}}});E.getDefaultAppInfo=function(){return{name:"",description:"",
tags:["AppBuilder App"],folderId:"",sharing:!1,is3D:"false",webmap:null,createFromId:null,creator:null}};E.create=function(a){var c=new k;C.createApp(a).then(e.hitch(this,function(b){if(b.success){var d=e.clone(a);d.id=b.newAppId;q.publish("switchToApp",d);c.resolve();a.sharing&&a.webmap&&H(b.newAppId,a.folderId,a.webmap)}else new p({message:b.message}),c.reject()}),e.hitch(this,function(a){new p({message:a.message});c.reject(a)}));return c};E.popupDlg=function(a,c){var b=new E(a);new y({content:b,
container:"main-page",titleLabel:c||builderNls.apps.appCreateTitle,width:669,autoHeight:!0,buttons:[{label:builderNls.common.ok,key:h.ENTER,onClick:e.hitch(b,b._onNextClick)},{label:builderNls.common.cancel,key:h.ESCAPE,onClick:e.hitch(b,b._onCancelClick)}]});b.startup()};return E})},"dijit/dijit":function(){define("./main ./_base dojo/parser ./_Widget ./_TemplatedMixin ./_Container ./layout/_LayoutWidget ./form/_FormWidget ./form/_FormValueWidget".split(" "),function(t){return t})},"builder/Tags":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/on dojo/dom dojo/dom-construct dojo/parser dojo/store/Memory dojo/Deferred dojo/sniff dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_WidgetBase dijit/registry dijit/form/TextBox ./AutoComplete builder/portalUtils jimu/portalUrlUtils dojo/text!./templates/Tags.html dojo/domReady!".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a){return b([u,f],{templateString:a,baseClass:"esriAGOTags",_minWidth:"auto",_maxWidth:"auto",postMixInProperties:function(){this.inherited(arguments);this.nls={addTags:builderNls.apps.addTags,noTagsFound:"No existing tags match."}},postCreate:function(){this.inherited(arguments);this._isIE8=n("ie")},startup:function(){this.inherited(arguments)},loadTags:function(a){var b=new m;this._isIE8?(this._textTags||(this.tagsId="userTags-"+(new Date).getTime(),
h.create("div",{id:this.tagsId},this.domNode),this._textTags=new x({placeHolder:this.nls.addTags,trim:!0,style:{minWidth:this._minWidth,maxWidth:this._maxWidth}},this.tagsId)),b.resolve()):a?a.getTags().then(d.hitch(this,function(a){this._handleTags(a);b.resolve()}),d.hitch(this,function(a){console.error("get user tags error: "+a);this._handleTags({tags:[]});b.resolve()})):(this._handleTags({tags:[]}),b.resolve());return b},_handleTags:function(a){if(a){this._autoComplete&&this._autoComplete.clearTags();
var b=[];a.tags&&t.forEach(a.tags,d.hitch(this,function(a){b.push(a)}));this._tagStore?(this._tagStore.query({}).forEach(d.hitch(this,function(a){this._tagStore.remove(a.tag)})),t.forEach(b,d.hitch(this,function(a){this._tagStore.add(a)}))):this._tagStore=new l({idProperty:"tag",data:b});this._autoComplete||(a=(new Date).getTime(),this.tagsId="userTags-"+a,this.gridId="grid-"+a,this.filterId="filter-"+a,h.create("div",{id:this.tagsId,className:"grid_1"},this.domNode),this._autoComplete=new w({placeholder:this.nls.addTags,
noDataMsg:this.nls.noTagsFound,idProperty:"tag",gridId:this.gridId,filterId:this.filterId,minWidth:this._minWidth,maxWidth:this._maxWidth,matchParam:"first",store:this._tagStore,style:{width:this._minWidth}},this.tagsId))}},_getUniqueTags:function(a){return t.filter(a,d.hitch(this,function(b,e){return t.indexOf(a,b)===e}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){a&&!(a instanceof Array)&&(a=a.split(","));this._isIE8?
this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):this._autoComplete&&(this._autoComplete.clearTags(),this._autoComplete.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this._autoComplete&&this._autoComplete.values?this._autoComplete.values.join(","):""},_setMinWidthAttr:function(a){this._minWidth=a},_setMaxWidthAttr:function(a){this._maxWidth=a}})})},"builder/AutoComplete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/window dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/html dojo/json dojo/keys dojo/on dojo/query dojo/request dojo/string dijit/focus dijit/form/TextBox dijit/registry dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dojo/NodeList-traverse dojo/NodeList-manipulate".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A,z){return d([y,c,p],{_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_maxWidth:"",_minWidth:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",
SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},values:[],_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",constructor:function(a,c){this._attachmentNode=c;this._idProperty=a.idProperty;this._gridId=a.gridId;this._filterId=a.filterId;this._store=a.store;this._placeHolder=a.placeholder;this._noDataMsg=a.noDataMsg;this._maxWidth=a.maxWidth;this._minWidth=a.minWidth;this._matchParam=a.matchParam;this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=
this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},buildRendering:function(){this._createContainerNode();this._createTagList();this._createDropDownList();this._createInput();var a=b.hitch(this,function(a,c,b){c=this._inputTextBox?this._inputTextBox.get("value")+"":"";if(1>c.length)return!0;if(!a.tag)return!1;
a=(a.tag+"").toLowerCase().match(RegExp("^"+c.toLowerCase()));return null!==a&&0<a.length?!0:!1}),c=b.hitch(this,function(a,c,b){c=this._inputTextBox?this._inputTextBox.get("value")+"":"";return 1>c.length?!0:!a.tag?!1:~(a.tag+"").toLowerCase().indexOf(c.toLowerCase())?!0:!1}),e=[{field:this._idProperty}],f=[{attribute:this._idProperty,ascending:!0}];this._grid=new (d([B,A,z]))({store:this._store,showHeader:!1,noDataMessage:this._noDataMsg,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,
columns:e,sort:f,renderRow:this._renderItem},this._gridId);q.add(this._gridId,"gridHeightLimiter");this._grid.query="first"===this._matchParam?a:c},postCreate:function(){var a;this._inputTextBox.watch("value",b.hitch(this,function(c,b,e){a&&(clearTimeout(a),a=null);this._grid.refresh()}));this._grid.on(".dgrid-row:click",b.hitch(this,function(a){var c="";!this._shiftKeyPressed&&!this._metaKeyPressed?(c=this._grid.row(a).data.tag,this._createTags(c),this._store.remove(c),this._grid.refresh(),this._resetInputTextBox()):
!a.shiftKey&&(!a.metaKey&&!a.ctrlKey)&&(c=this._selRows[0],this._createTags(c),this._store.remove(c),this._grid.refresh(),this._resetInputTextBox())}));this._grid.on("dgrid-deselect",b.hitch(this,function(a){this._selRows=[];for(var c in this._grid.selection)this._selRows.push(c)}));this._grid.on("dgrid-select",b.hitch(this,function(a){this._selRows=[];for(var c in this._grid.selection)this._selRows.push(c)}));this.connect(this.domNode,"keydown","_keydownHandler");window.onkeydown=b.hitch(this,function(a){if(a.shiftKey||
a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.connect(document,"onkeydown",b.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0}))},_keydownHandler:function(a){var c;void 0!==v.curNode.value&&(c=v.curNode.value.length);var e=s(this._CHOICE_FOCUS,k.byId(this.id)),d=s(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,k.byId(this.id)).last();switch(a.keyCode){case r.RIGHT_ARROW:this._navigate(e,c,d,"right");this._hideGrid();break;case r.LEFT_ARROW:this._navigate(e,
c,d,"left");this._hideGrid();break;case r.DOWN_ARROW:a.preventDefault();this._unhighlightTag(e);"none"===m.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,0)),this._gridHasFocus=!0);break;case r.UP_ARROW:break;case r.BACKSPACE:var f;if(0===c&&0===s(this._CHOICE_FOCUS_ALL).length&&void 0!==s(this._CHOICE_ALL_SELECTOR)[s(this._CHOICE_ALL_SELECTOR).length-1]&&(f=s(this._CHOICE_ALL_SELECTOR)[s(this._CHOICE_ALL_SELECTOR).length-1].title,
0<s("li",this._attachmentNode).length&&(l.destroy(d[0]),void 0!==f)))try{this._store.add({tag:f})}catch(p){}if(0<s(this._CHOICE_FOCUS_ALL).length&&(f=s(this._CHOICE_FOCUS_ALL).text(),l.destroy(e[0]),void 0!==f))try{this._store.add({tag:f})}catch(g){}this._grid.refresh();0===c&&this._hideGrid();this._removeTag(f);break;case r.CTRL:this._metaKeyPressed=!0;break;case r.META:this._metaKeyPressed=!0;break;case r.SHIFT:this._shiftKeyPressed=!0;break;case r.ENTER:if(0<c){c=v.curNode.value;c=c.split(",");
var h=[];t.forEach(c,function(a,c){-1===t.indexOf(h,a)&&h.push(w.trim(a))});t.forEach(h,b.hitch(this,function(a,c){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}))}else{for(c=0;c<this._selRows.length;c++)this._createTags(this._selRows[c]),this._store.remove(this._selRows[c]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();a.preventDefault();v.focus(k.byId(this._filterId));break;case r.TAB:if(!(v.curNode.id===this._filterId&&0===c)){if(0<c)c=v.curNode.value,
c=c.split(","),h=[],t.forEach(c,function(a,c){-1===t.indexOf(h,a)&&h.push(w.trim(a))}),t.forEach(h,b.hitch(this,function(a,c){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(c=0;c<this._selRows.length;c++)this._createTags(this._selRows[c]),this._store.remove(this._selRows[c]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();a.preventDefault();v.focus(k.byId(this._filterId))}break;case r.ESCAPE:this._hideGrid();break;default:-1<c&&("none"===m.get(k.byId(this._gridId),
"display")&&this._showGrid(),this._unhighlightTag(e)),this._metaKeyPressed=!1}},_blurHandler:function(a,c,e){if(!this.focused){if(0<this._inputTextBox.value.length){var d=[];a=this._inputTextBox.value.split(",");t.forEach(a,function(a,c){-1===t.indexOf(d,a)&&d.push(w.trim(a))});t.forEach(d,b.hitch(this,function(a,c){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}},_resetInputTextBox:function(){a.byId(this._filterId).set("value","")},
_isEmpty:function(a){a=a.replace(/^\s+|\s+$/,"");return 0===a.length?!0:!1},_navigate:function(a,c,b,e){0<a.length&&1>c?("right"===e?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),this._unhighlightTag(a)):1>c&&this._hightlightTag(b)},_contains:function(a,c){return 0<=t.indexOf(a,c)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==t.indexOf(this.values,
a)&&this.values.splice(t.indexOf(this.values,a),1)},_hideGrid:function(){k.byId(this._gridId)&&m.set(k.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){m.set(k.byId(this._gridId),"display","block");var a=m.get(k.byId(this._attachmentNode),"width");m.set(k.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,c){return s(".dgrid-content .dgrid-cell",this._grid.domNode)[c]||s(".dgrid-content .dgrid-row",this._grid.domNode)[c]},_createTags:function(c){s(this._CHOICE_FOCUS,
k.byId(this.id)).removeClass("select2-search-choice-focus");var e=l.create("li",null,this._autocompleteList);q.add(e,this._CSS_STYLES.CHOICE);e=l.create("div",{title:c},e);n.set(e,this.htmlEncode(c));e=l.create("a",{href:"#"},e);q.add(e,this._CSS_STYLES.CLOSE_ICON);u(e,"click",b.hitch(this,function(a){var c=a.target.parentElement.innerText||a.target.parentElement.textContent;try{this._store.add({tag:c})}catch(b){}this._grid.refresh();this._removeTag(c);l.destroy(a.target.parentNode.parentNode);a.preventDefault()}));
e=a.byId(this._filterId);l.place(e.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(c)},_renderItem:function(a){return l.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this.domNode=l.create("div",null,this._attachmentNode);q.add(this.domNode,this._CSS_STYLES.MULTI);m.set(this.domNode,"maxWidth",this._maxWidth);m.set(this.domNode,"minWidth",this._minWidth)},_createTagList:function(){this._autocompleteList=l.create("ul",null,this.domNode);q.add(this._autocompleteList,
this._CSS_STYLES.CHOICES)},_createInput:function(){var a=l.create("li",null,this._autocompleteList,"last");q.add(a,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new e({id:this._filterId,placeHolder:this._placeHolder,intermediateChanges:!0,trim:!0,style:{border:"none"}},a);q.add(this._inputTextBox,"inputTextBox");m.set(this._inputTextBox,"width",this._minWidth);v.watch("curNode",b.hitch(this,this._blurHandler))},_createDropDownList:function(){var a=l.create("div",{id:this._gridId},this.domNode);
q.add(a,"dropDownList");m.set(a,"width",this._minWidth)},prepopulate:function(a){t.forEach(a,b.hitch(this,function(a,c){this._createTags(a);this._store.remove(a)}))},clearTags:function(){var a=s(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,k.byId(this.id));0<a.length&&(t.forEach(a,b.hitch(this,function(a,c){try{this._store.add({tag:s(this._CHOICE_ALL_SELECTOR,k.byId(this.id))[0].title})}catch(b){}l.destroy(a)})),this.values=[])},addStyledTags:function(a,c){q.add(k.byId(c),this._CSS_STYLES.MULTI);
var b=l.create("ul",null,k.byId(c));q.add(b,this._CSS_STYLES.CHOICES);m.set(b,"border","none");t.forEach(a,function(a,c){var e=l.create("li",null,b);m.set(e,"padding","3px 5px 3px 5px");q.add(e,"select2-search-resultSet");e=l.create("div",{title:a},e);n.set(e,a)})},htmlEncode:function(a){return!a?a:a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;")}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),
function(t,d,b,g,k,h,q,l){function m(a){a.preventDefault()}var n={checkbox:1,radio:1,button:1},f=/\bdgrid-cell\b/,r=/\bdgrid-row\b/,u=t("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=g.mixin({},u.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=g.mixin({},u.defaultHeaderKeyMap))},postCreate:function(){function a(c){var b=c.target;return b.type&&(!n[b.type]||32==c.keyCode)}function c(p){function g(){e._focusedHeaderNode&&
(e._focusedHeaderNode.tabIndex=-1);if(e.showHeader&&(e._focusedHeaderNode=m=h?e.headerNode.getElementsByTagName("th")[0]:e.headerNode))m.tabIndex=e.tabIndex}var h=e.cellNavigation,n=h?f:r,k=p===e.headerNode,m=p;k?(g(),d.after(e,"renderHeader",g,!0)):d.after(e,"renderArray",function(a){return l.when(a,function(a){var c=e._focusedNode||m;if(n.test(c.className)&&q.contains(p,c))return a;for(var b=0,d=p.getElementsByTagName("*"),f;f=d[b];++b)if(n.test(f.className)){c=e._focusedNode=f;break}c.tabIndex=
e.tabIndex;return a})});e._listeners.push(b(p,"mousedown",function(c){a(c)||e._focusOnNode(c.target,k,c)}));e._listeners.push(b(p,"keydown",function(c){if(!c.metaKey&&!c.altKey){var b=e[k?"headerKeyMap":"keyMap"][c.keyCode];b&&!a(c)&&b.call(e,c)}}))}this.inherited(arguments);var e=this;this.tabableHeader&&(c(this.headerNode),b(this.headerNode,"dgrid-cellfocusin",function(){e.scrollTo({x:this.scrollLeft})}));c(this.contentNode)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);
var c=this,b=document.activeElement===this._focusedNode,e=this[this.cellNavigation?"cell":"row"](this._focusedNode),d=e.row||e,f;a=a.element||a;if(a===d.element){f=this.down(d,!0);if(!f||f.element===a)f=this.up(d,!0);this._removedFocus={active:b,rowId:d.id,columnId:e.column&&e.column.id,siblingId:!f||f.element===a?void 0:f.id};setTimeout(function(){c._removedFocus&&c._restoreFocus(d.id)},0);this._focusedNode=null}this.inherited(arguments)},insertRow:function(a){var c=this.inherited(arguments);this._removedFocus&&
!this._removedFocus.wait&&this._restoreFocus(c);return c},_restoreFocus:function(a){var c=this._removedFocus,b;if((a=(a=a&&this.row(a))&&a.element&&a.id===c.rowId?a:"undefined"!==typeof c.siblingId&&this.row(c.siblingId))&&a.element){if(!a.element.parentNode.parentNode){c.wait=!0;return}"undefined"!==typeof c.columnId&&(b=this.cell(a,c.columnId))&&b.element&&(a=b);c.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,null):(h(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=
a.element)}delete this._removedFocus},addKeyHandler:function(a,c,b){return d.after(this[b?"headerKeyMap":"keyMap"],a,c,!0)},_focusOnNode:function(a,c,e){var d="_focused"+(c?"Header":"")+"Node";c=this[d];var p=this.cellNavigation?"cell":"row",n=this[p](a),l,m,q,A,y;if(a=n&&n.element){if(this.cellNavigation){l=a.getElementsByTagName("input");y=0;for(q=l.length;y<q;y++)if(m=l[y],(-1!=m.tabIndex||"lastValue"in m)&&!m.disabled){8>k("ie")&&(m.style.position="relative");m.focus();8>k("ie")&&(m.style.position=
"");A=!0;break}}null!==e&&(e=g.mixin({grid:this},e),e.type&&(e.parentType=e.type),e.bubbles||(e.bubbles=!0));c&&(h(c,"!dgrid-focus[!tabIndex]"),8>k("ie")&&(c.style.position=""),e[p]=this[p](c),b.emit(c,"dgrid-cellfocusout",e));c=this[d]=a;e&&(e[p]=n);d=this.cellNavigation?f:r;!A&&d.test(a.className)&&(8>k("ie")&&(a.style.position="relative"),a.tabIndex=this.tabIndex,a.focus());h(a,".dgrid-focus");e&&b.emit(c,"dgrid-cellfocusin",e)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,
!0)},focus:function(a){this._focusOnNode(a||this._focusedNode,!1)}}),s=u.moveFocusVertical=function(a,c){var b=this.cellNavigation,e=this[b?"cell":"row"](a),e=b&&e.column.id,d=this.down(this._focusedNode,c,!0);b&&(d=this.cell(d,e));this._focusOnNode(d,!1,a);a.preventDefault()};t=u.moveFocusUp=function(a){s.call(this,a,-1)};var x=u.moveFocusDown=function(a){s.call(this,a,1)},w=u.moveFocusPageUp=function(a){s.call(this,a,-this.pageSkip)},v=u.moveFocusPageDown=function(a){s.call(this,a,this.pageSkip)},
e=u.moveFocusHorizontal=function(a,c){if(this.cellNavigation){var b=!this.row(a);this._focusOnNode(this.right(this["_focused"+(b?"Header":"")+"Node"],c),b,a);a.preventDefault()}},a=u.moveFocusLeft=function(a){e.call(this,a,-1)},c=u.moveFocusRight=function(a){e.call(this,a,1)},p=u.moveHeaderFocusEnd=function(a,c){var b;this.cellNavigation&&(b=this.headerNode.getElementsByTagName("th"),this._focusOnNode(b[c?0:b.length-1],!0,a));a.preventDefault()},y=u.moveHeaderFocusHome=function(a){p.call(this,a,!0)},
B=u.moveFocusEnd=function(a,c){var b=this,e=this.cellNavigation,f=this.contentNode,p=f.scrollTop+(c?0:f.scrollHeight),f=f[c?"firstChild":"lastChild"],h=-1<f.className.indexOf("dgrid-preload"),n=h?f[(c?"next":"previous")+"Sibling"]:f,m=n.offsetTop+(c?0:n.offsetHeight),r;if(h){for(;n&&0>n.className.indexOf("dgrid-row");)n=n[(c?"next":"previous")+"Sibling"];if(!n)return}!h||1>f.offsetHeight?(e&&(n=this.cell(n,this.cell(a).column.id)),this._focusOnNode(n,!1,a)):(k("dom-addeventlistener")||(a=g.mixin({},
a)),r=d.after(this,"renderArray",function(d){r.remove();return l.when(d,function(d){d=d[c?0:d.length-1];e&&(d=b.cell(d,b.cell(a).column.id));b._focusOnNode(d,!1,a)})}));p===m&&a.preventDefault()},A=u.moveFocusHome=function(a){B.call(this,a,!0)};u.defaultKeyMap={32:m,33:w,34:v,35:B,36:A,37:a,38:t,39:c,40:x};u.defaultHeaderKeyMap={32:m,35:p,36:y,37:a,39:c};return u})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(t,d,b,g){return t("dijit.form.SimpleTextarea",
g,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);b("ie")&&this.cols&&d.add(this.textbox,"dijitTextAreaCols")},filter:function(b){b&&(b=b.replace(/\r/g,""));return this.inherited(arguments)},
_onInput:function(d){if(this.maxLength){var g=parseInt(this.maxLength),q=this.textbox.value.replace(/\r/g,""),g=q.length-g;if(0<g){var l=this.textbox;if(l.selectionStart){var m=l.selectionStart,n=0;b("opera")&&(n=(this.textbox.value.substring(0,m).match(/\r/g)||[]).length);this.textbox.value=q.substring(0,m-g-n)+q.substring(m-n);l.setSelectionRange(m-g,m-g)}else this.ownerDocument.selection&&(l.focus(),q=this.ownerDocument.selection.createRange(),q.moveStart("character",-g),q.text="",q.select())}}this.inherited(arguments)}})})},
"builder/AGOLTemplate/AGOLTemplate":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/request dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/AGOLTemplate.html dojo/on dojo/dom dojo/_base/lang dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/json dojo/query dojo/Deferred dojo/keys dojo/request/xhr dijit/form/Select esri/request require ./ConfigNode ./Category ./CategoryManager ./ShowJsonCodePage ./Export ../serviceUtils jimu/utils jimu/WidgetManager jimu/dijit/Message jimu/dijit/Popup jimu/portalUrlUtils builder/portalUtils jimu/dijit/LoadingShelter ./ExportMessage".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A,z,D,C,F,G,H,E,I,J,M,K,L){return t([k,h],{templateString:q,baseClass:"agol-template",configTree:null,nls:null,lastTemplateJson:null,postMixInProperties:function(){this.nls=n.mixin({},builderNls.common);this.nls=n.mixin(this.nls,builderNls.agolTemplate);this.arrowImgSrc=isRTL?"builder/css/images/v_left.png":"builder/css/images/v_right.png"},postCreate:function(){this.inherited(arguments)},startup:function(){m.setSelectable(this.contentPart,!1);
this.showJsonWidget=new D({},this.showJsonContentDiv);this.configTree=new B(this.appConfig,null,"app","",0);this.categoryManager=new z(this.configTree,this.appConfig,this.app.agolTemplateInfo);this.drawTree(this.configTree,this.treePart);this.drawCategoryPart();this.initWork()},drawTree:function(a,c){var b,e;b=this.drawDomNode(a,c);if(0!==a.childs.length)for(e=0;e<a.childs.length;e++)this.drawTree(a.childs[e],b)},drawDomNode:function(a,c){var e,d,p,g,h,k;k=this.categoryManager.getCategoryByField(a.absolutePath);
e=f.create("div",{"class":"tree-node-div",idAttr:a.id},c);a.traversal(n.hitch(this,function(a){if(this.categoryManager.getCategoryByField(a.absolutePath))return!0}))||r.set(e,"display","none");"leaf"===a.nodeType&&!k&&r.set(e,"color","#cccccc");"leaf"!==a.nodeType&&(p=f.create("div",{"class":"show-subnode-div jimu-float-leading"},e),g=f.create("img",{"class":"show-subnode-img",src:this.arrowImgSrc,alt:"img"},p));f.create("span",{"class":"line-label-span jimu-float-leading",innerHTML:a.label?a.label:
a.keyString},e);k&&"leaf"===a.nodeType&&(h=f.create("div",{"class":"to-right-div jimu-float-trailing"},e),f.create("img",{"class":"to-right-img",src:"builder/css/images/add_field.png",alt:"img"},h),this.own(l(h,"click",n.hitch(this,function(c){r.set(h,"display","none");this._onToRightDiv(a,"add",e);c.stopPropagation();this._checkTemplateStatus()}))),-1!==k.findFieldFromDisplay(a.absolutePath)&&r.set(h,"display","none"));d=12*a.level;"leaf"===a.nodeType?isRTL?r.set(e,"paddingRight",d+17+"px"):r.set(e,
"paddingLeft",d+17+"px"):isRTL?r.set(e,"paddingRight",d+"px"):r.set(e,"paddingLeft",d+"px");d=f.create("div",{"class":"tree-node-subdiv"},c);r.set(d,"display","none");"leaf"!==a.nodeType?(r.set(e,"cursor","pointer"),this.own(l(e,"click",n.hitch(this,function(a,c,b){"none"===r.get(c,"display")?(r.set(c,"display","block"),s.set(b,"src","builder/css/images/v.png")):(r.set(c,"display","none"),s.set(b,"src",this.arrowImgSrc));-1!==a.absolutePath.search(/widgets\[[0-9]+\]_config$/)&&!a.jsonObject&&this.addWidgetConfigToConfigTree(a.absolutePath)},
a,d,g)))):k&&(r.set(e,"cursor","pointer"),this.own(l(e,"click",n.hitch(this,function(a,c){this._onToRightDiv(a,"notAdd",e);c.stopPropagation()},a))));a.lineDomNode=e;a.subLineDomNode=d;a.showSubDivDomNode=p;a.toRightDiv=h;0===a.level&&(b.setStyle(e,"display","none"),b.setStyle(d,"display","block"));return d},drawCategoryPart:function(){d.forEach(this.categoryManager.displayCategorys,function(a){this.drawCategory(a)},this)},drawCategory:function(a){var c,b,e,p,g,h,k;c=f.create("div",{"class":"category-div",
categoryDiv:a.name},this.categoryPart);p=f.create("div",{"class":"category-head-div",categoryHeadDiv:a.name},c);g=f.create("div",{"class":"category-fold-div jimu-float-leading"},p);k=f.create("img",{"class":"category-fold-img",src:this.arrowImgSrc,alt:"img"},g);f.create("div",{"class":"category-title-div jimu-float-leading",innerHTML:a.title},p);b=f.create("div",{"class":"category-oper-div jimu-float-trailing"},p);g=f.create("div",{"class":"category-oper-item-div category-moveup-div jimu-float-leading",
innerHTML:"\x3cimg src\x3d'builder/css/images/moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},b);h=f.create("div",{"class":"category-oper-item-div category-movedown-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'builder/css/images/movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},b);b=f.create("div",{"class":"category-oper-item-div category-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'builder/css/images/delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},b);e=f.create("div",{"class":"fields-div",
fieldsDiv:a.name},c);this.own(l(g,"click",n.hitch(this,function(c){this.categoryManager.moveup(a)&&(f.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);c.stopPropagation();this._checkTemplateStatus()})));this.own(l(h,"click",n.hitch(this,function(c){this.categoryManager.movedown(a)&&(f.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);c.stopPropagation();this._checkTemplateStatus()})));this.own(l(b,"click",n.hitch(this,
function(b){this.categoryManager.removeCategoryFromDisplay(a);f.destroy(c);d.forEach(a.displayFields,function(a){var c=this.configTree.findNode(a.fieldPath);c&&(c.setTemplateField(a.fieldJson),c.toRightDiv&&r.set(c.toRightDiv,"display","block"))},this);a.displayFields=[];b.stopPropagation();this._checkTemplateStatus()})));this.own(l(p,"click",n.hitch(this,function(){"block"===r.get(e,"display")?(r.set(e,"display","none"),s.set(k,"src",this.arrowImgSrc)):(r.set(e,"display","block"),s.set(k,"src","builder/css/images/v.png"));
this._changeHeighlightCategoryHead(a.name)})));this.drawFields(a,c,e);r.set(e,"display","none")},drawFields:function(a,c,b){d.forEach(a.displayFields,function(e){this.drawField(a,c,b,e)},this)},addWidgetConfigToConfigTree:function(a){var c=new v,b=a.search(/widgets\[[0-9]+\]/),e=a.slice(b,a.length).indexOf("]"),b=a.slice(0,b+e+1);a=b+"_config";var b=this.configTree.findNode(b),d=this.configTree.findNode(a);a=this.fullAppConfig.getConfigElementById(b.jsonObject.id);H.getInstance().tryLoadWidgetConfig(a).then(n.hitch(this,
function(a){if(a){var b;d.jsonObject=a;a.geocoder&&a.geocoder.geocoders&&delete a.geocoder.geocoders;for(b in a)a.hasOwnProperty(b)&&(b=d.addChild(a[b],b,d.absolutePath,d.level),this.drawTree(b,d.subLineDomNode))}c.resolve()}));return c},drawField:function(a,e,p,g){var h,k,m,q,z,A,y,v;this.configTree.findNode(g.fieldPath);v=B.getDefaultTemplateField(g.fieldPath,g.fieldJson.type,g.fieldJson.label);for(h in g.fieldJson)g.fieldJson.hasOwnProperty(h)&&(v[h]=g.fieldJson[h]);h=f.create("div",{"class":"field-div",
fieldDiv:g.fieldPath},p);this.own(l(h,"click",n.hitch(this,function(a,c){function e(){d=this.configTree.findNode(h);f=b.position(this.treePart).y;p=b.position(d.lineDomNode).y;g=p-f;(0>g||g>r.get(this.categoryPart,"height"))&&d.lineDomNode.scrollIntoView(!1);this._changeHeighlightFieldDomNode(h);this._changeHeighlightTreeDomNode(d.lineDomNode);this._changeHeighlightCategoryHead(c.name)}var d,f,p,g,h=a.fieldPath;if(d=this.configTree.findNode(h)){for(;d;)r.set(d.subLineDomNode,"display","block"),d=
d.parentNode;n.hitch(this,e)()}else this.addWidgetConfigToConfigTree(h).then(n.hitch(this,function(){for(d=this.configTree.findNode(h);d;)r.set(d.subLineDomNode,"display","block"),d=d.parentNode;n.hitch(this,e)()}))},g,a)));a=f.create("div",{"class":"field-head-div"},h);f.create("span",{"class":"field-head-title-div",innerHTML:n.hitch(this,function(a){var c="",b=a.split("_"),e=n.clone(b);d.forEach(b,function(a,c){var d,f="";if(-1!==a.search(/widgets\[[0-9]+\]$/)||-1!==a.search(/groups\[[0-9]+\]$/)){for(d=
0;d<=c;d++)f+=b[d]+"_";d=this.configTree.findNode(f.slice(0,-1));e[c]=d.label}},this);for(a=1;a<e.length;a++)c+=e[a]+"_";return c.slice(0,-1)})(g.fieldPath)},a);m=f.create("div",{"class":"field-fold-div jimu-float-leading"},a);q=f.create("img",{"class":"field-fold-img",src:this.arrowImgSrc,alt:"img"},m);m=f.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'builder/css/images/delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},a);A=f.create("div",
{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'builder/css/images/movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},a);z=f.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'builder/css/images/moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},a);var u=f.create("div",{"class":"field-fixed-content-div",style:"display:none;"},h);f.create("span",{"class":"field-label-span",innerHTML:this.nls.fieldLabel},
u);k=f.create("input",{"class":"jimu-input field-label-input",type:"text",value:v.label},u);this.own(l(k,"change",n.hitch(this,function(a,c){this._onFieldChange(a,{key:"label",value:c.value})},g.fieldPath,k)));f.create("span",{"class":"field-type-span",innerHTML:this.nls.fieldType},u);k=(new c({name:"selectFieldType","class":"field-type-select",options:[{label:"string",value:"string"},{label:"boolean",value:"boolean"},{label:"number",value:"number"},{label:"options",value:"options"}],value:v.type})).placeAt(u);
y=f.create("div",{"class":"field-content-div",style:"display:none;"},h);this.drawFieldContent(g.fieldPath,v,y,k.getValue());this.own(l(k,"change",n.hitch(this,function(a,c,b,e){this.drawFieldContent(a,c,b,e);this._onFieldChange(a,{key:"type",value:e});r.set(b,"display","block")},g.fieldPath,v,y)));this.own(l(a,"click",n.hitch(this,function(){"block"===r.get(y,"display")?(r.set(y,"display","none"),r.set(u,"display","none"),s.set(q,"src",this.arrowImgSrc)):(r.set(y,"display","block"),r.set(u,"display",
"block"),s.set(q,"src","builder/css/images/v.png"))})));this.own(l(m,"click",n.hitch(this,function(a,c,b,e){var d=a.fieldPath,p=this.configTree.findNode(d);p?(p.setTemplateField(a.fieldJson),p.toRightDiv&&r.set(p.toRightDiv,"display","block")):this.addWidgetConfigToConfigTree(d).then(n.hitch(this,function(){var c=this.configTree.findNode(d);a.fieldJson&&c.setTemplateField(a.fieldJson)}));p=this.categoryManager.getCategoryByField(d);p.removeFieldFromDisplay(d);f.destroy(c);p.displayIsEmpty()&&(this.categoryManager.removeCategoryFromDisplay(p),
f.destroy(b));e.stopPropagation();this._checkTemplateStatus()},g,h,e)));this.own(l(z,"click",n.hitch(this,function(a,c,b){var d=this.categoryManager.getCategoryByField(a);d.moveup(a)&&(f.empty(c),this.drawFields(d,e,c),this._changeHeighlightFieldDomNode(a));b.stopPropagation();this._checkTemplateStatus()},g.fieldPath,p)));this.own(l(A,"click",n.hitch(this,function(a,c,b){var d=this.categoryManager.getCategoryByField(a);d.movedown(a)&&(f.empty(c),this.drawFields(d,e,c),this._changeHeighlightFieldDomNode(a));
b.stopPropagation();this._checkTemplateStatus()},g.fieldPath,p)))},drawFieldContent:function(a,b,e,p){var g,h,k,m;f.empty(e);f.create("span",{"class":"field-tooltip-span",innerHTML:this.nls.tooltip},e);g=f.create("input",{"class":"jimu-input field-tooltip-input",type:"text",value:b.tooltip},e);this.own(l(g,"change",n.hitch(this,function(a,c){this._onFieldChange(a,{key:"tooltip",value:c.value})},a,g)));f.create("br",{},e);"string"===p?(f.create("span",{"class":"field-string-ph-span",innerHTML:this.nls.placeholder},
e),p=f.create("input",{"class":"jimu-input field-string-ph-input",type:"text",value:b.placeHolder},e),this.own(l(p,"change",n.hitch(this,function(a,c){this._onFieldChange(a,{key:"placeHolder",value:c.value})},a,p))),p=f.create("div",{"class":"field-text-type-div"},e),f.create("span",{"class":"field-text-type-span",innerHTML:this.nls.textBoxType},p),b=(new c({name:"stringOptions","class":"field-string-options",options:[{label:"richtext",value:"richtext"},{label:"textarea",value:"textarea"},{label:"textbox",
value:"textbox"}],value:b.stringFieldOption})).placeAt(p),this.own(l(b,"change",n.hitch(this,function(a,c){this._onFieldChange(a,{key:"stringFieldOption",value:c})},a)))):"number"===p?(f.create("span",{"class":"field-num-min-span",innerHTML:this.nls.minvalue},e),h=f.create("input",{"class":"jimu-input field-num-input field-num-min-input",type:"text",value:b.constraints.min},e),f.create("br",{},e),f.create("span",{"class":"field-num-max-span",innerHTML:this.nls.maxvalue},e),k=f.create("input",{"class":"jimu-input field-num-input field-num-max-input",
type:"text",value:b.constraints.max},e),f.create("br",{},e),f.create("span",{"class":"field-num-places-span",innerHTML:this.nls.places},e),m=f.create("input",{"class":"jimu-input field-num-input field-num-places-input",type:"text",value:b.constraints.places},e),this.own(l(h,"change",n.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,max:k.value,places:m.value}})},a))),this.own(l(k,"change",n.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,
max:k.value,places:m.value}})},a))),this.own(l(m,"change",n.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,max:k.value,places:m.value}})},a)))):"options"===p&&(p=f.create("div",{"class":"field-options-add-div"},e),g=f.create("div",{"class":"field-options-add-content"},p),f.create("div",{"class":"field-options-add-img-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'builder/css/images/add_link.png' alt\x3d'img'\x3e\x3c/img\x3e"},g),f.create("div",{"class":"field-options-add-text-div jimu-float-leading",
innerHTML:this.nls.addNewOption},g),d.forEach(b.options,function(c){this._onFieldOptionsAdd(a,e,c.label,c.value)},this),this.own(l(p,"click",n.hitch(this,this._onFieldOptionsAdd,a,e,"",""))))},_changeHeighlightFieldDomNode:function(a){w(".field-div",this.categoryPart).removeClass("field-heighlight-div");u.add(w('div[fieldDiv\x3d"'+a+'"]',this.categoryPart)[0],"field-heighlight-div")},_changeHeighlightTreeDomNode:function(a){this.heighlightTreeDomNode&&u.remove(this.heighlightTreeDomNode,"tree-node-heighlight-div");
u.add(a,"tree-node-heighlight-div");this.heighlightTreeDomNode=a},_changeHeighlightCategoryHead:function(a){w(".category-head-div",this.categoryPart).removeClass("category-head-div-selected");a=w("div[categoryHeadDiv\x3d'"+a+"']",this.categoryPart)[0];b.addClass(a,"category-head-div-selected")},_onToRightDiv:function(a,c,e){var d,f,p=this.categoryManager.getCategoryByField(a.absolutePath);d=this.categoryManager.findDisplayCategory(p.name);f={fieldPath:a.absolutePath,fieldJson:a.getTemplateField()};
if(-1===d){if("add"!==c)return;this.categoryManager.addCategoryToDisplay(p);p.addFieldToDisplay(f);this.drawCategory(p);d=w("div[fieldsDiv\x3d'"+p.name+"']",this.categoryPart)[0]}else if(-1===p.findFieldFromDisplay(a.absolutePath)){if("add"!==c)return;p.addFieldToDisplay(f);c=w("div[categoryDiv\x3d'"+p.name+"']",this.categoryPart)[0];d=w("div[fieldsDiv\x3d'"+p.name+"']",this.categoryPart)[0];this.drawField(p,c,d,f)}else d=w("div[fieldsDiv\x3d'"+p.name+"']",this.categoryPart)[0];r.set(d,"display",
"block");f=w('div[fieldDiv\x3d"'+a.absolutePath+'"]',this.categoryPart)[0];this._changeHeighlightCategoryHead(p.name);this._changeHeighlightFieldDomNode(a.absolutePath);this._changeHeighlightTreeDomNode(e);a=b.position(this.categoryPart).y;a=b.position(f).y-a;(0>a||a>r.get(this.categoryPart,"height"))&&f.scrollIntoView(!1)},_onFieldChange:function(a,c){var b=this.configTree.findNode(a),e=this.categoryManager.getCategoryByField(a).getDisplayField(a);e.fieldJson[c.key]=c.value;b.templateField=e.fieldJson;
this._checkTemplateStatus()},_onFieldOptionsAdd:function(a,c,b,e){var d=f.create("div",{"class":"field-options-div"},c);f.create("div",{"class":"field-options-label-div jimu-float-leading",innerHTML:this.nls.label},d);b=f.create("input",{"class":"jimu-input field-options-label-input jimu-float-leading",type:"text",value:b},d);this.own(l(b,"change",n.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(c)})},a)));f.create("div",{"class":"field-options-value-div jimu-float-leading",
innerHTML:this.nls.value},d);e=f.create("input",{"class":"jimu-input field-options-value-input jimu-float-leading",type:"text",value:e},d);this.own(l(e,"change",n.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(c)})},a)));e=f.create("div",{"class":"field-options-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'builder/css/images/delete_search.png' alt\x3d'img'\x3e\x3c/img\x3e"},d);this.own(l(e,"click",n.hitch(this,function(a){f.destroy(d);this._onFieldChange(a,
{key:"options",value:this._getFieldOptions(c)})},a)))},_getFieldOptions:function(a){var c=[];w(".field-options-div",a).forEach(n.hitch(this,function(a){c.push({label:w(".field-options-label-input",a).attr("value")[0],value:w(".field-options-value-input",a).attr("value")[0]})}));return c},_onReviewJsonDivClick:function(){var a=this.categoryManager.getTemplateJson();this.showJsonWidget.setConfig(a);s.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead2);r.set(this.showJsonDiv,"display","block");
r.set(this.reviewJsonDiv,"display","none");r.set(this.reviewJsonBackDiv,"display","block")},_onReviewJsonBackDivClick:function(){s.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead);r.set(this.reviewJsonDiv,"display","block");r.set(this.reviewJsonBackDiv,"display","none");r.set(this.showJsonDiv,"display","none")},_saveAgolTemplate:function(a){var c=new v,b=x.stringify(this.categoryManager.getTemplateJson("fullJson")),e={itemId:a?a:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:
null,json:b};F.saveAgolTemplate(this.app,e).then(n.hitch(this,function(){this.app.agolTemplateInfo=e;this.lastTemplateJson=this.categoryManager.getTemplateJson();c.resolve()}),function(a){new E({message:a});c.reject()});return c},_onDownloadNodeClick:function(){},_onExportClick:function(){var a=x.stringify(this.categoryManager.getTemplateJson());this.app.agolTemplateInfo&&this.app.agolTemplateInfo.itemId?this._updateAgolTemplate(a):this._exportAgolTemplate(a)},_updateAgolTemplate:function(a){var c=
new v,b=!G.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson());this.loading.show(this.nls.updating);b?this._saveAgolTemplate().then(n.hitch(this,function(){this._disablePopupButton(1,this.nls.saved);c.resolve()})):c.resolve();c.then(n.hitch(this,function(){M.getPortal(window.portalUrl).getUser().then(n.hitch(this,function(c){c.updateItem(this.app.agolTemplateInfo.itemId,{text:a}).then(n.hitch(this,function(){this.loading.hide();L._exportedMessage({itemId:this.app.agolTemplateInfo.itemId,
message:builderNls.apps.exportSuccessfulUpdate},builderNls.apps.exportMessageTitleUpdate)}),n.hitch(this,function(a){this.loading.hide();console.error(a.message||a);L._exportedMessage({itemId:null,message:builderNls.apps.exportTemplateFailed7},builderNls.apps.exportMessageTitleUpdate)}))}),n.hitch(this,function(a){this.loading.hide();console.error(a.message||a);L._exportedMessage({itemId:null,message:builderNls.apps.exportTemplateFailed6},builderNls.apps.exportMessageTitleUpdate)}))}))},_exportAgolTemplate:function(a){var c=
"";window.isXT?c="http://"+window.location.host+path+"apps/"+this.app.id:(c=J.getStandardPortalUrl(window.portalUrl),c=J.setProtocol(c,"http:"),c=c+"/apps/webappviewer/index.html?id\x3d"+this.app.id);a=new C({_templateUrl:c,_temlateJson:a});new I({content:a,container:"main-page",titleLabel:this.nls.title2,width:669,autoHeight:!0,buttons:[{label:builderNls.common.ok,key:e.ENTER,onClick:n.hitch(a,a.onNextClick,n.hitch(this,this._afterAddItemOfExportCallback))},{label:builderNls.common.cancel,key:e.ESCAPE,
onClick:n.hitch(a,a._onCancelClick)}]});a.startup()},_afterAddItemOfExportCallback:function(a){this._saveAgolTemplate(a).then(n.hitch(this,function(){this._disablePopupButton(1,this.nls.saved);b.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.update)}))},_onSaveClick:function(){b.setAttr(this.popup.enabledButtons[1],"innerHTML",this.nls.saving);this._saveAgolTemplate().then(n.hitch(this,function(){this._disablePopupButton(1,this.nls.saved)}))},_onCancelClick:function(){if(G.isEqual(this.lastTemplateJson,
this.categoryManager.getTemplateJson()))this._closePopup(),this.destroyRecursive();else var a=new I({content:"\x3cdiv\x3e\x3cimg class\x3d'alert-image jimu-float-leading'src\x3d'builder/css/images/alert.png' style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+this.nls.unSaveMeg+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.cancelPopupTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.save,onClick:n.hitch(this,function(){this._saveAgolTemplate().then(n.hitch(this,
function(){a.close();this._closePopup();this.destroyRecursive()}))})},{label:this.nls.doNotSave,onClick:n.hitch(this,function(){a.close();this._closePopup();this.destroyRecursive()})},{label:this.nls.cancel,onClick:n.hitch(this,function(){a.close()})}]})},_closePopup:function(){this.popup&&(this.popup.closeTemplate=!0,this.popup.close())},_checkTemplateStatus:function(){G.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson())||this._enablePopupButton(1,this.nls.save)},_disablePopupButton:function(a,
c){this.popup.disableButton(a);b.setAttr(this.popup.disabledButtons[a],"innerHTML",c)},_enablePopupButton:function(a,c){this.popup.enableButton(a);b.setAttr(this.popup.enabledButtons[a],"innerHTML",c)},_initPopup:function(){this.app.agolTemplateInfo&&this.app.agolTemplateInfo.itemId&&M.getPortal(window.portalUrl).getItemById(this.app.agolTemplateInfo.itemId).then(n.hitch(this,function(){b.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.update)}),n.hitch(this,function(){this.app.agolTemplateInfo.itemId=
null;b.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.download)}));this.popup.disableButton(1);this.popup.onClose=n.hitch(this,function(){if(this.popup.closeTemplate)return!0;this._onCancelClick();return!1})},initWork:function(){this.lastTemplateJson=this.categoryManager.getTemplateJson();this._initPopup();this.loading=new K({hidden:!0});this.loading.placeAt(this.popup.domNode);this.loading.startup()}})})},"builder/AGOLTemplate/ConfigNode":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/_base/array"],function(t,d,b){var g={},k=t([],{id:null,parentNode:null,keyString:null,absolutePath:null,childs:null,nodeType:null,templateField:null,jsonObject:null,level:null,label:null,isVisible:!1,constructor:function(b,g,l,k,n){var f;this.parentNode=g;this.keyString=l;this.childs=[];this.absolutePath=""===k?l:k+"_"+l;this.jsonObject=b;this.level=n;this.initId();this.initLabel();this.initTemplateField(b);if("object"!==typeof b||null===b)this.nodeType="leaf";else if(d.isArrayLike(b)){this.nodeType=
"array";for(g=0;g<b.length;g++)this.addChild(b[g],this.keyString+"["+g+"]",k,n)}else for(f in this.nodeType="normal",b)b.hasOwnProperty(f)&&"function"!==typeof b[f]&&this.addChild(b[f],f,this.absolutePath,n)},initId:function(){var b,g;b=this.absolutePath.search(/_widgets\[[0-9]+\]/);g=this.absolutePath.search(/_groups\[[0-9]+\]/);-1!==b||-1!==g?-1!==this.absolutePath.search(/_widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/_groups\[[0-9]+\]$/)?this.id=this.parentNode.id+"["+this.jsonObject.id+
"]":d.isArrayLike(this.parentNode.jsonObject)?this.id=this.parentNode.parentNode.id+"_"+this.keyString:this.id=this.parentNode.id+"_"+this.keyString:this.id=this.absolutePath},initLabel:function(){this.label=this.keyString;if(-1!==this.absolutePath.search(/widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/groups\[[0-9]+\]$/))this.label=this.jsonObject.label},initTemplateField:function(b){this.templateField=k.getDefaultTemplateField(this.absolutePath,typeof b,this.label);k.setDefaultValue(this.absolutePath,
b,this.id)},getTemplateFieldDefaultValue:function(){return this.templateField.defaultValue},getTemplateField:function(){var b={type:this.templateField.type,fieldName:this.id,label:this.templateField.label,tooltip:this.templateField.tooltip};"leaf"!==this.nodeType&&(b.fieldName+="--");switch(b.type){case "string":b.stringFieldOption=this.templateField.stringFieldOption;b.placeHolder=this.templateField.placeHolder;break;case "number":b.constraints=this.templateField.constraints;break;case "options":b.options=
this.templateField.options}b.id=this.id;b.fieldPath=this.absolutePath;return b},setTemplateField:function(b){this.templateField.type=b.type;this.templateField.label=b.label;this.templateField.tooltip=b.tooltip;"leaf"!==this.nodeType&&(this.templateField.fieldName=this.templateField.fieldName.slice(0,this.templateField.fieldName.length-2));switch(this.templateField.type){case "string":this.templateField.stringFieldOption=b.stringFieldOption;this.templateField.placeHolder=b.placeHolder;break;case "number":this.templateField.constraints=
b.constraints;break;case "options":this.templateField.options=b.options}return b},addChild:function(b,d,g,m){b=new k(b,this,d,g,m+1);this.childs.push(b);return b},isLeaf:function(){var b=!1;this.childs&&0<this.childs.length&&(b=!0);return b},findNode:function(b){var d=[],g,k,n;b.split("_").forEach(function(b){var g=b.search(/\[[0-9]+\]/);-1!==g&&d.push(b.slice(0,g));d.push(b)});k=this;if(k.keyString!==d[0])return null;for(b=1;b<d.length;b++){n=k.childs.length;for(g=0;g<n;g++)if(k.childs[g].keyString===
d[b]){k=k.childs[g];break}if(g===n)return null}return k},setVisible:function(){for(var b=this;b;)b.isVisible=!0,b=b.parentNode},findNodeById:function(b){var d=null;this.traversal(function(g){if(g.id===b)return d=g,!0});return d},traversal:function(b){if(b(this))return!0;for(var d=0;d<this.childs.length;d++)if(this.childs[d].traversal(b))return!0},deserialize:function(d){d&&b.forEach(d.configurationSettings,function(d){b.forEach(d.fields,function(b){this.findNode(b.fieldName).setTemplateField(b)},
this)},this)}});k.getDefaultValue=function(b){return g[b]};k.setDefaultValue=function(b,d,k){var m=null,m=d;"app_portalUrl"===b||"app_map_itemId"===b?m=null:"app_title"===b?m="":"app_subtitle"===b?m="":"object"===typeof d&&(m=!1);g[k]=m};k.defaultValueExisted=function(b){return void 0===g[b]?!1:!0};k.getDefaultTemplateField=function(b,d,g){b="string";switch(d){case "number":b="number";break;case "boolean":b="boolean";break;case "object":b="boolean",g="disable"}return{type:b,label:g,tooltip:"",stringFieldOption:"textbox",
placeHolder:g,constraints:{min:0,max:100,places:0},options:[{label:"label1",value:"value1"},{label:"label2",value:"value2"}]}};return k})},"builder/AGOLTemplate/Category":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(t,d,b){return t([],{name:null,title:null,includeFields:null,excludeFields:null,displayFields:null,constructor:function(d,k,h,q,l,m){this.name=k;this.title=h;this.includeFields=q;this.excludeFields=l;this.displayFields=[];b.forEach(m,function(b){var f=
d.findNode(b);f&&this.displayFields.push({fieldPath:b,fieldJson:f.getTemplateField()})},this)},hasField:function(b){var d=!1,h;for(h=0;h<this.includeFields.length;h++)if(0===b.indexOf(this.includeFields[h])){d=!0;break}for(h=0;h<this.excludeFields.length;h++)if(0===b.indexOf(this.excludeFields[h])){d=!1;break}return d},getDisplayField:function(b){b=this.findFieldFromDisplay(b);return-1!==b?this.displayFields[b]:null},findFieldFromDisplay:function(b){var d;for(d=0;d<this.displayFields.length;d++)if(this.displayFields[d].fieldPath===
b)return d;return-1},addFieldToDisplay:function(b){var d;d=this.findFieldFromDisplay(b.fieldPath);-1===d?this.displayFields.push({fieldPath:b.fieldPath,fieldJson:b.fieldJson}):this.displayFields[d].fieldJson=b.fieldJson},removeFieldFromDisplay:function(b){var d;d=this.findFieldFromDisplay(b);0<=d&&this.displayFields.splice(d,1);return b},moveup:function(b){var d;b=this.findFieldFromDisplay(b);return 0<b?(d=this.displayFields[b],this.displayFields[b]=this.displayFields[b-1],this.displayFields[b-1]=
d,!0):!1},movedown:function(b){var d;b=this.findFieldFromDisplay(b);return 0<=b&&b<this.displayFields.length-1?(d=this.displayFields[b],this.displayFields[b]=this.displayFields[b+1],this.displayFields[b+1]=d,!0):!1},displayIsEmpty:function(){return 0===this.displayFields.length},deserialize:function(d,k){this.displayFields=[];b.forEach(d,function(b){var d;if(d=k.findNodeById(b.id))d=d.absolutePath+"",b.fieldPath=d,this.displayFields.push({fieldPath:d,fieldJson:b})},this);return this.displayFields.length}})})},
"builder/AGOLTemplate/CategoryManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/request dojo/Deferred dojo/promise/all dojo/json ./ConfigNode ./Category".split(" "),function(t,d,b,g,k,h,q,l,m){return t([],{categorys:null,displayCategorys:null,constructor:function(b,d,g){g=g&&g.json?g.json:null;this.categorys=[];this.displayCategorys=[];this.initCategorys(d,b);this.deserialize(g,b)},initCategorys:function(d,f){var g=new m(f,"Attribute","Attribute",["app_title","app_subtitle",
"app_logo","app_links"],[],["app_title","app_subtitle"]);this.categorys.push(g);b.forEach(d.widgetOnScreen.widgets,function(b,d){var g="ScreenWidget_"+b.id,n="app_widgetOnScreen_widgets["+d+"]",n=[n+"_label",n+"_visible",n+"_config"],h=[];b.uri&&this.categorys.push(new m(f,g,b.label+" widget",n,h))},this);b.forEach(d.widgetOnScreen.groups,function(d,g){var n="ScreenWidgetGroup_"+d.id,h="app_widgetOnScreen_groups["+g+"]",l=[h+"_label",h+"_visible"];b.forEach(d.widgets,function(b,a){l.push(h+"_widgets["+
a+"]_label");l.push(h+"_widgets["+a+"]_visible");l.push(h+"_widgets["+a+"]_config")});this.categorys.push(new m(f,n,d.label,l,[]))},this);b.forEach(d.widgetPool.widgets,function(b,d){var g="widgetPoolWidget_"+b.id,n="app_widgetPool_widgets["+d+"]",n=[n+"_label",n+"_visible",n+"_config"],h=[];b.uri&&this.categorys.push(new m(f,g,b.label+" widget",n,h))},this);b.forEach(d.widgetPool.groups,function(d,g){var n="widgetPoolGroup_"+d.id,h="app_widgetPool_groups["+g+"]",l=[h+"_label",h+"_visible"];b.forEach(d.widgets,
function(b,a){l.push(h+"_widgets["+a+"]_label");l.push(h+"_widgets["+a+"]_visible");l.push(h+"_widgets["+a+"]_config")});this.categorys.push(new m(f,n,d.label,l,[]))},this);this.displayCategorys.push(g)},getCategoryByName:function(b){return this.categorys[this.findCategory(b)]},getCategoryByField:function(b){var d;for(d=0;d<this.categorys.length;d++)if(this.categorys[d].hasField(b))return this.categorys[d];return null},findCategory:function(b){return this._find(b,this.categorys)},findDisplayCategory:function(b){return this._find(b,
this.displayCategorys)},_find:function(b,d){var g;for(g=0;g<d.length&&d[g].name!==b;g++);return g===d.length?-1:g},addCategoryToDisplay:function(b){-1===this.findDisplayCategory(b.name)&&this.displayCategorys.push(b)},removeCategoryFromDisplay:function(b){b=this.findDisplayCategory(b.name);0<=b&&this.displayCategorys.splice(b,1)},moveup:function(b){var d;b=this.findDisplayCategory(b.name);return 0<b?(d=this.displayCategorys[b],this.displayCategorys[b]=this.displayCategorys[b-1],this.displayCategorys[b-
1]=d,!0):!1},movedown:function(b){var d;b=this.findDisplayCategory(b.name);return 0<=b&&b<this.displayCategorys.length-1?(d=this.displayCategorys[b],this.displayCategorys[b]=this.displayCategorys[b+1],this.displayCategorys[b+1]=d,!0):!1},getTemplateJson:function(g){var f={configurationSettings:[],values:{}};b.forEach(this.displayCategorys,function(h,k){var m={category:h.title,fields:[]};"fullJson"===g&&(m.categoryName=h.name);b.forEach(h.displayFields,function(b,h){var k=d.clone(b.fieldJson);if(!g||
"fullJson"!==g)delete k.id,delete k.fieldPath;m.fields[h]=k;f.values[k.fieldName]=l.getDefaultValue(b.fieldJson.fieldName)},this);f.configurationSettings[k]=m},this);return f},deserialize:function(d,f){if(d){b.forEach(this.displayCategorys,function(b){b.displayFields=[]});this.displayCategorys=[];d=q.parse(d);b.forEach(d.configurationSettings,function(b){var d=this.getCategoryByName(b.categoryName),g=0;d&&(g=d.deserialize(b.fields,f),0<g&&this.displayCategorys.push(d))},this);var g,h=d.values;for(g in h)h.hasOwnProperty(g)&&
("function"!==typeof h[g]&&!l.defaultValueExisted(g))&&l.setDefaultValue(null,h[g],g)}}})})},"builder/AGOLTemplate/ShowJsonCodePage":function(){define(["dojo/_base/declare","dijit/_WidgetBase","builder/config/JSONEditor"],function(t,d,b){return t([d],{baseClass:"show-json-code-div",postCreate:function(){this.inherited(arguments);this.jsonEditor=new b({json:this.config});this.jsonEditor.placeAt(this.domNode)},setConfig:function(b){return this.jsonEditor.setJSON(b)},getConfig:function(){return this.jsonEditor.getJSON()}})})},
"builder/AGOLTemplate/Export":function(){define("dojo/_base/declare dojo/_base/lang dijit/dijit dijit/_WidgetBase dijit/_TemplatedMixin dojo/Deferred dojo/promise/all dojo/dom-style dojo/dom-attr jimu/dijit/Message jimu/dijit/LoadingShelter jimu/portalUrlUtils builder/portalUtils builder/CreateAppNew jimu/dijit/Popup ./ExportMessage".split(" "),function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w){return t([s],{_templateUrl:null,_temlateJson:null,_initDlgPage:function(){this.appTitle.focus();l.set(this.templateTitle,
"display","block");window.isXT&&(m.set(this.explain1,"innerHTML",this.nls.explain1),l.set(this.explain1,"display","block"));l.set(this.div2dAnd3d,"display","none");l.set(this.sharingTr,"display","none");u.getPortal(window.portalUrl).getUser().then(d.hitch(this,function(f){this.user=f;this._initFolder(f);var e=this.getDefaultAppInfo();b.byId("publish-webmap-tags").loadTags(f).then(d.hitch(this,function(){this._setDlgProperties(e)}))}),d.hitch(this,function(b){l.set(this.tagsTr,"display","none");l.set(this.folderTr,
"display","none");this._setDlgProperties(this.getDefaultAppInfo());console.error(b.message)}))},getDefaultAppInfo:function(){return{name:"",description:this.nls.templateDefaultSnippet,tags:["template"],folderId:"",sharing:!1,is3D:"false",webmap:null,createFromId:null,creator:null}},onNextClick:function(b){var e=this._getDlgProperties();if(e.name&&e.tags){var a=new f;a.placeAt(this.popup.domNode);a.startup();this.exportTemplate(e,this._templateUrl,this._temlateJson,b).then(d.hitch(this,function(b){this._closePopup();
this.destroy();a.destroy();w._exportedMessage(b,this.nls.exportMessageTitle)}),d.hitch(this,function(b){this._closePopup();this.destroy();a.destroy();w._exportedMessage(b,this.nls.exportMessageTitle)}))}else new n({message:this.nls.noTitleMessage})},exportTemplate:function(b,e,a,c){var f=new h,g=new h,l=new h,n=new h,k="http://"+window.location.host+window.location.pathname,m=k.indexOf("index.html");-1!==m&&(k=k.slice(0,m));k+="builder/css/images/templateThumbnail.jpg";u.getPortal(window.portalUrl).getUser().then(function(a){g.resolve(a)},
function(a){g.reject(a);console.error(a.message||a);f.reject({itemId:null,message:this.nls.exportTemplateFailed5})});g.then(d.hitch(this,function(d){var g={title:b.name,snippet:b.description,tags:b.tags,url:e,thumbnailurl:k,type:"Web Mapping Application",typeKeywords:"Configurable, JavaScript",text:a};b.folderId===d.username&&(b.folderId="");d.addItem(g,b.folderId).then(function(a){a.success?(l.resolve(a),c(a.id)):(console.error(a.message||""),l.reject(this.nls.exportTemplateFailed1))},function(a){l.reject(a);
console.error(a.message||a);f.reject({itemId:null,message:this.nls.exportTemplateFailed1})})}));u.getTemplatesGroup(window.portalUrl).then(d.hitch(this,function(a){n.resolve(a)}),function(a){n.reject(a);console.error(a.message||a);f.reject({itemId:null,message:this.nls.exportTemplateFailed2})});q({user:g,itemRes:l,templateGroup:n}).then(d.hitch(this,function(a){a.user.shareItem({groups:a.templateGroup.id},a.itemRes.id,b.folderId).then(d.hitch(this,function(b){-1===b.notSharedWith.indexOf(a.templateGroup.id)?
f.resolve({itemId:a.itemRes.id,message:this.nls.exportSuccessful}):f.reject({itemId:a.itemRes.id,message:this.nls.exportTemplateFailed3,type:"no_permission_to_share"})}),function(b){console.error(b.message||b);f.reject({itemId:a.itemRes.id,message:this.nls.exportTemplateFailed4})})}));return f}})})},"builder/AGOLTemplate/ExportMessage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/dom-style dojo/dom-attr dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ExportMessage.html jimu/portalUrlUtils jimu/dijit/Popup".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u){var s=t([m,n],{baseClass:"agol-template-export-message",templateString:f,postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.nls=d.mixin(this.nls,builderNls.apps)},constructor:function(b){this.exportedInfo=b},postCreate:function(){this.inherited(arguments);"no_permission_to_share"===this.exportedInfo.type?(g.setAttr(this.word1,"innerHTML",this.nls.exportTemplateFailed31),this.exportedInfo.itemUrl&&(g.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl21),
g.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl)),g.setAttr(this.word2,"innerHTML",this.nls.exportTemplateFailed32)):(this.exportedInfo.message&&g.setAttr(this.resMessage,"innerHTML",this.exportedInfo.message),this.exportedInfo.itemUrl&&(g.setAttr(this.word1,"innerHTML",this.nls.descriptionTemplateUrl1),g.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl2),g.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl),g.setAttr(this.word2,"innerHTML",this.nls.descriptionTemplateUrl3)))}});
s._exportedMessage=function(b,d){b.itemId&&(b.itemUrl=r.getItemDetailsPageUrl(window.portalUrl,b.itemId));var f=new s(b);new u({content:f,titleLabel:d,width:"600",autoHeight:!0,buttons:[{label:builderNls.common.ok}]})};return s})},"builder/AGOLTemplate/utils":function(){define("dojo/_base/lang dojo/Deferred jimu/utils jimu/dijit/Message jimu/WidgetManager dojo/promise/all dojo/json ../serviceUtils".split(" "),function(t,d,b,g,k,h,q,l){return{loadAllWidgetConfigs:function(b){var g=new d,f=[];b.visitElement(function(b){if(b.uri){var d=
k.getInstance().tryLoadWidgetConfig(b).then(function(d){d&&(b.config=d)});f.push(d)}});h(f).then(function(){g.resolve(b)},function(b){g.reject(b)});return g},saveAgolTemplate:function(b,h,f){var k=new d,q={itemId:f?f:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:null,json:h};l.saveAgolTemplate(this.app,q).then(t.hitch(this,function(){this.app.agolTemplateInfo=q;this.lastTemplateJson=this.categoryManager.getTemplateJson();k.resolve()}),function(b){new g({message:b});k.reject()});return k}}})},
"jimu/dijit/QRCode":function(){define(["dojo/_base/declare","dijit/_WidgetBase","libs/qrcode"],function(t,d){return t([d],{baseClass:"jimu-qrcode",declaredClass:"jimu.dijit.QRCode",postCreate:function(){new QRCode(this.domNode,{text:this.text,width:this.width||128,height:this.height||128,colorDark:this.colorDark||" #000000",colorLight:this.colorLight||"#ffffff",correctLevel:this.correctLevel||QRCode.CorrectLevel.L})}})})},"libs/qrcode":function(){define(["dojo","dijit","dojox"],function(t,d,b){var g;
(function(){function b(e){this.mode=f.MODE_8BIT_BYTE;this.data=e;this.parsedData=[];e=0;for(var a=this.data.length;e<a;e++){var c=[],d=this.data.charCodeAt(e);65536<d?(c[0]=240|(d&1835008)>>>18,c[1]=128|(d&258048)>>>12,c[2]=128|(d&4032)>>>6,c[3]=128|d&63):2048<d?(c[0]=224|(d&61440)>>>12,c[1]=128|(d&4032)>>>6,c[2]=128|d&63):128<d?(c[0]=192|(d&1984)>>>6,c[1]=128|d&63):c[0]=d;this.parsedData.push(c)}this.parsedData=Array.prototype.concat.apply([],this.parsedData);this.parsedData.length!=this.data.length&&
(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function d(b,a){this.typeNumber=b;this.errorCorrectLevel=a;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}function q(b,a){if(void 0==b.length)throw Error(b.length+"/"+a);for(var c=0;c<b.length&&0==b[c];)c++;this.num=Array(b.length-c+a);for(var d=0;d<b.length-c;d++)this.num[d]=b[d+c]}function l(b,a){this.totalCount=b;this.dataCount=a}function m(){this.buffer=[];this.length=0}function n(){var b=
!1,a=navigator.userAgent;/android/i.test(a)&&(b=!0,(aMat=a.toString().match(/android ([0-9]\.[0-9])/i))&&aMat[1]&&(b=parseFloat(aMat[1])));return b}b.prototype={getLength:function(b){return this.parsedData.length},write:function(b){for(var a=0,c=this.parsedData.length;a<c;a++)b.put(this.parsedData[a],8)}};d.prototype={addData:function(d){d=new b(d);this.dataList.push(d);this.dataCache=null},isDark:function(b,a){if(0>b||this.moduleCount<=b||0>a||this.moduleCount<=a)throw Error(b+","+a);return this.modules[b][a]},
getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(b,a){this.moduleCount=4*this.typeNumber+17;this.modules=Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=Array(this.moduleCount);for(var f=0;f<this.moduleCount;f++)this.modules[c][f]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();
this.setupTimingPattern();this.setupTypeInfo(b,a);7<=this.typeNumber&&this.setupTypeNumber(b);null==this.dataCache&&(this.dataCache=d.createData(this.typeNumber,this.errorCorrectLevel,this.dataList));this.mapData(this.dataCache,a)},setupPositionProbePattern:function(b,a){for(var c=-1;7>=c;c++)if(!(-1>=b+c||this.moduleCount<=b+c))for(var d=-1;7>=d;d++)-1>=a+d||this.moduleCount<=a+d||(this.modules[b+c][a+d]=0<=c&&6>=c&&(0==d||6==d)||0<=d&&6>=d&&(0==c||6==c)||2<=c&&4>=c&&2<=d&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var b=
0,a=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=u.getLostPoint(this);if(0==c||b>d)b=d,a=c}return a},createMovieClip:function(b,a,c){b=b.createEmptyMovieClip(a,c);this.make();for(a=0;a<this.modules.length;a++){c=1*a;for(var d=0;d<this.modules[a].length;d++){var f=1*d;this.modules[a][d]&&(b.beginFill(0,100),b.moveTo(f,c),b.lineTo(f+1,c),b.lineTo(f+1,c+1),b.lineTo(f,c+1),b.endFill())}}return b},setupTimingPattern:function(){for(var b=8;b<this.moduleCount-8;b++)null==this.modules[b][6]&&(this.modules[b][6]=
0==b%2);for(b=8;b<this.moduleCount-8;b++)null==this.modules[6][b]&&(this.modules[6][b]=0==b%2)},setupPositionAdjustPattern:function(){for(var b=u.getPatternPosition(this.typeNumber),a=0;a<b.length;a++)for(var c=0;c<b.length;c++){var d=b[a],f=b[c];if(null==this.modules[d][f])for(var g=-2;2>=g;g++)for(var h=-2;2>=h;h++)this.modules[d+g][f+h]=-2==g||2==g||-2==h||2==h||0==g&&0==h?!0:!1}},setupTypeNumber:function(b){for(var a=u.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!b&&1==(a>>c&1);this.modules[Math.floor(c/
3)][c%3+this.moduleCount-8-3]=d}for(c=0;18>c;c++)d=!b&&1==(a>>c&1),this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d},setupTypeInfo:function(b,a){for(var c=u.getBCHTypeInfo(this.errorCorrectLevel<<3|a),d=0;15>d;d++){var f=!b&&1==(c>>d&1);6>d?this.modules[d][8]=f:8>d?this.modules[d+1][8]=f:this.modules[this.moduleCount-15+d][8]=f}for(d=0;15>d;d++)f=!b&&1==(c>>d&1),8>d?this.modules[8][this.moduleCount-d-1]=f:9>d?this.modules[8][15-d-1+1]=f:this.modules[8][15-d-1]=f;this.modules[this.moduleCount-
8][8]=!b},mapData:function(b,a){for(var c=-1,d=this.moduleCount-1,f=7,g=0,h=this.moduleCount-1;0<h;h-=2)for(6==h&&h--;;){for(var l=0;2>l;l++)if(null==this.modules[d][h-l]){var k=!1;g<b.length&&(k=1==(b[g]>>>f&1));u.getMask(a,d,h-l)&&(k=!k);this.modules[d][h-l]=k;f--; -1==f&&(g++,f=7)}d+=c;if(0>d||this.moduleCount<=d){d-=c;c=-c;break}}}};d.PAD0=236;d.PAD1=17;d.createData=function(b,a,c){a=l.getRSBlocks(b,a);for(var f=new m,g=0;g<c.length;g++){var k=c[g];f.put(k.mode,4);f.put(k.getLength(),u.getLengthInBits(k.mode,
b));k.write(f)}for(g=b=0;g<a.length;g++)b+=a[g].dataCount;if(f.getLengthInBits()>8*b)throw Error("code length overflow. ("+f.getLengthInBits()+"\x3e"+8*b+")");for(f.getLengthInBits()+4<=8*b&&f.put(0,4);0!=f.getLengthInBits()%8;)f.putBit(!1);for(;!(f.getLengthInBits()>=8*b);){f.put(d.PAD0,8);if(f.getLengthInBits()>=8*b)break;f.put(d.PAD1,8)}return d.createBytes(f,a)};d.createBytes=function(b,a){for(var c=0,d=0,f=0,g=Array(a.length),h=Array(a.length),l=0;l<a.length;l++){var k=a[l].dataCount,n=a[l].totalCount-
k,d=Math.max(d,k),f=Math.max(f,n);g[l]=Array(k);for(var m=0;m<g[l].length;m++)g[l][m]=255&b.buffer[m+c];c+=k;m=u.getErrorCorrectPolynomial(n);k=(new q(g[l],m.getLength()-1)).mod(m);h[l]=Array(m.getLength()-1);for(m=0;m<h[l].length;m++)n=m+k.getLength()-h[l].length,h[l][m]=0<=n?k.get(n):0}for(m=l=0;m<a.length;m++)l+=a[m].totalCount;c=Array(l);for(m=k=0;m<d;m++)for(l=0;l<a.length;l++)m<g[l].length&&(c[k++]=g[l][m]);for(m=0;m<f;m++)for(l=0;l<a.length;l++)m<h[l].length&&(c[k++]=h[l][m]);return c};for(var f=
{MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},r={L:1,M:0,Q:3,H:2},u={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,
134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(b){for(var a=b<<10;0<=u.getBCHDigit(a)-u.getBCHDigit(u.G15);)a^=u.G15<<u.getBCHDigit(a)-u.getBCHDigit(u.G15);return(b<<10|a)^u.G15_MASK},getBCHTypeNumber:function(b){for(var a=b<<12;0<=u.getBCHDigit(a)-u.getBCHDigit(u.G18);)a^=
u.G18<<u.getBCHDigit(a)-u.getBCHDigit(u.G18);return b<<12|a},getBCHDigit:function(b){for(var a=0;0!=b;)a++,b>>>=1;return a},getPatternPosition:function(b){return u.PATTERN_POSITION_TABLE[b-1]},getMask:function(b,a,c){switch(b){case 0:return 0==(a+c)%2;case 1:return 0==a%2;case 2:return 0==c%3;case 3:return 0==(a+c)%3;case 4:return 0==(Math.floor(a/2)+Math.floor(c/3))%2;case 5:return 0==a*c%2+a*c%3;case 6:return 0==(a*c%2+a*c%3)%2;case 7:return 0==(a*c%3+(a+c)%2)%2;default:throw Error("bad maskPattern:"+
b);}},getErrorCorrectPolynomial:function(b){for(var a=new q([1],0),c=0;c<b;c++)a=a.multiply(new q([1,s.gexp(c)],0));return a},getLengthInBits:function(b,a){if(1<=a&&10>a)switch(b){case f.MODE_NUMBER:return 10;case f.MODE_ALPHA_NUM:return 9;case f.MODE_8BIT_BYTE:return 8;case f.MODE_KANJI:return 8;default:throw Error("mode:"+b);}else if(27>a)switch(b){case f.MODE_NUMBER:return 12;case f.MODE_ALPHA_NUM:return 11;case f.MODE_8BIT_BYTE:return 16;case f.MODE_KANJI:return 10;default:throw Error("mode:"+
b);}else if(41>a)switch(b){case f.MODE_NUMBER:return 14;case f.MODE_ALPHA_NUM:return 13;case f.MODE_8BIT_BYTE:return 16;case f.MODE_KANJI:return 12;default:throw Error("mode:"+b);}else throw Error("type:"+a);},getLostPoint:function(b){for(var a=b.getModuleCount(),c=0,d=0;d<a;d++)for(var f=0;f<a;f++){for(var g=0,h=b.isDark(d,f),l=-1;1>=l;l++)if(!(0>d+l||a<=d+l))for(var k=-1;1>=k;k++)0>f+k||a<=f+k||0==l&&0==k||h==b.isDark(d+l,f+k)&&g++;5<g&&(c+=3+g-5)}for(d=0;d<a-1;d++)for(f=0;f<a-1;f++)if(g=0,b.isDark(d,
f)&&g++,b.isDark(d+1,f)&&g++,b.isDark(d,f+1)&&g++,b.isDark(d+1,f+1)&&g++,0==g||4==g)c+=3;for(d=0;d<a;d++)for(f=0;f<a-6;f++)b.isDark(d,f)&&(!b.isDark(d,f+1)&&b.isDark(d,f+2)&&b.isDark(d,f+3)&&b.isDark(d,f+4)&&!b.isDark(d,f+5)&&b.isDark(d,f+6))&&(c+=40);for(f=0;f<a;f++)for(d=0;d<a-6;d++)b.isDark(d,f)&&(!b.isDark(d+1,f)&&b.isDark(d+2,f)&&b.isDark(d+3,f)&&b.isDark(d+4,f)&&!b.isDark(d+5,f)&&b.isDark(d+6,f))&&(c+=40);for(f=g=0;f<a;f++)for(d=0;d<a;d++)b.isDark(d,f)&&g++;b=Math.abs(100*g/a/a-50)/5;return c+
10*b}},s={glog:function(b){if(1>b)throw Error("glog("+b+")");return s.LOG_TABLE[b]},gexp:function(b){for(;0>b;)b+=255;for(;256<=b;)b-=255;return s.EXP_TABLE[b]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},t=0;8>t;t++)s.EXP_TABLE[t]=1<<t;for(t=8;256>t;t++)s.EXP_TABLE[t]=s.EXP_TABLE[t-4]^s.EXP_TABLE[t-5]^s.EXP_TABLE[t-6]^s.EXP_TABLE[t-8];for(t=0;255>t;t++)s.LOG_TABLE[s.EXP_TABLE[t]]=t;q.prototype={get:function(b){return this.num[b]},getLength:function(){return this.num.length},multiply:function(b){for(var a=
Array(this.getLength()+b.getLength()-1),c=0;c<this.getLength();c++)for(var d=0;d<b.getLength();d++)a[c+d]^=s.gexp(s.glog(this.get(c))+s.glog(b.get(d)));return new q(a,0)},mod:function(b){if(0>this.getLength()-b.getLength())return this;for(var a=s.glog(this.get(0))-s.glog(b.get(0)),c=Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(d=0;d<b.getLength();d++)c[d]^=s.gexp(s.glog(b.get(d))+a);return(new q(c,0)).mod(b)}};l.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,
44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],
[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,
69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,
17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,
146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,
14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];l.getRSBlocks=function(b,a){var c=l.getRsBlockTable(b,a);if(void 0==c)throw Error("bad rs block @ typeNumber:"+b+"/errorCorrectLevel:"+a);for(var d=c.length/3,f=[],g=0;g<d;g++)for(var h=c[3*g+0],k=c[3*g+
1],m=c[3*g+2],n=0;n<h;n++)f.push(new l(k,m));return f};l.getRsBlockTable=function(b,a){switch(a){case r.L:return l.RS_BLOCK_TABLE[4*(b-1)+0];case r.M:return l.RS_BLOCK_TABLE[4*(b-1)+1];case r.Q:return l.RS_BLOCK_TABLE[4*(b-1)+2];case r.H:return l.RS_BLOCK_TABLE[4*(b-1)+3]}};m.prototype={get:function(b){return 1==(this.buffer[Math.floor(b/8)]>>>7-b%8&1)},put:function(b,a){for(var c=0;c<a;c++)this.putBit(1==(b>>>a-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(b){var a=Math.floor(this.length/
8);this.buffer.length<=a&&this.buffer.push(0);b&&(this.buffer[a]|=128>>>this.length%8);this.length++}};var w=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,
911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],t=function(){var b=function(a,b){this._el=a;this._htOption=b};b.prototype.draw=function(a){function b(a,c){var d=document.createElementNS("http://www.w3.org/2000/svg",
a),e;for(e in c)c.hasOwnProperty(e)&&d.setAttribute(e,c[e]);return d}var d=this._htOption,e=this._el,f=a.getModuleCount();this.clear();var g=b("svg",{viewBox:"0 0 "+String(f)+" "+String(f),width:"100%",height:"100%",fill:d.colorLight});g.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");e.appendChild(g);g.appendChild(b("rect",{fill:d.colorDark,width:"1",height:"1",id:"template"}));for(d=0;d<f;d++)for(e=0;e<f;e++)if(a.isDark(d,e)){var h=b("use",{x:String(d),
y:String(e)});h.setAttributeNS("http://www.w3.org/1999/xlink","href","#template");g.appendChild(h)}};b.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};return b}(),v="svg"===document.documentElement.tagName.toLowerCase()?t:"undefined"==typeof CanvasRenderingContext2D?function(){var b=function(a,b){this._el=a;this._htOption=b};b.prototype.draw=function(a){for(var b=this._htOption,d=this._el,e=a.getModuleCount(),f=Math.floor(b.width/e),g=Math.floor(b.height/
e),h=['\x3ctable style\x3d"border:0;border-collapse:collapse;"\x3e'],l=0;l<e;l++){h.push("\x3ctr\x3e");for(var k=0;k<e;k++)h.push('\x3ctd style\x3d"border:0;border-collapse:collapse;padding:0;margin:0;width:'+f+"px;height:"+g+"px;background-color:"+(a.isDark(l,k)?b.colorDark:b.colorLight)+';"\x3e\x3c/td\x3e');h.push("\x3c/tr\x3e")}h.push("\x3c/table\x3e");d.innerHTML=h.join("");a=d.childNodes[0];d=(b.width-a.offsetWidth)/2;b=(b.height-a.offsetHeight)/2;0<d&&0<b&&(a.style.margin=b+"px "+d+"px")};b.prototype.clear=
function(){this._el.innerHTML=""};return b}():function(){function b(){this._elImage.src=this._elCanvas.toDataURL("image/png");this._elImage.style.display="block";this._elCanvas.style.display="none"}function a(a,b){var c=this;c._fFail=b;c._fSuccess=a;if(null===c._bSupportDataURI){var d=document.createElement("img"),e=function(){c._bSupportDataURI=!1;c._fFail&&_fFail.call(c)};d.onabort=e;d.onerror=e;d.onload=function(){c._bSupportDataURI=!0;c._fSuccess&&c._fSuccess.call(c)};d.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg\x3d\x3d"}else!0===
c._bSupportDataURI&&c._fSuccess?c._fSuccess.call(c):!1===c._bSupportDataURI&&c._fFail&&c._fFail.call(c)}if(this._android&&2.1>=this._android){var c=1/window.devicePixelRatio,d=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,e,f,g,h,l,k,n){if("nodeName"in a&&/img/i.test(a.nodeName))for(var m=arguments.length-1;1<=m;m--)arguments[m]*=c;else"undefined"==typeof k&&(arguments[1]*=c,arguments[2]*=c,arguments[3]*=c,arguments[4]*=c);d.apply(this,arguments)}}var f=
function(a,b){this._bIsPainted=!1;this._android=n();this._htOption=b;this._elCanvas=document.createElement("canvas");this._elCanvas.width=b.width;this._elCanvas.height=b.height;a.appendChild(this._elCanvas);this._el=a;this._oContext=this._elCanvas.getContext("2d");this._bIsPainted=!1;this._elImage=document.createElement("img");this._elImage.alt="Scan me!";this._elImage.style.display="none";this._el.appendChild(this._elImage);this._bSupportDataURI=null};f.prototype.draw=function(a){var b=this._elImage,
c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=d.width/e,g=d.height/e,h=Math.round(f),l=Math.round(g);b.style.display="none";this.clear();for(b=0;b<e;b++)for(var k=0;k<e;k++){var m=a.isDark(b,k),n=k*f,p=b*g;c.strokeStyle=m?d.colorDark:d.colorLight;c.lineWidth=1;c.fillStyle=m?d.colorDark:d.colorLight;c.fillRect(n,p,f,g);c.strokeRect(Math.floor(n)+0.5,Math.floor(p)+0.5,h,l);c.strokeRect(Math.ceil(n)-0.5,Math.ceil(p)-0.5,h,l)}this._bIsPainted=!0};f.prototype.makeImage=function(){this._bIsPainted&&
a.call(this,b)};f.prototype.isPainted=function(){return this._bIsPainted};f.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height);this._bIsPainted=!1};f.prototype.round=function(a){return!a?a:Math.floor(1E3*a)/1E3};return f}();g=function(b,a){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:r.H};"string"===typeof a&&(a={text:a});if(a)for(var c in a)this._htOption[c]=a[c];"string"==typeof b&&(b=document.getElementById(b));
this._android=n();this._el=b;this._oQRCode=null;this._oDrawing=new v(this._el,this._htOption);this._htOption.text&&this.makeCode(this._htOption.text)};g.prototype.makeCode=function(b){var a=this._htOption.correctLevel,c=1,f;f=encodeURI(b).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");f=f.length+(f.length!=b?3:0);for(var g=0,l=w.length;g<=l;g++){var k=0;switch(a){case r.L:k=w[g][0];break;case r.M:k=w[g][1];break;case r.Q:k=w[g][2];break;case r.H:k=w[g][3]}if(f<=k)break;else c++}if(c>w.length)throw Error("Too long data");
this._oQRCode=new d(c,this._htOption.correctLevel);this._oQRCode.addData(b);this._oQRCode.make();this._el.title=b;this._oDrawing.draw(this._oQRCode);this.makeImage()};g.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()};g.prototype.clear=function(){this._oDrawing.clear()};g.CorrectLevel=r;window.QRCode=g})()})},"dojox/main":function(){define(["dojo/_base/kernel"],function(t){return t.dojox})},"builder/Header":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Header.html dojo/on dojo/topic dojo/keys dojo/request dojo/request/script esri/request jimu/dijit/Popup jimu/dijit/Message builder/portalUtils jimu/portalUrlUtils builder/tokenUtils jimu/utils".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a){return t([k,h],{templateString:q,baseClass:"header",postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.nls=d.mixin(this.nls,builderNls.header);this.nls.backToHomePage=this.nls.backToHomePage||""},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this._isWebTier(window.portalUrl)&&(g.destroy(this.signOutItem),this.signOutItem=null);this.own(m.subscribe("disableWebTierUserSignOut"),d.hitch(this,
function(){g.destroy(this.signOutItem);this.signOutItem=null}));window.isXT?(g.destroy(this.homeSection),g.setStyle(this.logoTitle,"cursor","pointer"),this._bindXtEvents()):(g.addClass(this.homeLabel,"dropdown"),this._bindIntegratedEvents(window.portalUrl));var a=w.getPortal(window.portalUrl);a.haveSignIn()&&a.getUser().then(d.hitch(this,function(a){if(a=a&&a.username)this.userNameNode.innerHTML=a}),d.hitch(this,function(a){console.error(a)}))},_isWebTier:function(a){var f=esri.id.findServerInfo(a);
return f&&f.webTierAuth?!0:e.webTierPortalUrls&&0<e.webTierPortalUrls.length?b.some(e.webTierPortalUrls,d.hitch(this,function(b){v.isSamePortalUrl(a,b)})):!1},_bindXtEvents:function(){this.own(l(document.body,"click",d.hitch(this,function(a){a=a.target||a.srcElement;a!==this.userSection&&!g.isDescendant(a,this.userSection)&&g.setStyle(this.userMenu,"display","none")})));this.own(m.subscribe("iframeClick",d.hitch(this,function(){g.setStyle(this.userMenu,"display","none")})));this.own(m.subscribe("userSignOut",
d.hitch(this,function(){this.userNameNode.innerHTML=""})));this.own(m.subscribe("userSignIn",d.hitch(this,function(a){this.userNameNode.innerHTML=a.userId||""})));this.logoTitle.title=this.nls.backToHomePage||"";this.own(l(this.logoTitle,"click",d.hitch(this,function(){var a=d.hitch(this,function(){if(window.history&&window.history.pushState){if("applist"!==main.getSelectedLabel()){m.publish("switchToAppList");var a=window.location.href.split("?")[0];window.history.pushState({path:a},"",a)}}else window.location.href=
"index.html"});this._hasConfigApp()?m.publish("leavePage",a):a()})));this.own(l(this.profileItem,"click",d.hitch(this,function(){var a=d.hitch(this,function(){window.location.href=v.getHomeUserUrl(window.portalUrl)});this._hasConfigApp()?m.publish("leavePage",a):a()})));this.helpItem.href="help";this.signOutItem&&this.own(l(this.signOutItem,"click",d.hitch(this,function(){var b=d.hitch(this,function(){this.userNameNode.innerHTML="";e.signOutAll();var b=v.getOAuth2SignOutUrl(window.portalUrl),b=v.setHttpsProtocol(b),
c=function(){window.location.href=a.getLocationUrlWithoutHashAndQueryParams()};this._getSigninInfo(window.portalUrl).then(function(a){if(a.portalUrl&&a.supportsOAuth)try{r.get(b).always(function(){c()})}catch(d){console.error(d),c()}else c()},function(){c()})});this._hasConfigApp()?m.publish("leavePage",b):b()})))},_getSigninInfo:function(a){return f("/builder/rest/signininfo/getsignininfo",{handleAs:"json",query:"portalUrl\x3d"+a,method:"GET"})},_bindIntegratedEvents:function(a){this.own(l(document.body,
"click",d.hitch(this,function(a){a=a.target||a.srcElement;a!==this.homeLabel&&g.setStyle(this.homeMenu,"display","none");a!==this.userSection&&!g.isDescendant(a,this.userSection)&&g.setStyle(this.userMenu,"display","none")})));this.own(m.subscribe("iframeClick",d.hitch(this,function(){g.setStyle(this.homeMenu,"display","none");g.setStyle(this.userMenu,"display","none")})));this.own(l(this.homeLabel,"click",d.hitch(this,function(){"none"===g.getStyle(this.homeMenu,"display")?g.setStyle(this.homeMenu,
"display","block"):g.setStyle(this.homeMenu,"display","none")})));this.own(l(this.homeItem,"click",d.hitch(this,function(){m.publish("leavePage",function(){window.location.href=v.getHomeIndexUrl(a)})})));this.own(l(this.galleryItem,"click",d.hitch(this,function(){m.publish("leavePage",function(){window.location.href=v.getHomeGalleryUrl(a)})})));this.own(l(this.mapItem,"click",d.hitch(this,function(){window.appConfig&&window.appConfig.map&&m.publish("leavePage",function(){window.location.href=v.getHomeMapViewerUrl(window.appConfig.map.portalUrl||
window.appConfig.portalUrl,window.appConfig.map.itemId)})})));this.own(l(this.groupsItem,"click",d.hitch(this,function(){m.publish("leavePage",function(){window.location.href=v.getHomeGroupsUrl(a)})})));this.own(l(this.contentItem,"click",d.hitch(this,function(){m.publish("leavePage",function(){window.location.href=v.getHomeMyContentUrl(a)})})));this.own(l(this.organizationItem,"click",d.hitch(this,function(){m.publish("leavePage",function(){window.location.href=v.getHomeMyOrganizationUrl(a)})})));
this.own(l(this.profileItem,"click",d.hitch(this,function(){m.publish("leavePage",function(){window.location.href=v.getHomeUserUrl(a)})})));0<=a.indexOf(".arcgis.com")?this.helpItem.href="http://doc.arcgis.com/en/web-appbuilder/":this.helpItem.href=v.getPortalHelpUrl(a);this.signOutItem&&this.own(l(this.signOutItem,"click",d.hitch(this,function(){m.publish("leavePage",function(){e.signOutAll();window.location.href=v.getPortalSignInUrlFromLocation()})})))},setAppName:function(a){this.appName.innerHTML=
a||""},getAppName:function(){return this.appName.innerHTML||""},_hasConfigApp:function(){return!!main.getViewByLabel("config")},_onUserSectionClicked:function(a){a=a.target||a.srcElement;var b=!0;if(g.isDescendant(a,this.userInfoDom)||a===this.userInfoDom)"none"===g.getStyle(this.userMenu,"display")&&(b=!1);b?g.setStyle(this.userMenu,"display","none"):g.setStyle(this.userMenu,"display","block")}})})},"builder/Apps":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/request dojo/mouse dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Apps.html dojo/on dojo/keys dojo/_base/lang dijit/form/ValidationTextBox ./CreateApp ./CreateAppNew ./AppOperMenu ./serviceUtils dojo/Deferred dojo/topic dojo/dom-class dojo/dom dojo/query dojo/json dijit/registry jimu/dijit/Message jimu/dijit/LoadingShelter jimu/dijit/ItemSelector jimu/dijit/Popup jimu/utils builder/portalUtils esri/lang".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A,z,D,C,F,G,H,E){return t([h,q,l],{templateString:m,menu:void 0,label:"applist",apps:null,sortBy:"lastUpdated",_itemSelector:null,_importPopup:null,postMixInProperties:function(){this.inherited(arguments);this.nls=r.mixin({},builderNls.common);this.nls=r.mixin(this.nls,builderNls.apps)},constructor:function(){this.apps={}},startup:function(){this.inherited(arguments);this.refresh();b.setSelectable(this.appContent,!1);this.loading=new D({hidden:!0});
this.loading.placeAt(this.domNode);this.importing=new D({hidden:!0,loadingText:this.nls.importing});this.importing.placeAt(this.domNode);this.upgrading=new D({hidden:!0,loadingText:this.nls.upgrading});this.upgrading.placeAt(this.domNode)},getAppList:function(){return v.getAppList()},refresh:function(a){a?(this.setApps(a),this.createAppList()):this.getAppList().then(r.hitch(this,function(a){this.setApps(a);this.createAppList()}))},setApps:function(a){this.apps=a},createAppList:function(){this.cleanAppList();
var a,b=null;for(a=0;a<this.apps.length;a++)b=this.createAppNode(this.apps[a],a,b)},cleanAppList:function(){b.empty(this.listTable.firstElementChild||this.listTable.firstChild)},createAppNode:function(c,d,e){var f,g,h,l,m,p,q,s,t,v,u;d=b.create("tr",{"class":"list-table-item list-table-item"+(d%2?" list-table-item-add ":" ")},this.listTable.firstElementChild||this.listTable.firstChild);u=b.create("td",{"class":"item-begin-td item-first-td"},d);b.create("td",{"class":"item-begin-td item-second-td"},
d);g=b.create("td",{"class":"item-name-td"},d);h=b.create("div",{"class":"item-name",innerHTML:c.name,title:c.name},g);l=b.create("td",{"class":"item-desc-td"},d);m=b.create("div",{"class":"item-desc",innerHTML:c.description,title:c.description},l);f=b.create("td",{"class":"item-time-td"},d);v=b.create("div",{"class":"item-time",innerHTML:this._getLocaleDateTime(c.lastUpdated)},f);f=b.create("td",{"class":"item-modified-td"},d);var A=b.create("div",{"class":"item-modified",innerHTML:c.modified},f);
f=b.create("td",{"class":"item-creator-td"},d);b.create("div",{"class":"item-creator",innerHTML:c.creator},f);f=b.create("td",{"class":"item-loading-td",innerHTML:"\x3cdiv class\x3d'loading-div'\x3e\x3c/div\x3e"},d);s=y(".loading-div",f)[0];b.create("img",{src:"builder/css/images/download.gif","class":"loading-img"},s);f=b.create("td",{"class":"item-operations-td"},d);f=b.create("div",{"class":"item-operations-div"},f);b.setStyle(f,"display","none");p=b.create("div",{"class":"item-edit jimu-float-leading",
title:this.nls.edit},f);b.create("div",{innerHTML:this.nls.edit,"class":"item-edit-text jimu-float-leading"},p);b.create("div",{innerHTML:'\x3ca href\x3d"stemapp/index.html?id\x3d'+c.id+'" target\x3d"_blank"\x3e'+this.nls.launch+"\x3c/a\x3e","class":"item-preview jimu-float-leading",title:this.nls.launch},f);q=b.create("div",{"class":"item-more jimu-float-leading"},f);t=b.create("td",{"class":"item-end-td"},d);t=b.create("div",{"class":"app-menu-div"},t);s=new w({apps:this.apps,app:c,posNode:d,loadingDiv:s,
appListWidget:this},t);this.own(n(d,k.enter,r.hitch(this,this._onListTableItemMouseover,d,f,e)));this.own(n(d,k.leave,r.hitch(this,this._onListTableItemMouseout,d,f,s,e)));this.own(n(d,"click",r.hitch(this,function(a){a.stopPropagation()})));this.own(n(h,"dblclick",r.hitch(this,this._onNameDoubleClick,c,d,g,h,v,A)));this.own(n(m,"dblclick",r.hitch(this,this._onDescriptionDoubleClick,c,d,l,m,v,A)));this.own(n(p,"click",r.hitch(this,this._onAppEditClick,c)));this.own(n(q,"click",r.hitch(this,this._onAppMoreClick,
c,s,q,u,d,f,e)));this.own(n(this.ownerDocument,"click",r.hitch(this,this._onAppsClick,s,d,f,u,e,q)));this.own(a.subscribe("menuAll/hide",r.hitch(this,this._onAppsClick,s,d,f,u,e,q)));this.own(n(this.listSectionBodyContent,"scroll",r.hitch(this,this._onScroll,s,d,f,u,e,q)));return d},changeTextFieldOfNode:function(a,d,e,f,g,h,l){var k,m=r.clone(a);b.setStyle(g,"display","none");k="name"===f?b.create("input",{value:a[f],"class":"jimu-input item-input-"+f},e):b.create("textarea",{value:a[f],"class":"jimu-input item-textarea-"+
f},e);k.focus();k.select();c.add(d,"list-table-item-dbclick");n(k,"blur",r.hitch(this,function(){a[f]!==k.value&&(m[f]=k.value,this.updateApp(m).then(r.hitch(this,function(b){!0===b.success?(g.innerHTML=k.value,g.title=k.value,h.innerHTML=this._getLocaleDateTime(b.lastUpdated),l.innerHTML=b.modified,a[f]=k.value):(console.error("The response of updateApp is 'unsuccess'!"),new z({message:b.message}))}),function(a){console.error("Updates 'app name' or 'app description' failed!"+a)}));b.destroy(k);b.setStyle(g,
"display","block");c.remove(d,"list-table-item-dbclick")}))},updateApp:function(a){return v.updateApp(a)},_onCreateClick:function(){x.popupDlg({appListWidget:this})},_onImportClick:function(){this._itemSelector=new C({portalUrl:window.portalUrl,itemTypes:["Web Mapping Application"],onlyShowOnlineFeaturedItems:!1,typeKeywords:["Web AppBuilder"],showOnlineItems:!1});this._importPopup=new F({titleLabel:this.nls.importApp,content:this._itemSelector.domNode,buttons:[{label:builderNls.common.ok,onClick:r.hitch(this,
this._onImportOkClick)},{label:builderNls.common.cancel,onClick:r.hitch(this,this._onImportCancelClick)}]});this._importPopup.disableButton(0);this.own(n(this._itemSelector,"item-selected",r.hitch(this,function(){this._importPopup.enableButton(0)})));this.own(n(this._itemSelector,"none-item-selected",r.hitch(this,function(){this._importPopup.disableButton(0)})));this._itemSelector.startup()},_onImportOkClick:function(){var a=this._itemSelector.getSelectedItem();this.loading.show();H.getPortal(window.portalUrl).getUser().then(r.hitch(this,
function(b){a.getItemData().then(r.hitch(this,function(c){this.loading.hide();this._importPopup.close();c=r.clone(c);this._checkAppVersion(c,{creator:b.username,appName:a.title})}),r.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),r.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppVersion:function(a,b){this.importing.show();v.checkAppVersion(a).then(r.hitch(this,function(c){this.importing.hide();c=c.versionInfo;"old"===c.wabVersionStatus?
this._doAction("upgrade",a,b):"new"===c.wabVersionStatus?this._showNewer(b.appName,c.appVersion):"same"===c.wabVersionStatus&&this._doAction("import",a,b)}),r.hitch(this,function(b){this.importing.hide();this._checkAppInfoError(a.title,b)}))},_checkAppInfoError:function(a,b){new z({message:E.substitute({APP_NAME:a},this.nls.checkVersionError)});console.error(b)},_showUpgrade:function(a,c,d){d="\x3cdiv style\x3d'font-size:14px;'\x3e"+E.substitute({OLD_VERSION:d.appVersion,LATEST_VERSION:d.latestVersion},
this.nls.upgradeContent)+"\x3cdiv style\x3d'height:24px;'\x3e\x3c/div\x3e"+this.nls.upgradeContentFooter+"\x3c/div\x3e";var e=new F({titleLabel:this.nls.upgradeApp,content:b.toDom(d),width:640,autoHeight:!0,buttons:[{label:this.nls.upgradeBtn,onClick:r.hitch(this,function(){e.close();this._doAction("upgrade",a,c)})},{label:builderNls.common.cancel,onClick:r.hitch(this,function(){e.close()})}]})},_showNewer:function(a,c){var d="\x3cdiv style\x3d'font-size:14px;'\x3e"+E.substitute({APP_NAME:a,VERSION_NUMBER:c},
this.nls.importUpperVertion)+"\x3c/div\x3e";new F({titleLabel:this.nls.importApp,content:b.toDom(d),width:640,autoHeight:!0,buttons:[{label:builderNls.common.ok}]})},_doAction:function(a,b,c){"import"===a?this.importing.show():"upgrade"===a&&this.upgrading.show();v.importApp(b,c).then(r.hitch(this,function(){this._importSuccess(c.appName)}),r.hitch(this,function(a){this.upgrading.hide();this.importing.hide();this._importError(c.appName,a)}))},_importSuccess:function(a){this.getAppList().then(r.hitch(this,
function(c){this.setApps(c);this.createAppList();c="\x3cdiv style\x3d'font-size:14px;'\x3e"+E.substitute({APP_NAME:a},this.nls.importSuccess)+"\x3c/div\x3e";new F({titleLabel:this.nls.importApp,content:b.toDom(c),width:640,autoHeight:!0,buttons:[{label:builderNls.common.ok}]})}),r.hitch(this,function(a){console.error(a)})).always(r.hitch(this,function(){this.importing.hide();this.upgrading.hide()}))},_importError:function(a,c){var d="\x3cdiv style\x3d'font-size:14px;'\x3e"+E.substitute({APP_NAME:a},
this.nls.upgradeFailure)+"\x3c/div\x3e";new F({titleLabel:this.nls.importApp,content:b.toDom(d),width:640,autoHeight:!0,buttons:[{label:builderNls.common.ok}]});console.error(c)},_getLocaleDateTime:function(a){return G.localizeDate(new Date(a),{fullYear:!0})},_onImportCancelClick:function(){this._importPopup.close()},_onListTableItemMouseover:function(a,d,e){c.add(a,"list-table-item-mouseover");e&&c.add(e,"list-table-next-item-mouseover");b.setStyle(d,"display","block")},_onListTableItemMouseout:function(a,
d,e,f){e.isShow||(c.remove(a,"list-table-item-mouseover"),f&&c.remove(f,"list-table-next-item-mouseover"),b.setStyle(d,"display","none"))},_onNameDoubleClick:function(a,b,c,d,e,f){r.hitch(this,this.changeTextFieldOfNode(a,b,c,"name",d,e,f))},_onDescriptionDoubleClick:function(a,b,c,d,e,f){r.hitch(this,this.changeTextFieldOfNode(a,b,c,"description",d,e,f))},_onAppEditClick:function(b){a.publish("switchToApp",b)},_onAppMoreClick:function(d,e,f,g,h,l,k,m){e.isShow?(e.hide(),c.remove(g,"item-first-td-selected"),
b.removeClass(f,"item-more-selected")):(a.publish("menuAll/hide"),e.set("app",d),e.show(),c.add(g,"item-first-td-selected"),b.addClass(f,"item-more-selected"),this._onListTableItemMouseover(h,l,k,m));m.stopPropagation()},_onAppsClick:function(a,d,e,f,g,h){a.hide();c.remove(f,"item-first-td-selected");g&&c.remove(g,"list-table-next-item-mouseover");c.remove(d,"list-table-item-mouseover");b.removeClass(h,"item-more-selected");b.setStyle(e,"display","none")},_onScroll:function(a,b,c,d,e,f){!0===a.isShow&&
this._onAppsClick(a,b,c,d,e,f)}})})},"builder/CreateApp":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/request dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/CreateApp.html dojo/on dojo/dom-style dojo/dom-class dojo/dom-attr dojo/_base/lang jimu/dijit/Message dojo/ready ./ConfigApp ./serviceUtils".split(" "),function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w){return t([k,h],{templateString:q,baseClass:"create-app",appListWidget:null,is3D:"false",postMixInProperties:function(){this.nls=
r.mixin({},builderNls.common);this.nls=r.mixin(this.nls,builderNls.apps)},postCreate:function(){this.inherited(arguments);n.add(this.app2D,"app-image-div-down")},startup:function(){this.inherited(arguments);this.appName.focus()},saveApp:function(){},createApp:function(){return w.createApp({name:this.appName.value,description:this.appDescription.value,is3D:this.is3D,webmap:this.webmap})},_onCancelClick:function(){this.destroy();this._closePopup();console.debug("cancel click")},_onNextClick:function(){this.appName.value?
this.createApp().then(r.hitch(this,function(b){if(b.success){var d=main.getViewByLabel("config");d&&d.appId.toString()===b.newAppId.toString()||(this.appListWidget.refresh(),d&&main.removeView(d),d=new x({appId:b.newAppId}),main.addView(d));main.switchView(d);this._closePopup();this.destroy()}else new u({message:b.message})}),function(b){console.error("Creates a new APP failed!"+b);new u({message:this.nls.createAppFailedMeg})}):new u({message:this.nls.noAppName})},_closePopup:function(){this.popup&&
this.popup.close()},_on2dClick:function(){this.is3D="false";n.add(this.app2D,"app-image-div-down");n.remove(this.app3D,"app-image-div-down")},_on3dClick:function(){}})})},"builder/AppOperMenu":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/request dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/AppOperMenu.html dojo/on dojo/query dojo/dom-style dojo/dom-attr dojo/dom dojo/keys dojo/_base/lang jimu/dijit/Popup jimu/dijit/Message builder/CreateApp ./AGOLTemplate/AGOLTemplate ./AGOLTemplate/utils ./serviceUtils ./utils jimu/ConfigManager jimu/dijit/LoadingShelter dijit/form/TextBox dijit/form/SimpleTextarea jimu/dijit/QRCode".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B,A,z,D){return t([k,h],{templateString:q,baseClass:"app-menu",app:void 0,isShow:!1,position:{},itemDefaultColor:"#ffffff",appListWidget:void 0,loadingDiv:null,_downloadUrl:null,postMixInProperties:function(){this.nls=s.mixin({},builderNls.common);this.nls=s.mixin(this.nls,builderNls.apps)},postCreate:function(){this.inherited(arguments);this.height=b.getMarginBox(this.domNode).h;this.hide();this._downloadUrl="/builder/rest/apps/"+this.app.id+"/download";
b.setAttr(this.downloadLinkNode,"href",this._downloadUrl);this.own(l(this.downloadLinkNode,"click",s.hitch(this,function(){this.hide()})))},refresh:function(){var a=r.byId("list-section"),c=b.position(this.posNode),d=b.position(a),e=c.y-d.y,a=b.getStyle(a,"height"),d=d.y+a,a=this.height,c=c.y+a;b.setStyle(this.upTriangle,"display","block");b.setStyle(this.downTriangle,"display","none");c+30>d&&(e=e-a-66,b.setStyle(this.upTriangle,"display","none"),b.setStyle(this.downTriangle,"top",this.height-2+
"px"),b.setStyle(this.downTriangle,"display","block"));b.setStyle(this.domNode,isRTL?{top:e+52+"px",left:"2px"}:{top:e+52+"px",right:"2px"})},show:function(){this.refresh();b.setStyle(this.domNode,"display","block");this.isShow=!0},hide:function(){b.setStyle(this.domNode,"display","none");this.isShow=!1},removeApp:function(a){return g("/builder/rest/apps/removeapp",{handleAs:"json",method:"POST",data:{id:a}})},duplicateApp:function(){return c.duplicateApp({name:this.app.name,description:this.app.description,
id:this.app.id})},_onMenuClick:function(a){a.stopPropagation()},_onCreateFromHereClick:function(){var a=b.create("div",{id:"app-create-popup"},this.appListWidget.createApp);new v({appListWidget:this.appListWidget,apps:this.apps,createFromId:this.app.id,is3D:this.app.is3D},a);this.hide()},_onCreateFromHereMouseover:function(){b.addClass(this.createFromHere,"item-mouseover")},_onCreateFromHereMouseout:function(){b.removeClass(this.createFromHere,"item-mouseover")},_onRemoveClick:function(){var a=new x({content:this.nls.confirmDeleteApp,
titleLabel:this.nls.deleteAppTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.ok,onClick:s.hitch(this,function(){var b=new B({hidden:!0});b.placeAt(this.appListWidget.domNode);b.show(this.nls.deleting);a.close();this.removeApp(this.app.id).then(s.hitch(this,function(a){a.success?(console.log("Removed app successfully, id\x3d"+this.app.id),a.apps!=={}&&this.appListWidget.refresh(a.apps)):console.error(this.nls.deleteFalse);b.destroy()}),function(){console.error(this.nls.deleteError);b.destroy()})})},
{label:this.nls.cancel,onClick:s.hitch(this,function(){a.close()})}]})},_onRemoveMouseover:function(){b.addClass(this.remove,"item-mouseover")},_onRemoveMouseout:function(){b.removeClass(this.remove,"item-mouseover")},_onDuplicateClick:function(){var a=new B({hidden:!0});a.placeAt(this.appListWidget.domNode);a.show(this.nls.duplicating);c.duplicateApp({name:this.app.name,description:this.app.description,is3D:this.app.is3D,createFromId:this.app.id}).then(s.hitch(this,function(b){a.destroy();b.success?
(console.log("Duplicated app successfully, app id\x3d"+this.app.id),b.apps!=={}&&this.appListWidget.refresh(b.apps)):console.error(this.nls.duplicateFalse)}),function(){console.error(this.nls.duplicateError)});this.hide()},_onDuplicateMouseover:function(){b.addClass(this.duplicate,"item-mouseover")},_onDuplicateMouseout:function(){b.removeClass(this.duplicate,"item-mouseover")},_onEditClick:function(){var a=b.create("div",{"class":"edit-app-info-content"}),c;c=b.create("div",{"class":"app-name"},
a);var d=(new A({value:this.app.name,maxlength:250,required:!0,placeholder:this.nls.appName,"class":"name-text-box"})).placeAt(c);c=b.create("div",{"class":"app-description"},a);var e=(new z({value:this.app.description,rows:5,trim:!0,maxlength:250,required:!0,placeholder:this.nls.appDesc,"class":"desc-text-area"})).placeAt(c),f=new x({content:a,container:"main-page",titleLabel:this.nls.editAppInfo,width:"700",autoHeight:!0,buttons:[{label:this.nls.ok,onClick:s.hitch(this,function(){var a=s.hitch(this,
this._onEditPageOk,d.getValue(),e.getValue(),f);this.app.name!==d.getValue()||this.app.description!==e.getValue()?a():f.close()})},{label:this.nls.cancel,onClick:function(){f.close()}}]}),a=m(".line",f.domNode)[0];b.destroy(a)},_onEditPageOk:function(a,b,c){var d=s.clone(this.app);d.name=a;d.description=b;this.appListWidget.updateApp(d).then(s.hitch(this,function(d){!0===d.success?(this.app.name=a,this.app.description=b,console.log(this.nls.editAppTrue+this.app.id),this.app.lastUpdated=d.lastUpdated,
this.app.modified=d.modified,this.appListWidget.refresh(this.apps),c.close()):(console.error(this.nls.editAppFalse),new w({message:d.message}))}),function(a){console.error(this.nls.error+a)})},_onEditMouseover:function(){b.addClass(this.editAppInfo,"item-mouseover")},_onEditMouseout:function(){b.removeClass(this.editAppInfo,"item-mouseover")},_onDownloadClick:function(){},_onDownloadMouseover:function(){b.addClass(this.download,"item-mouseover")},_onDownloadMouseout:function(){b.removeClass(this.download,
"item-mouseover")},_onAgolTemplateClick:function(){jimuConfig.widgetsPackage={name:"widgets",location:"/webappbuilder/apps/"+this.app.id+"/widgets"};jimuConfig.themesPackage={name:"themes",location:"/webappbuilder/apps/"+this.app.id+"/themes"};jimuConfig.configsPackage={name:"configs",location:"/webappbuilder/apps/"+this.app.id+"/configs"};window.appPath=p.getAppPathById(this.app.id);var b=(new B({})).placeAt("main-view-stack");b.startup();y.getInstance({config:"/webappbuilder/apps/"+this.app.id+
"/config.json"}).loadConfig().then(s.hitch(this,function(c){a.loadAllWidgetConfigs(c).then(s.hitch(this,function(a){var c=a.getCleanConfig(),c=s.clone(c);delete c.agolTemplateJson;c.visitElement=a.visitElement;c.visitElement(function(a){!a.widgets&&(a.uri&&void 0===a.visible)&&(a.visible=!0)});delete c.visitElement;a=new e({appConfig:c,fullAppConfig:a,app:this.app});new x({content:a,container:"main-page",titleLabel:builderNls.agolTemplate.title,width:1040,height:625,buttons:[{label:builderNls.agolTemplate.download,
key:u.ENTER,onClick:s.hitch(a,a._onExportClick)},{label:builderNls.common.saved,key:u.ENTER,onClick:s.hitch(a,a._onSaveClick)},{label:this.nls.cancel,key:u.ESCAPE}]});a.startup();b.hide()}),function(){b.hide()})}),function(){b.hide()});this.hide()},_onAgolTemplateMouseover:function(){b.addClass(this.agolTemplate,"item-mouseover")},_onAgolTemplateMouseout:function(){b.removeClass(this.agolTemplate,"item-mouseover")},_onQRCodeClick:function(){new x({content:new D({text:"http://"+window.location.host+
path+"apps/"+this.app.id,width:128,height:128}),container:"main-page",titleLabel:"qrcode-nonls",width:300,autoHeight:!0,buttons:[{label:this.nls.cancel,key:u.ESCAPE}]})}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B){return t([b,g,k,q],{templateString:h,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,postMixInProperties:function(){this.portalUrl=a.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";n.forEach(this.itemTypes,l.hitch(this,function(a,b){this._itemTypes+='"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+
"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";n.forEach(this.typeKeywords,l.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();this.portal=v.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();
this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=w.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=w.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){this.tab=new y({tabs:[{title:this.nls.myContent,content:this.mycontentTabNode},{title:this.nls.myOrganization,content:this.organizationTabNode},{title:this.nls.myGroup,content:this.groupTabNode},{title:this.nls.publicMap,
content:this.publicTabNode}]},this.tabNode);this.own(x(this.tab,"tabChanged",l.hitch(this,function(a){f.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){f.setStyle(this.signinSection,"display","none");var a=s(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);e.userHaveSignInPortal(this._getPortalUrl())?a.style("display",
"block"):(a.style("display","none"),this._isPublicTabShow||f.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){w.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalPublicLabel);w.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlinePublicLabel);var b=this._getPortalUrl(),b=a.getServerByUrl(b);this.portalPublicRaido.disabled=!1;this.onlinePublicRaido.disabled=!1;this.portalPublicRaido.checked=!0;var c=!1;a.isArcGIScom(b)?(c=!0,this.portalPublicLabel.innerHTML=
"ArcGIS.com"):(this.portalPublicLabel.innerHTML=b,c=this.showOnlineItems?!1:!0);c&&(this.onlinePublicRaido.disabled=!0,f.setStyle(this.onlinePublicRaido,"display","none"),f.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(m.locale&&m.locale.slice(0,2)||"en").toLowerCase(),b=n.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
l.hitch(this,function(b){return b!==a})),c="";n.forEach(b,l.hitch(this,function(a){c+=" -owner:"+a+" "}));b=" ";this.portal&&(this.portal.user&&this.portal.user.orgId)&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._itemTypeQueryString+" AND access:public "+c+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:b});this._filterPublicPortalQuery=this._getQuery({q:b,basicQ:b});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return l.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return a.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){this.own(x(this.publicPortalItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));this.own(x(this.publicOnlineItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));this.own(x(this.organizationItemTable,"item-dom-clicked",
l.hitch(this,this._onItemDomClicked)));this.own(x(this.groupItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));this.own(x(this.mycontentItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.disabled||
(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",this._filterPublicOnlineQuery))},_initPublic:function(){this.own(x(this.portalPublicRaido,"click",l.hitch(this,this._onPublicRaidoClicked)));this.own(x(this.onlinePublicRaido,"click",l.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?
(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},_onPublicSearch:function(a){(a=a&&l.trim(a))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):
this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(x(this.groupsSelect,"change",l.hitch(this,this._onGroupsSelectChange)));var b=
a.getServerByUrl(this._getPortalUrl());a.isArcGIScom(b);e.userHaveSignInPortal(this._getPortalUrl())&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&l.trim(a)){if(this._allOrganizationQuery){var b=this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&l.trim(a)){if(this._allMyContentQuery){var b=
this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(a){if(a=a&&l.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},
_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=!0;var a=this._getPortalUrl();v.getPortal(a).getUser().then(l.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();
a=" orgid:"+a.orgId+" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+
" "+this._typeKeywordQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();f.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){f.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();f.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var c=
a[b];f.create("option",{value:c.id,innerHTML:c.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){f.setStyle(this.groupsSection,"display","none");f.empty(this.groupsSelect);f.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();f.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?f.setStyle(this.groupsSection,
"top","15px"):f.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)f.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{f.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});
this.groupItemTable.set("portalUrl",b);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemDomClicked:function(a){var b=f.hasClass(a,"selected");s(".item-div.selected",this.domNode).removeClass("selected");b&&f.addClass(a,"selected");(a=this.getSelectedItem())?this.emit("item-selected",a):this.emit("none-item-selected")},getSelectedItem:function(){var a=null,b=s(".item-div.selected",this.domNode);0<b.length&&(a=l.mixin({},b[0].item));return a}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w){return t([d,b,g,h],{templateString:k,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||
(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=x.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},show:function(){m.setStyle(this.domNode,"display","block")},hide:function(){m.setStyle(this.domNode,"display","none")},searchAllItems:function(b){this.showAllItemsSection();b&&(this.query=q.mixin({},b),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),
s.getPortal(this.portalUrl).queryItems(this.query).then(q.hitch(this,function(b){this.domNode&&(this.allItemsShelter.hide(),this.query.start=b.nextStart,this._createItems(b,this.allItemTbody))}),q.hitch(this,function(b){console.error(b);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(b){this.showFilterItemsSection();b&&(this.filteredQuery=q.mixin({},b),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&
(this.filteredItemShelter.show(),s.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(q.hitch(this,function(b){this.domNode&&(this.filteredItemShelter.hide(),this.filteredQuery.start=b.nextStart,this._createItems(b,this.filteredItemsTbody),0===this._getItemCount(this.filteredItemsTbody)&&(m.setStyle(this.filteredItemsTableDiv,"display","none"),m.setStyle(this.searchNoneTipSection,"display","block")))}),q.hitch(this,function(b){console.error(b);this.domNode&&(this.filteredItemShelter.hide(),
0===this._getItemCount(this.filteredItemsTbody)&&(m.setStyle(this.filteredItemsTableDiv,"display","none"),m.setStyle(this.searchNoneTipSection,"display","block")))})))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){m.empty(this.allItemTbody)},clearFilteredItemsSection:function(){m.empty(this.filteredItemsTbody)},showAllItemsSection:function(){m.setStyle(this.allItemsSection,"display","block");m.setStyle(this.filteredItemsSection,"display",
"none")},showFilterItemsSection:function(){m.setStyle(this.allItemsSection,"display","none");m.setStyle(this.filteredItemsSection,"display","block");m.setStyle(this.filteredItemsTableDiv,"display","block");m.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(b){return u.isScrollToBottom(b)},
_createItems:function(b,d){var a=b.results,c=l.map(this.types,q.hitch(this,function(a){return a.toLowerCase()})),a=l.filter(a,q.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=l.indexOf(c,a)}));if(0!==a.length){var g,h=f("td.empty",d),k;if(0<h.length){var n=a.splice(0,h.length);for(k=0;k<h.length;k++){var r=h[k];g=this._createItem(n[k]);m.place(g,r);m.removeClass(r,"empty")}}if(0!==a.length){h=Math.ceil(a.length/2);for(k=0;k<h;k++){g=m.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");
m.place(g,d);n=f("td",g);for(r=0;r<n.length;r++){var s=n[r];(g=a[2*k+r])?(g=this._createItem(g),m.place(g,s)):m.addClass(s,"empty")}}}}},_getItemCount:function(b){return f(".item-div",b).length},_createItem:function(b){var d=m.toDom('\x3cdiv class\x3d"item-div"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
d.item=b;var a=f(".item-thumbnail",d)[0],c=f(".item-name",d)[0],g=f(".item-type-owner",d)[0],h=f(".item-date",d)[0],k=f(".item-details",d)[0],l=f(".none-thumbnail-tip",d)[0];if(!b.thumbnailUrl){var n=this._defaultThumbnail[b.type];n&&(b.thumbnailUrl=require.toUrl("jimu")+"/images/"+n)}b.thumbnailUrl?m.setStyle(a,"backgroundImage","url("+b.thumbnailUrl+")"):l.innerHTML=this.nls.noneThumbnail;c.innerHTML=b.title;c.title=c.innerHTML;g.innerHTML=b.type+" by "+b.owner;g.title=g.innerHTML;a=new Date;a.setTime(b.modified);
h.innerHTML=a.toLocaleString();h.title=h.innerHTML;k.innerHTML=this.nls.moreDetails;k.href=b.detailsPageUrl||"#";return d},_onItemsTableClicked:function(b){var d=b.target||b.srcElement;b=null;m.hasClass(d,"item-thumbnail")?b=d.parentNode:m.hasClass(d,"none-thumbnail-tip")&&(b=d.parentNode.parentNode);b&&(d=m.hasClass(b,"selected"),f(".item-div.selected",this.domNode).removeClass("selected"),d?m.removeClass(b,"selected"):m.addClass(b,"selected"),this.emit("item-dom-clicked",b))},getSelectedItem:function(){var b=
null,d=f(".item-div.selected",this.domNode);0<d.length&&(b=q.mixin({},d[0].item));return b}})})},"url:builder/templates/ConfigApp.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"left-pane" data-dojo-attach-point\x3d"leftPaneNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"right-preview-section" data-dojo-attach-point\x3d"rightPreviewSection"\x3e\r\n    \x3cdiv class\x3d"preview-config" data-dojo-attach-point\x3d"previewConfig"\x3e\r\n      \x3ciframe name\x3d"previewFrame" data-dojo-attach-point\x3d"viewerNode" style\x3d"border:none"\x3e\x3c/iframe\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"preview-more" data-dojo-attach-point\x3d"previewMore"\x3e\r\n      \x3cdiv class\x3d"preview-more-iframe-section" data-dojo-attach-point\x3d"previewMoreIframeSection"\x3e\r\n        \x3cdiv class\x3d"preview-more-iframe-container" data-dojo-attach-point\x3d"viewer2Container"\x3e\r\n          \x3ciframe name\x3d"previewMoreFrame" data-dojo-attach-point\x3d"viewer2Node" style\x3d"border-color:#cad1d9;"\x3e\x3c/iframe\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"description" data-dojo-attach-point\x3d"previewMoreDes"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e    \r\n      \x3cdiv class\x3d"screen-switch-section"\x3e\r\n       \x3cdiv class\x3d"portrait jimu-float-leading selected" data-dojo-attach-point\x3d"btnPortrait"\x3e\x3c/div\x3e\r\n       \x3cdiv class\x3d"landscape jimu-float-trailing" data-dojo-attach-point\x3d"btnLandscape"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/config/templates/LeftPane.html":'\x3cdiv class\x3d"left-pane"\x3e\r\n  \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"content"\x3e\r\n    \x3cdiv class\x3d"config-section" data-dojo-attach-point\x3d"configSection"\x3e\r\n      \x3cdiv class\x3d"tabs" data-dojo-attach-point\x3d"tabsNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"appPaneNode"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"mapPaneNode"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"widgetPaneNode"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"attributePaneNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"preview-section" data-dojo-attach-point\x3d"previewSection" style\x3d"display:none;"\x3e\r\n      \x3cdiv class\x3d"preview-header"\x3e\r\n        \x3cdiv class\x3d"header-item size-section"\x3e\r\n          \x3ctable class\x3d"size-table"\x3e\r\n            \x3ccolgroup\x3e\r\n              \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"20px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n            \x3c/colgroup\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"width-tip jimu-ellipsis" title\x3d"${nls.width}"\x3e${nls.width}\x3c/div\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"pixel-div"\x3e\r\n                    \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"1024" data-dojo-attach-point\x3d"customWidth" /\x3e\r\n                    \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"height-tip jimu-ellipsis" title\x3d"${nls.height}"\x3e${nls.height}\x3c/div\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"pixel-div"\x3e\r\n                    \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"768"  data-dojo-attach-point\x3d"customHeight" /\x3e\r\n                    \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"preview-body"\x3e\r\n        \x3cdiv class\x3d"preview-items-section"\x3e\r\n          \x3ctable\x3e\r\n            \x3ctbody data-dojo-attach-point\x3d"previewTbody"\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"preview-qrcode-section" \x3e\r\n          \x3cdiv class\x3d"qrcode-image jimu-float-leading" data-dojo-attach-point\x3d"qrcodeImage"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"qrcode-description jimu-float-leading" data-dojo-attach-point\x3d"qrcodeDescription"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"footer"\x3e\r\n    \x3cdiv class\x3d"footer-button-box first-footer-button-box jimu-float-leading" data-dojo-attach-point\x3d"launchFooterBox"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class \x3d "seprate jimu-float-leading"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"footer-button-box second-footer-button-box jimu-float-leading" data-dojo-attach-point\x3d"secondFooterBox"\x3e\r\n      \x3cdiv class\x3d"footer-button  preview-button" data-dojo-attach-point\x3d"btnPreview" title\x3d${nls.previewMore}\x3e${nls.previewMore}\x3c/div\x3e\r\n      \x3cdiv class\x3d"footer-button second-footer-button config-button" data-dojo-attach-point\x3d"btnConfig" title\x3d${nls.back2Configure}\x3e${nls.back2Configure}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class \x3d "seprate jimu-float-leading"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"footer-button-box third-footer-button-box jimu-float-leading" data-dojo-attach-point\x3d"btnSaveBox"\x3e\r\n      \x3cdiv class\x3d"footer-button third-footer-button" data-dojo-attach-point\x3d"btnSave" title\x3d${nls.saved}\x3e${nls.saved}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"forth-footer-button-arrow jimu-float-leading" data-dojo-attach-point\x3d"btnArrow"\x3e\r\n      \x3cdiv class\x3d"foot-menu" data-dojo-attach-point\x3d"footMenu"\x3e\r\n          \x3cdiv nowrap data-dojo-attach-event\x3d"click:_onSave"\x3e${nls.save}\x3c/div\x3e\r\n          \x3cdiv nowrap data-dojo-attach-event\x3d"click:_onSaveAs"\x3e${nls.saveAs}\x3c/div\x3e\r\n          \x3cdiv nowrap data-dojo-attach-event\x3d"click:_onExportAsTemplate" data-dojo-attach-point\x3d"exportMenu"\x3e${nls.exportTitle}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"loading-cover" data-dojo-attach-point\x3d"coverNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/config/templates/MapConfig.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"map-info-section" data-dojo-attach-point\x3d"mapSelectedSection"\x3e\r\n\t\t\t\x3cdiv class\x3d"map-selected-meta-data"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"map-selected-img" data-dojo-attach-point\x3d"divMapSelectedImg" data-dojo-attach-event\x3d"click:_showMapSelector" title\x3d"${nls.clickChooseWebMap}"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"detail-info"\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"overflow:hidden;"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"web-map-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-float-leading" style\x3d"width:140px;"\x3e\r\n\t\t\t\t\t\t\t\x3cspan class\x3d"owner-tip jimu-float-leading"\x3eWeb Map ${nls.owner}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\x3ca data-dojo-attach-point\x3d"owner" href\x3d"#" target\x3d"_blank" class\x3d"owner-link"\x3e\x3c/a\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"margin-top:5px;color:#596679;"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.lastModified}:\x3c/span\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lastModified" class\x3d"last-modified"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"margin-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3ca data-dojo-attach-point\x3d"webMapDetails" href\x3d"#" target\x3d"_blank" class\x3d"webmap-details"\x3e${nls.moreDetails}...\x3c/a\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv nowrap class\x3d"map-config-btn choose-map-btn" title\x3d"${nls.changeMap}" data-dojo-attach-event\x3d"click:_showMapSelector"\x3e${nls.changeMap}\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"map-info-title" data-dojo-attach-point\x3d"mapTitle"\x3e\x3c/div\x3e\r\n\t\t\t\x3cp class\x3d"snippet" data-dojo-attach-point\x3d"snippet"\x3e\x3c/p\x3e\r\n\t\t\t\x3cp class\x3d"statement"\x3e${nls.statement}\x3c/p\x3e\r\n\t\t\t\x3cspan class\x3d"map-config-btn" data-dojo-attach-point\x3d"btnInitialExtent" style\x3d"margin-top:10px;"\x3e${nls.setInitialExtent}\x3c/span\x3e\x3cbr\x3e\r\n\t\t\t\x3cspan class\x3d"map-config-btn" data-dojo-attach-point\x3d"restore"  style\x3d"margin-top:10px;"data-dojo-attach-event\x3d"onClick:_restoreToDefaultWebMapExtent"\x3e${nls.restoreInitialExtent}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/config/templates/MapSelector.html":'\x3cdiv style\x3d"position:relative;width:100%;height:100%;"\x3e\r\n\t\x3cdiv class\x3d"map-setting-tab-container" style\x3d"width:100%;height:100%;"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:15px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentMapTable" data-dojo-type\x3d"builder/config/MapTable" style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:15px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationMapTable" data-dojo-type\x3d"builder/config/MapTable" style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:70px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:15px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupMapTable" data-dojo-type\x3d"builder/config/MapTable" style\x3d"top:113px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:15px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel  data-dojo-attach-point\x3d"portalNameLabel" class\x3d"jimu-float-leading portal-name"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlineNameLabel" class\x3d"jimu-float-leading online-name"\x3eArcGIS.com\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicMapSection" class\x3d"public-map-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalMapTable" data-dojo-type\x3d"builder/config/MapTable"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineMapTable" data-dojo-type\x3d"builder/config/MapTable"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/config/templates/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"filteredMapsSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/config/templates/ThemeConfig.html":'\x3cdiv class\x3d"theme-config"\x3e\r\n  \x3cdiv class\x3d"theme-list" data-dojo-attach-point\x3d"themeList"\x3e\r\n    \x3cdiv class\x3d"theme-title"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separate-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"style-list" data-dojo-attach-point\x3d"styleList"\x3e\r\n    \x3c!--div class\x3d"style-text"\x3e${nls.styleTitle}\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layout-list" data-dojo-attach-point\x3d"layoutList"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"theme-loading-cover" style\x3d"display:none" data-dojo-attach-point\x3d"themeCoverNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/config/templates/WidgetConfig.html":'\x3cdiv class\x3d"widget-config"\x3e\r\n  \x3cdiv class\x3d"pane app-widgets" data-dojo-attach-point\x3d"appWidgetsPageNode"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/config/templates/AppWidgetsPage.html":'\x3cdiv class\x3d"app-widgets"\x3e\r\n  \x3cdiv class\x3d"preload-widgets-list" data-dojo-attach-point\x3d"preloadWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"controller-widgets-list" data-dojo-attach-point\x3d"controllerWidgetsNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"noncontroller-preload-widgets-list" data-dojo-attach-point\x3d"noncontrollerPreloadWidgetsNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"pool-widgets-list" data-dojo-attach-point\x3d"poolWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"widgets-link" data-dojo-attach-point\x3d"backWidgetsNode" data-dojo-attach-event\x3d"onclick: _onBackWidgetsClick"\x3e \x3cspan\x3e\x3c/span\x3e \x26nbsp;\r\n      ${nls.widgets}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-title" data-dojo-attach-point\x3d"poolTitleNode"\x3e${nls.setControlledWidgetsBy}\x3cspan data-dojo-attach-point\x3d"controllerLabelNode"\x3e\x3c/span\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-list" data-dojo-attach-point\x3d"poolWidgetsListNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/config/templates/WidgetSettingPage.html":'\x3cdiv class\x3d"widget-setting-page"\x3e\r\n  \x3cdiv class\x3d"section common-setting" data-dojo-attach-point\x3d"commonSettingNode"\x3e\r\n    \x3cdiv class\x3d"basic"\x3e\r\n      \x3cdiv class\x3d"icon jimu-float-leading"\x3e\r\n        \x3cimg class\x3d"real-icon"  data-dojo-attach-point\x3d"iconNode"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right jimu-float-trailing jimu-leading-margin1"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"labelNode" placeholder\x3d"${nls.widgetLabel}" required\x3d"true" class\x3d"widget-setting-input"\x3e\r\n        \x3cdiv class\x3d"right-foot" data-dojo-attach-point\x3d"rightFooterNode"\x3e\r\n          \x3cdiv class\x3d"image-container"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooser"\x3e\x3c/div\x3e\r\n            \x3cspan nowrap class\x3d"change-icon" data-dojo-attach-point\x3d"changeNode"\x3e${nls.changeIcon}\x3c/span\x3e\r\n            \x3ca class\x3d"help-link jimu-float-trailing" target\x3d"_blank" data-dojo-attach-point\x3d"helpNode"\x3e${nls.more}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layout"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"section widget-setting" data-dojo-attach-point\x3d"widgetSettingNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/config/templates/GroupSettingPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"label-div"\x3e\r\n    \x3cspan\x3e${nls.label}\x3c/span\x3e\r\n    \x3cinput class\x3d"jimu-input" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/input\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/config/templates/WidgetChoosePage.html":'\x3cdiv class\x3d"widget-choose-page"\x3e\r\n  \r\n  \x3cdiv class\x3d"section search" data-dojo-attach-point\x3d"searchSectionNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"searchInputNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"list widget-list" data-dojo-attach-point\x3d"widgetListNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/config/templates/AttributeConfig.html":'\x3cdiv class\x3d"attribute-config"\x3e\r\n  \x3cdiv class\x3d"section header-section" data-dojo-attach-point\x3d"headerSection"\x3e\r\n    \x3cp class\x3d"header-title"\x3e${nls.headerTitle}\x3c/p\x3e\r\n    \x3cdiv class\x3d"header-desc"\x3e${nls.headerDesc}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading jimu-trailing-margin1" data-dojo-type\x3d"jimu/dijit/ImageChooser" data-dojo-attach-point\x3d"imageChooser" data-dojo-props\x3d"showSelfImg:false,goldenWidth:30,goldenHeight:30"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"no-logo jimu-float-leading jimu-trailing-margin1"  data-dojo-attach-point\x3d"noLogoNode"\x3e\r\n        \x3cimg class\x3d"image" src\x3d"builder/css/images/add_header.png"\x3e\r\n        \x3cdiv class\x3d"text"\x3e ${nls.addLogo}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cimg class\x3d"logo jimu-float-leading jimu-trailing-margin1" data-dojo-attach-point\x3d"logoNode" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"titles jimu-float-leading"\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"title"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.title}" data-dojo-attach-point\x3d"titleNode" maxLength\x3d"100"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"subtitle"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.subtitle}" data-dojo-attach-point\x3d"subtitleNode" maxLength\x3d"100"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"section links-section" data-dojo-attach-point\x3d"linksSection"\x3e\r\n    \x3cp class\x3d"title"\x3e${nls.linksTitle}\x3c/p\x3e\r\n    \x3cdiv class\x3d"attribute-content"\x3e\r\n      \x3cdiv class\x3d"list-header"\x3e\r\n        \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddLinkClick"\x3e${nls.addLink}\x3c/span\x3e\r\n        \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditLinkClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n        \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteLinkClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"links-list" data-dojo-attach-point\x3d"linksListNode"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"section appId-section" data-dojo-attach-point\x3d"appIdSection" style\x3d"display:none"\x3e\r\n    \x3cp class\x3d"title"\x3e${nls.appIdTitle}\x3c/p\x3e\r\n    \x3ca target\x3d"_blank" href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.appIdAbout}\x3c/a\x3e\r\n    \x3cdiv class\x3d"attribute-content"\x3e\r\n      \x3cinput type\x3d"text" placeholder\x3d"AppId" data-dojo-attach-point\x3d"appIdNode" /\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"section" data-dojo-attach-point\x3d"useProxySection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"useProxySetting"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"proxy-section" data-dojo-attach-point\x3d"proxySection"\x3e\r\n      \x3clabel class\x3d"rules-label"\x3e${nls.proxyRulesLabel}\x3c/label\x3e\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cdiv class\x3d"list-header"\x3e\r\n          \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddProxyRuleClick"\x3e${nls.addProxyRule}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditProxyRuleClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteProxyRuleClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"proxy-rule-header"\x3e\r\n          \x3cdiv class\x3d"prefix"\x3e${nls.prefixHeader}\x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-url"\x3e${nls.proxyUrlHeader}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"proxy-rule-list" data-dojo-attach-point\x3d"proxyRulesListNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"always-use-proxy" data-dojo-attach-point\x3d"alwaysUseProxy"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"attribute-content" data-dojo-attach-point\x3d"proxyUrlSection" \x3e\r\n        \x3cinput type\x3d"text" placeholder\x3d"${nls.proxyUrl}" data-dojo-attach-point\x3d"proxyUrlNode" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/config/templates/TabContainer2.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable class\x3d"control-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-viewstack2" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/templates/CreateAppNew.html":'\x3cdiv\x3e\r\n      \x3cdiv id\x3d"share-map-application-publish" dojoType\x3d"dijit.layout.ContentPane" dojoAttachPoint\x3d"_stackApplicationPublish" class\x3d"share-map-stack-stack  .esriLtr .esri"\x3e\r\n\r\n        \x3cp style\x3d"display:none;" class\x3d"configureApp"\x3e${nls.savePublish}\x3c/p\x3e\r\n        \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderTitle}\x3c/p\x3e\r\n        \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderMsg}\x3c/p\x3e\r\n        \x3cp style\x3d"display:none;" class\x3d"appBuilder" data-dojo-attach-point\x3d"templateTitle"\x3e${nls.templateTitle}\x3c/p\x3e\r\n        \x3cp style\x3d"display:none;" class\x3d"appBuilder" data-dojo-attach-point\x3d"message1"\x3e\x3c/p\x3e\r\n        \x3cdiv style\x3d"display:none;" class\x3d"explain-div" data-dojo-attach-point\x3d"explain1"\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"app-2d-and-3d" data-dojo-attach-point\x3d"div2dAnd3d"\x3e\r\n          \x3cdiv class\x3d"app-image-div app-2d jimu-float-leading" data-dojo-attach-point\x3d"app2D" data-dojo-attach-event\x3d"click:_on2dClick"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"app-image-div app-3d jimu-float-leading" data-dojo-attach-point\x3d"app3D" data-dojo-attach-event\x3d"click:_on3dClick"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv\x3e\r\n          \x3ctable style\x3d"width:100%" cellspacing\x3d"6"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" width\x3d"10%"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-title"\x3e\r\n                    ${nls.titleLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"90%"\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-title" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appTitle" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;padding:2px;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"tagsTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n                    ${nls.tagsLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/Tags" data-dojo-props\x3d"minWidth:\'435px\',maxWidth:\'435px\'"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" valign\x3d"top"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n                    ${nls.summaryLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;max-width:95%;min-width:95%;height:200px;max-height:200px;min-height:200px;padding:2px;resize:none;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"folderTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-folder"\x3e\r\n                    ${nls.saveFolderLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-folder" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:96%;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"sharingTr"\x3e\r\n                \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit/form/CheckBox" checked\x3e\x3c/div\x3e\r\n                  \x3clabel for\x3d"publish-webmap-sharing"\x3e${nls.shareSameLevel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/templates/Tags.html":'\x3cdiv class\x3d"${baseClass}" style\x3d"outline:none;"\x3e\x3c/div\x3e\r\n',"url:builder/AGOLTemplate/templates/AGOLTemplate.html":'\x3cdiv\x3e\r\n  \x3c!--div class\x3d"front-div" data-dojo-attach-point\x3d"frontDiv"--\x3e\r\n    \x3c!--div class\x3d"header-div" data-dojo-attach-point\x3d"headerDiv"\x3e\r\n      \x3cspan\x3e${nls.title}\x3c/span\x3e\r\n      \x3cimg src\x3d"builder/css/images/cancel.png" alt\x3d"img" data-dojo-attach-event\x3d"onclick:_onCancelClick"\x3e\x3c/img\x3e\r\n    \x3c/div--\x3e\r\n\r\n    \x3cdiv class\x3d"content-part" data-dojo-attach-point\x3d"contentPart"\x3e\r\n      \x3cdiv class\x3d"tree-part jimu-float-leading" data-dojo-attach-point\x3d"treePart"\x3e\r\n        \x3cdiv class\x3d"left-part-title"\x3e${nls.appNameTitle}${app.name}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-part jimu-float-leading" data-dojo-attach-point\x3d"leftPart"\x3e\r\n        \x3cdiv class\x3d"right-part-head" \x3e\r\n          \x3cspan data-dojo-attach-point\x3d"rightPartHeadText"\x3e${nls.rightPartHead}\x3c/span\x3e\r\n          \x3cdiv class\x3d"review-json-div" data-dojo-attach-point\x3d"reviewJsonDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonDivClick" style\x3d"display:none"\x3e${nls.viewJsonCode}\x3c/div\x3e\r\n          \x3cdiv class\x3d"review-json-back-div" style\x3d"display: none" data-dojo-attach-point\x3d"reviewJsonBackDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonBackDivClick"\x3e${nls.viewJsonBack}\x3c/div\x3e\r\n\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"right-part-subhead"\x3e\r\n          ${nls.rightPartSubhead}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"category-part" data-dojo-attach-point\x3d"categoryPart"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"show-json-div" data-dojo-attach-point\x3d"showJsonDiv"\x3e\r\n          \x3cdiv class\x3d"show-json-content-div" data-dojo-attach-point\x3d"showJsonContentDiv"\x3e     \r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!--div class\x3d"operation-div" data-dojo-attach-point\x3d"operationDiv"\x3e\r\n      \x3cdiv class\x3d"operation-item-div  export-div jimu-btn" style\x3d"" data-dojo-attach-point\x3d"exportNode" data-dojo-attach-event\x3d"onclick:_onExportClick"\x3e${nls.download}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"operation-item-div  download-div jimu-btn jimu-state-disabled" style\x3d"padding: 0px; display: none" data-dojo-attach-point\x3d"downloadNode"\x3e\r\n        \x3ca class\x3d"download-a" href\x3d"#" target\x3d"downloadTargetFrame" data-dojo-attach-point\x3d"downloadLinkNode"\x3e${nls.download}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"operation-item-div save-div jimu-btn" data-dojo-attach-event\x3d"onclick:_onSaveClick"\x3e\r\n        ${nls.save}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"operation-item-div cancel-div jimu-btn" data-dojo-attach-event\x3d"onclick:_onCancelClick"\x3e\r\n        ${nls.cancel}\r\n      \x3c/div\x3e\r\n    \x3c/div--\x3e\r\n  \x3c!--/div--\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/AGOLTemplate/templates/ExportMessage.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"element resMessage" data-dojo-attach-point\x3d"resMessage"\x3e\x3c/div\x3e\r\n    \x3c!--div class\x3d"element" data-dojo-attach-point\x3d"message1"\x3e\x3c/div--\x3e\r\n    \x3cdiv class\x3d"element itemLink"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word1" \x3e\x3c/span\x3e\r\n      \x3ca class\x3d"download-a" target\x3d"_blank" data-dojo-attach-point\x3d"itemLink"\x3e\x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word2" \x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/templates/Header.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"home-section jimu-float-leading" data-dojo-attach-point\x3d"homeSection"\x3e\r\n    \x3cdiv class\x3d"home-label" data-dojo-attach-point\x3d"homeLabel"\x3e${nls.home}\x3c/div\x3e\r\n    \x3cdiv class\x3d"home-menu header-menu" data-dojo-attach-point\x3d"homeMenu"\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"homeItem"\x3e${nls.home}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"galleryItem"\x3e${nls.gallery}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"mapItem"\x3e${nls.map}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"groupsItem"\x3e${nls.groups}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"contentItem"\x3e${nls.content}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"organizationItem"\x3e${nls.organization}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"logo-title jimu-float-leading" data-dojo-attach-point\x3d"logoTitle"\x3e\r\n    \x3cdiv class\x3d"logo jimu-float-leading"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"title jimu-float-leading"\x3eWeb AppBuilder for ArcGIS\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-name" data-dojo-attach-point\x3d"appName"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"user-section jimu-float-trailing" data-dojo-attach-point\x3d"userSection" data-dojo-attach-event\x3d"onclick:_onUserSectionClicked"\x3e\r\n    \x3cdiv class\x3d"user-info" data-dojo-attach-point\x3d"userInfoDom"\x3e      \r\n      \x3cdiv class\x3d"user-name jimu-float-trailing" data-dojo-attach-point\x3d"userNameNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"user-icon jimu-float-trailing"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"user-menu header-menu" data-dojo-attach-point\x3d"userMenu"\x3e\r\n      \x3ca nowrap target\x3d"_self" data-dojo-attach-point\x3d"profileItem"\x3e${nls.profile}\x3c/a\x3e\r\n      \x3ca nowrap target\x3d"_blank" data-dojo-attach-point\x3d"helpItem"\x3e${nls.help}\x3c/a\x3e\r\n      \x3cdiv nowrap class\x3d"sign-out" data-dojo-attach-point\x3d"signOutItem"\x3e${nls.signOut}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/templates/Apps.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\r\n    \x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"head-section"\x3e\r\n        \x3cdiv class\x3d"textPart1 jimu-float-leading"\x3e${nls.welcomeMessage}\x3c/div\x3e\r\n        \x3cdiv class\x3d"textPart2 jimu-float-leading"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"import-button-div jimu-float-trailing" title\x3d"${nls.importTips}"\x3e\r\n          \x3cinput class\x3d"import-button" type\x3d"button" value\x3d"${nls.appImport}" data-dojo-attach-event\x3d"onclick:_onImportClick"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"create-button-div jimu-float-trailing"\x3e\r\n          \x3cinput class\x3d"create-button" type\x3d"button" value\x3d"${nls.appCreate}" data-dojo-attach-event\x3d"onclick:_onCreateClick"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"list-section" id\x3d"list-section" data-dojo-attach-point\x3d"listSection"\x3e\r\n      \x3ctable class\x3d"list-section-head"\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr class\x3d"head-content"\x3e\r\n            \x3cth class\x3d"name"\x3e${nls.appName}\x3c/th\x3e\r\n            \x3cth class\x3d"desc"\x3e${nls.appDesc}\x3c/th\x3e\r\n            \x3cth class\x3d"time"\x3e${nls.appTime}\x3c/th\x3e\r\n            \x3cth class\x3d"modified"\x3e${nls.appModified}\x3c/th\x3e\r\n            \x3cth class\x3d"creator"\x3e${nls.appCreator}\x3c/th\x3e\r\n          \x3c/tr\x3e  \r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"list-section-body-content" data-dojo-attach-point\x3d"listSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"listTable"\x3e\r\n          \x3ctbody\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e        \r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:builder/templates/CreateApp.html":'\x3cdiv\x3e\r\n  \x3c!--div class\x3d"back-div" data-dojo-attach-point\x3d"backDiv"--\x3e\r\n    \x3c!--div class\x3d"front-div"--\x3e\r\n      \x3cdiv class\x3d"app-2d-and-3d"\x3e\r\n        \x3cdiv class\x3d"app-image-div app-2d" data-dojo-attach-point\x3d"app2D" data-dojo-attach-event\x3d"click:_on2dClick"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"app-image-div app-3d" data-dojo-attach-point\x3d"app3D" data-dojo-attach-event\x3d"click:_on3dClick"\x3e\x3c!--div class\x3d"surface-div"\x3eComing Soon\x3c/div--\x3e\x3cimg src\x3d"builder/css/images/comingsoon.png" alt\x3d"3d"/\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"app-input app-name"\x3e\x3cinput type\x3d"text" placeholder\x3d"${nls.appName}" data-dojo-attach-point\x3d"appName"/\x3e\x3c/input\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"app-input app-description"\x3e\x3ctextarea  type\x3d"text" data-dojo-attach-point\x3d"appDescription" placeholder\x3d${nls.appDesc}\x3e\x3c/textarea\x3e\x3c/div\x3e\r\n      \x3c!--div class\x3d"app-button cancel-button" data-dojo-attach-event\x3d"onclick:_onCancelClick"\x3e${nls.cancel}\x3c/div--\x3e\r\n      \x3c!--div class\x3d"app-button next-button"   data-dojo-attach-event\x3d"onclick:_onNextClick"\x3e${nls.ok}\x3c/div--\x3e\r\n    \x3c!--/div--\x3e\r\n  \x3c!--/div--\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/templates/AppOperMenu.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onMenuClick"\x3e\r\n  \x3cdiv class\x3d"up-triangle" data-dojo-attach-point\x3d"upTriangle"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"down-triangle" data-dojo-attach-point\x3d"downTriangle"\x3e\x3c/div\x3e\r\n  \x3c!--div class\x3d"item item-cf" data-dojo-attach-point\x3d"createFromHere" data-dojo-attach-event\x3d"onclick:_onCreateFromHereClick,onmouseover:_onCreateFromHereMouseover,onmouseout:_onCreateFromHereMouseout"\x3e${nls.createFromHere}\x3c/div--\x3e\r\n  \x3cdiv class\x3d"item item-editAppInfo" style\x3d"border-top-left-radius:5px;border-top-right-radius:5px;"data-dojo-attach-point\x3d"editAppInfo" data-dojo-attach-event\x3d"onclick:_onEditClick"\x3e${nls.editAppInfo}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-download" data-dojo-attach-point\x3d"download" data-dojo-attach-event\x3d"onclick:_onDownloadClick"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"downloadLinkNode" style\x3d"display:inline-block;width:100%;height:100%;" target\x3d"downloadTargetFrame"\x3e${nls.download}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-duplicate" data-dojo-attach-point\x3d"duplicate" data-dojo-attach-event\x3d"onclick:_onDuplicateClick"\x3e${nls.duplicate}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item itme-remove" style\x3d"" data-dojo-attach-point\x3d"remove" data-dojo-attach-event\x3d"onclick:_onRemoveClick"\x3e${nls.deleteMenu}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-agol-template" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"agolTemplate" data-dojo-attach-event\x3d"onclick:_onAgolTemplateClick"\x3e${nls.agolTemp}\x3c/div\x3e \r\n\r\n  \x3c!--div class\x3d"item itme-qrcode" style\x3d"" data-dojo-attach-point\x3d"qrcode" data-dojo-attach-event\x3d"onclick:_onQRCodeClick"\x3eqrcodeeeeeee-nonls\x3c/div--\x3e \r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ItemSelector.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\t\t\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:50px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" class\x3d"jimu-float-leading online-public-label"\x3eArcGIS.com\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"*now":function(t){t(['dojo/i18n!*preload*builder/nls/main*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("dojo/_base/kernel dojo/_base/config dojo/_base/html dojo/_base/lang dojo/_base/array dojo/Deferred dojo/cookie dojo/domReady! dojo/on dojo/topic jimu/utils jimu/dijit/ViewStack jimu/portalUrlUtils jimu/portalUtils ./ConfigApp ./Header ./Apps ./tokenUtils ./utils require esri/IdentityManager dojo/i18n dojo/i18n!./nls/builder".split(" "),function(t,d,b,g,k,h,q,l,m,n,f,r,u,s,x,w,v,e,a,c,p,y,B){function A(a){b.setStyle("pre-main-page","display","none");b.setStyle("main-page","display","block");
window.portalUrl=a.portalUrl;e.setPortalUrl(window.portalUrl);var c=u.getSharingUrl(window.portalUrl);p.checkSignInStatus(c).then(function(){z(a)},function(){if(window.isXT)e.xtGetCredentialFromCookie(window.portalUrl)&&z(a);else{var b=u.getPortalSignInUrlFromLocation(),c=encodeURI(window.location.href);window.location.href=b+"?returnUrl\x3d"+c}})}function z(b){var c=s.getPortal(window.portalUrl),e;c.loadSelfInfo().then(function(c){e=c;window.portalSelf=c;window.isXT?c=a.checkProtocolAndUpdateSigninInfo(e,
b):(c=new h,c.resolve({success:!0}));return c}).then(function(g){if(g.success){var h=e.user&&e.user.culture||e.culture||d.locale;h&&(h=h.toLowerCase());g=null;f.isLocaleChanged(d.locale,h)&&(q("wab_locale",h),g=window.location.href);window.isXT&&/[\?|\&](action=)(.+)/gi.test(window.location.href)&&(g||(g=window.location.href),g=a.removeActionFromUrl(g));h="https:"===window.location.protocol;if(e.allSSL||h)window.portalUrl=b.portalUrl=u.setHttpsProtocol(b.portalUrl);c.portalUrl=window.portalUrl;var k=
0===window.portalUrl.toLowerCase().indexOf("https:");!h&&k&&(g||(g=window.location.href),g=g.replace(/^http:/i,"https:"));g?window.location.href=g:(window.main||(main=new r({viewType:"dijit",views:[]},"main-view-stack"),(new w({},"header")).startup(),main.startup()),window.isXT?queryObject.id?(g={id:queryObject.id.replace("#","")},n.publish("switchToApp",g,b)):n.publish("switchToAppList",b):n.publish("initMainPageForIntegration",b))}else console.log("Update signin info error.")})}window.builderNls=
B;window.onunload=function(){q("wab_xt",null,{expires:-1,path:"/webappbuilder"})};"function"!==typeof q.getAll&&(q.getAll=function(a){var b=[];(a=q(a))&&b.push(a);return b});jimuConfig.layoutId=jimuConfig.mainPageId;n.subscribe("switchToMainPage",function(b){var c=a.removeActionFromUrl(window.location.href);f.changeLocation(c);A(b)});n.subscribe("switchToApp",function(a,b){var c=main.getViewByLabel("config");c&&main.removeView(c);c=new x(a);main.addView(c);main.switchView(c)});n.subscribe("switchToAppList",
function(a){(a=main.getViewByLabel("config"))&&main.removeView(a);a=main.getViewByLabel("applist");a||(a=new v({id:"app-list"}),main.addView(a));main.switchView("applist");a.refresh()});b.setStyle("main-loading","display","none");window.isXT?c(["./xtMain"]):c(["./integrationMain"])});