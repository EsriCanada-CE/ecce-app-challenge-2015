var logger=require("log4js").getLogger("dbutils");exports.find=function(o,r,e,n){db.collection(o,function(o,i){return o?(logger.error(o),void(e&&e(o,[]))):void i.find(r,n).toArray(function(o,r){o?(logger.error(o),e&&e(o,[])):e&&(r.forEach(function(o){o.id=o._id.id}),e(null,r))})})},exports.insert=function(o,r,e){db.collection(o,function(o,n){return o?(logger.error(o),void(e&&e(o,[]))):void n.insert(r,{w:1,safe:!0},function(o,r){o?(logger.error(o),e&&e(o,[])):e&&(r.forEach(function(o){o.id=o._id.id}),e(null,r))})})},exports.update=function(o,r,e,n){db.collection(o,function(o,i){return o?(logger.error(o),void(n&&n(o,0))):void i.update(r,e,{w:1,safe:!0},function(o,r){o?(logger.error(o),n&&n(o,0)):n&&n(null,r)})})},exports.remove=function(o,r,e){db.collection(o,function(o,n){return o?(logger.error(o),void(e&&e(o,0))):void n.remove(r,{w:1,safe:!0},function(o,r){o?(logger.error(o),e&&e(o,0)):e&&e(null,r)})})};